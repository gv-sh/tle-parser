/**
 * tle-parser v1.0.0
 * A parser for TLE (Two-Line Element) satellite data.
 * @license MIT
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("fs"),r=require("util"),i=require("stream"),s=require("zlib");function n(e){return[exports.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,exports.ERROR_CODES.CLASSIFIED_DATA_WARNING,exports.ERROR_CODES.STALE_TLE_WARNING,exports.ERROR_CODES.HIGH_ECCENTRICITY_WARNING,exports.ERROR_CODES.LOW_MEAN_MOTION_WARNING,exports.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING,exports.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING,exports.ERROR_CODES.NEAR_ZERO_DRAG_WARNING,exports.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING,exports.ERROR_CODES.NEGATIVE_DECAY_WARNING].includes(e)}exports.ERROR_CODES=void 0,(e=exports.ERROR_CODES||(exports.ERROR_CODES={})).INVALID_INPUT_TYPE="INVALID_INPUT_TYPE",e.EMPTY_INPUT="EMPTY_INPUT",e.INVALID_LINE_COUNT="INVALID_LINE_COUNT",e.INVALID_LINE_LENGTH="INVALID_LINE_LENGTH",e.INVALID_LINE_NUMBER="INVALID_LINE_NUMBER",e.CHECKSUM_MISMATCH="CHECKSUM_MISMATCH",e.INVALID_CHECKSUM_CHARACTER="INVALID_CHECKSUM_CHARACTER",e.SATELLITE_NUMBER_MISMATCH="SATELLITE_NUMBER_MISMATCH",e.INVALID_SATELLITE_NUMBER="INVALID_SATELLITE_NUMBER",e.INVALID_CLASSIFICATION="INVALID_CLASSIFICATION",e.VALUE_OUT_OF_RANGE="VALUE_OUT_OF_RANGE",e.INVALID_NUMBER_FORMAT="INVALID_NUMBER_FORMAT",e.SATELLITE_NAME_TOO_LONG="SATELLITE_NAME_TOO_LONG",e.SATELLITE_NAME_FORMAT_WARNING="SATELLITE_NAME_FORMAT_WARNING",e.CLASSIFIED_DATA_WARNING="CLASSIFIED_DATA_WARNING",e.STALE_TLE_WARNING="STALE_TLE_WARNING",e.HIGH_ECCENTRICITY_WARNING="HIGH_ECCENTRICITY_WARNING",e.LOW_MEAN_MOTION_WARNING="LOW_MEAN_MOTION_WARNING",e.DEPRECATED_EPOCH_YEAR_WARNING="DEPRECATED_EPOCH_YEAR_WARNING",e.REVOLUTION_NUMBER_ROLLOVER_WARNING="REVOLUTION_NUMBER_ROLLOVER_WARNING",e.NEAR_ZERO_DRAG_WARNING="NEAR_ZERO_DRAG_WARNING",e.NON_STANDARD_EPHEMERIS_WARNING="NON_STANDARD_EPHEMERIS_WARNING",e.NEGATIVE_DECAY_WARNING="NEGATIVE_DECAY_WARNING",exports.ERROR_CODES.INVALID_INPUT_TYPE,exports.ERROR_CODES.EMPTY_INPUT,exports.ERROR_CODES.INVALID_LINE_COUNT,exports.ERROR_CODES.INVALID_LINE_LENGTH,exports.ERROR_CODES.INVALID_LINE_NUMBER,exports.ERROR_CODES.CHECKSUM_MISMATCH,exports.ERROR_CODES.INVALID_CHECKSUM_CHARACTER,exports.ERROR_CODES.SATELLITE_NUMBER_MISMATCH,exports.ERROR_CODES.INVALID_SATELLITE_NUMBER,exports.ERROR_CODES.INVALID_CLASSIFICATION,exports.ERROR_CODES.VALUE_OUT_OF_RANGE,exports.ERROR_CODES.INVALID_NUMBER_FORMAT,exports.ERROR_CODES.SATELLITE_NAME_TOO_LONG,exports.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,exports.ERROR_CODES.CLASSIFIED_DATA_WARNING,exports.ERROR_CODES.STALE_TLE_WARNING,exports.ERROR_CODES.HIGH_ECCENTRICITY_WARNING,exports.ERROR_CODES.LOW_MEAN_MOTION_WARNING,exports.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING,exports.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING,exports.ERROR_CODES.NEAR_ZERO_DRAG_WARNING,exports.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING,exports.ERROR_CODES.NEGATIVE_DECAY_WARNING;var a,o,l,c;function u(e){return"object"==typeof e&&null!==e&&"code"in e&&"message"in e&&"severity"in e}exports.TLEErrorCode=void 0,(a=exports.TLEErrorCode||(exports.TLEErrorCode={})).INVALID_LINE_COUNT="INVALID_LINE_COUNT",a.INVALID_LINE_LENGTH="INVALID_LINE_LENGTH",a.INVALID_LINE_NUMBER="INVALID_LINE_NUMBER",a.SATELLITE_NUMBER_MISMATCH="SATELLITE_NUMBER_MISMATCH",a.CHECKSUM_MISMATCH="CHECKSUM_MISMATCH",a.INVALID_CHECKSUM_CHARACTER="INVALID_CHECKSUM_CHARACTER",a.INVALID_CLASSIFICATION="INVALID_CLASSIFICATION",a.INVALID_SATELLITE_NUMBER="INVALID_SATELLITE_NUMBER",a.INVALID_INTL_DESIGNATOR_YEAR="INVALID_INTL_DESIGNATOR_YEAR",a.INVALID_INTL_DESIGNATOR_LAUNCH="INVALID_INTL_DESIGNATOR_LAUNCH",a.INVALID_EPOCH_YEAR="INVALID_EPOCH_YEAR",a.INVALID_EPOCH_DAY="INVALID_EPOCH_DAY",a.INVALID_EPHEMERIS_TYPE="INVALID_EPHEMERIS_TYPE",a.INVALID_ELEMENT_SET_NUMBER="INVALID_ELEMENT_SET_NUMBER",a.INVALID_INCLINATION="INVALID_INCLINATION",a.INVALID_RIGHT_ASCENSION="INVALID_RIGHT_ASCENSION",a.INVALID_ECCENTRICITY="INVALID_ECCENTRICITY",a.INVALID_ARG_OF_PERIGEE="INVALID_ARG_OF_PERIGEE",a.INVALID_MEAN_ANOMALY="INVALID_MEAN_ANOMALY",a.INVALID_MEAN_MOTION="INVALID_MEAN_MOTION",a.INVALID_REVOLUTION_NUMBER="INVALID_REVOLUTION_NUMBER",a.UNUSUAL_CLASSIFICATION="UNUSUAL_CLASSIFICATION",a.OLD_EPOCH="OLD_EPOCH",a.EXTREME_ECCENTRICITY="EXTREME_ECCENTRICITY",a.EXTREME_INCLINATION="EXTREME_INCLINATION",a.HIGH_MEAN_MOTION="HIGH_MEAN_MOTION",a.LOW_MEAN_MOTION="LOW_MEAN_MOTION",a.PARSE_ERROR="PARSE_ERROR",a.VALIDATION_ERROR="VALIDATION_ERROR",function(e){e.INITIAL="INITIAL",e.READING_NAME="READING_NAME",e.READING_LINE1="READING_LINE1",e.READING_LINE2="READING_LINE2",e.COMPLETE="COMPLETE",e.ERROR="ERROR",e.RECOVERING="RECOVERING"}(o||(o={})),function(e){e.CONTINUE="CONTINUE",e.SKIP_FIELD="SKIP_FIELD",e.USE_DEFAULT="USE_DEFAULT",e.ATTEMPT_FIX="ATTEMPT_FIX",e.ABORT="ABORT"}(l||(l={})),exports.ParserState=void 0,function(e){e.INITIAL="INITIAL",e.DETECTING_FORMAT="DETECTING_FORMAT",e.PARSING_NAME="PARSING_NAME",e.PARSING_LINE1="PARSING_LINE1",e.PARSING_LINE2="PARSING_LINE2",e.VALIDATING="VALIDATING",e.COMPLETED="COMPLETED",e.ERROR="ERROR"}(exports.ParserState||(exports.ParserState={})),exports.ErrorSeverity=void 0,(c=exports.ErrorSeverity||(exports.ErrorSeverity={})).WARNING="warning",c.ERROR="error",c.CRITICAL="critical",exports.RecoveryAction=void 0,function(e){e.CONTINUE="CONTINUE",e.SKIP_FIELD="SKIP_FIELD",e.USE_DEFAULT="USE_DEFAULT",e.ATTEMPT_FIX="ATTEMPT_FIX",e.ABORT="ABORT"}(exports.RecoveryAction||(exports.RecoveryAction={}));class E{constructor(e={}){this.options={attemptRecovery:!0,maxRecoveryAttempts:10,includePartialResults:!0,strictMode:!1,...e},this.state=exports.ParserState.INITIAL,this.errors=[],this.warnings=[],this.recoveryActions=[],this.parsedData={},this.context={lineCount:0,hasName:!1,nameLineIndex:-1,line1Index:-1,line2Index:-1,lines:[],recoveryAttempts:0},this.reset()}reset(){this.state=exports.ParserState.INITIAL,this.errors=[],this.warnings=[],this.recoveryActions=[],this.parsedData={},this.context={lineCount:0,hasName:!1,nameLineIndex:-1,line1Index:-1,line2Index:-1,lines:[],recoveryAttempts:0}}addIssue(e,t,r,i={}){const s={severity:e,code:t,message:r,state:this.state,...i};return e===exports.ErrorSeverity.WARNING?this.warnings.push(s):this.errors.push(s),s}recordRecovery(e,t,r={}){this.recoveryActions.push({action:e,description:t,state:this.state,timestamp:Date.now(),...r}),this.context.recoveryAttempts++}transition(e,t=""){const r=this.state;return this.state=e,{from:r,to:e,reason:t}}parse(e){return this.reset(),"string"!=typeof e?(this.addIssue(exports.ErrorSeverity.CRITICAL,exports.ERROR_CODES.INVALID_INPUT_TYPE,"TLE data must be a string",{inputType:typeof e}),this.transition(exports.ParserState.ERROR),this.getResult()):0===e.length?(this.addIssue(exports.ErrorSeverity.CRITICAL,exports.ERROR_CODES.EMPTY_INPUT,"TLE string cannot be empty",{inputLength:0}),this.transition(exports.ParserState.ERROR),this.getResult()):(this.transition(exports.ParserState.DETECTING_FORMAT,"Starting parse"),this.detectFormat(e),this.state===exports.ParserState.DETECTING_FORMAT&&this.executeStateMachine(),this.getResult())}detectFormat(e){const t=e.trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0);if(this.context.lines=t,this.context.lineCount=t.length,t.length<2)return this.addIssue(exports.ErrorSeverity.CRITICAL,exports.ERROR_CODES.INVALID_LINE_COUNT,`TLE must contain at least 2 lines (found ${t.length})`,{expected:"2 or 3",actual:t.length}),this.options.attemptRecovery&&this.recordRecovery(exports.RecoveryAction.ABORT,"Insufficient lines to parse TLE",{lineCount:t.length}),void this.transition(exports.ParserState.ERROR);if(t.length>3){if(this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.INVALID_LINE_COUNT,`TLE should contain 2 or 3 lines (found ${t.length})`,{expected:"2 or 3",actual:t.length}),this.options.attemptRecovery){this.recordRecovery(exports.RecoveryAction.ATTEMPT_FIX,"Attempting to identify valid TLE lines from excess lines",{lineCount:t.length});const e=t.filter(e=>"1"===e[0]),r=t.filter(e=>"2"===e[0]);if(1===e.length&&1===r.length){const i=e[0],s=r[0];if(!i||!s)return;const n=t.indexOf(i),a=t.indexOf(s);if(n<a){n>0&&(this.context.hasName=!0,this.context.nameLineIndex=n-1),this.context.line1Index=n,this.context.line2Index=a;const e=t[this.context.nameLineIndex],r=t[n],i=t[a];this.context.lines=this.context.hasName&&e&&r&&i?[e,r,i]:r&&i?[r,i]:[],this.context.lineCount=this.context.lines.length,this.recordRecovery(exports.RecoveryAction.CONTINUE,"Successfully identified TLE lines from excess input",{extractedLines:this.context.lineCount})}}}}else if(3===t.length){const e=t[0]?.[0];"1"!==e&&"2"!==e||this.addIssue(exports.ErrorSeverity.WARNING,exports.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,'First line starts with "1" or "2", might be missing satellite name',{firstLine:t[0]}),this.context.hasName=!0,this.context.nameLineIndex=0,this.context.line1Index=1,this.context.line2Index=2}else this.context.hasName=!1,this.context.line1Index=0,this.context.line2Index=1}executeStateMachine(){let e=0;for(;this.state!==exports.ParserState.COMPLETED&&this.state!==exports.ParserState.ERROR&&e<100;){switch(this.state){case exports.ParserState.DETECTING_FORMAT:this.context.hasName?this.transition(exports.ParserState.PARSING_NAME):this.transition(exports.ParserState.PARSING_LINE1);break;case exports.ParserState.PARSING_NAME:this.parseSatelliteName(),this.transition(exports.ParserState.PARSING_LINE1);break;case exports.ParserState.PARSING_LINE1:this.parseLine1(),this.transition(exports.ParserState.PARSING_LINE2);break;case exports.ParserState.PARSING_LINE2:this.parseLine2(),this.transition(exports.ParserState.VALIDATING);break;case exports.ParserState.VALIDATING:this.validateCrossFields(),this.errors.some(e=>e.severity===exports.ErrorSeverity.CRITICAL)&&!this.options.includePartialResults?this.transition(exports.ParserState.ERROR):this.transition(exports.ParserState.COMPLETED);break;default:this.transition(exports.ParserState.ERROR,"Unexpected state")}e++}e>=100&&(this.addIssue(exports.ErrorSeverity.CRITICAL,"STATE_MACHINE_LOOP","State machine exceeded maximum iterations",{iterations:e}),this.transition(exports.ParserState.ERROR))}parseSatelliteName(){const e=this.context.nameLineIndex;if(e<0||e>=this.context.lines.length)return void this.addIssue(exports.ErrorSeverity.ERROR,"INVALID_NAME_LINE_INDEX","Invalid satellite name line index",{index:e});const t=this.context.lines[e];t&&(this.parsedData.satelliteName=t,t.length>24&&this.addIssue(exports.ErrorSeverity.WARNING,exports.ERROR_CODES.SATELLITE_NAME_TOO_LONG,"Satellite name exceeds recommended 24 characters",{length:t.length,name:t}),"1"!==t[0]&&"2"!==t[0]||this.addIssue(exports.ErrorSeverity.WARNING,exports.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,'Satellite name starts with "1" or "2", might be incorrectly formatted',{name:t}))}parseLine1(){const e=this.context.line1Index;if(e<0||e>=this.context.lines.length)return void this.addIssue(exports.ErrorSeverity.CRITICAL,"INVALID_LINE1_INDEX","Invalid Line 1 index",{index:e});const t=this.context.lines[e];if(!t)return;if(this.parsedData.line1Raw=t,69!==t.length)if(this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.INVALID_LINE_LENGTH,`Line 1 must be exactly 69 characters (got ${t.length})`,{line:1,expected:69,actual:t.length}),this.options.attemptRecovery)this.recordRecovery(exports.RecoveryAction.CONTINUE,"Attempting to parse Line 1 despite incorrect length",{length:t.length});else if(this.options.strictMode)return;this.parseFieldSafe("lineNumber1",t,0,1,"Line 1 number"),this.parseFieldSafe("satelliteNumber1",t,2,7,"Satellite number"),this.parseFieldSafe("classification",t,7,8,"Classification"),this.parseFieldSafe("internationalDesignatorYear",t,9,11,"Int. designator year"),this.parseFieldSafe("internationalDesignatorLaunchNumber",t,11,14,"Int. designator launch"),this.parseFieldSafe("internationalDesignatorPiece",t,14,17,"Int. designator piece"),this.parseFieldSafe("epochYear",t,18,20,"Epoch year"),this.parseFieldSafe("epoch",t,20,32,"Epoch"),this.parseFieldSafe("firstDerivative",t,33,43,"First derivative"),this.parseFieldSafe("secondDerivative",t,44,52,"Second derivative"),this.parseFieldSafe("bStar",t,53,61,"B* drag term"),this.parseFieldSafe("ephemerisType",t,62,63,"Ephemeris type"),this.parseFieldSafe("elementSetNumber",t,64,68,"Element set number"),this.parseFieldSafe("checksum1",t,68,69,"Checksum"),"1"!==this.parsedData.lineNumber1&&this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.INVALID_LINE_NUMBER,`Line 1 must start with '1' (got '${this.parsedData.lineNumber1}')`,{line:1,expected:"1",actual:this.parsedData.lineNumber1});const r=["U","C","S"];if(this.parsedData.classification&&!r.includes(this.parsedData.classification)&&this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.INVALID_CLASSIFICATION,`Classification must be U, C, or S (got '${this.parsedData.classification}')`,{expected:r,actual:this.parsedData.classification}),69===t.length){const e=this.calculateChecksum(t),r=parseInt(this.parsedData.checksum1||"",10);isNaN(r)||e===r||(this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.CHECKSUM_MISMATCH,`Line 1 checksum mismatch (expected ${e}, got ${r})`,{line:1,expected:e,actual:r}),this.options.attemptRecovery&&this.recordRecovery(exports.RecoveryAction.CONTINUE,"Continuing despite checksum mismatch",{line:1}))}}parseLine2(){const e=this.context.line2Index;if(e<0||e>=this.context.lines.length)return void this.addIssue(exports.ErrorSeverity.CRITICAL,"INVALID_LINE2_INDEX","Invalid Line 2 index",{index:e});const t=this.context.lines[e];if(t){if(this.parsedData.line2Raw=t,69!==t.length)if(this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.INVALID_LINE_LENGTH,`Line 2 must be exactly 69 characters (got ${t.length})`,{line:2,expected:69,actual:t.length}),this.options.attemptRecovery)this.recordRecovery(exports.RecoveryAction.CONTINUE,"Attempting to parse Line 2 despite incorrect length",{length:t.length});else if(this.options.strictMode)return;if(this.parseFieldSafe("lineNumber2",t,0,1,"Line 2 number"),this.parseFieldSafe("satelliteNumber2",t,2,7,"Satellite number"),this.parseFieldSafe("inclination",t,8,16,"Inclination"),this.parseFieldSafe("rightAscension",t,17,25,"Right ascension"),this.parseFieldSafe("eccentricity",t,26,33,"Eccentricity"),this.parseFieldSafe("argumentOfPerigee",t,34,42,"Argument of perigee"),this.parseFieldSafe("meanAnomaly",t,43,51,"Mean anomaly"),this.parseFieldSafe("meanMotion",t,52,63,"Mean motion"),this.parseFieldSafe("revolutionNumber",t,63,68,"Revolution number"),this.parseFieldSafe("checksum2",t,68,69,"Checksum"),"2"!==this.parsedData.lineNumber2&&this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.INVALID_LINE_NUMBER,`Line 2 must start with '2' (got '${this.parsedData.lineNumber2}')`,{line:2,expected:"2",actual:this.parsedData.lineNumber2}),69===t.length){const e=this.calculateChecksum(t),r=parseInt(this.parsedData.checksum2||"",10);isNaN(r)||e===r||(this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.CHECKSUM_MISMATCH,`Line 2 checksum mismatch (expected ${e}, got ${r})`,{line:2,expected:e,actual:r}),this.options.attemptRecovery&&this.recordRecovery(exports.RecoveryAction.CONTINUE,"Continuing despite checksum mismatch",{line:2}))}}}validateCrossFields(){if(this.parsedData.satelliteNumber1&&this.parsedData.satelliteNumber2){const e=this.parsedData.satelliteNumber1.trim(),t=this.parsedData.satelliteNumber2.trim();e!==t&&this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.SATELLITE_NUMBER_MISMATCH,`Satellite numbers must match (Line 1: ${e}, Line 2: ${t})`,{line1Value:e,line2Value:t})}if(this.validateNumericField("inclination",0,180,"Inclination"),this.validateNumericField("rightAscension",0,360,"Right Ascension"),this.validateNumericField("argumentOfPerigee",0,360,"Argument of Perigee"),this.validateNumericField("meanAnomaly",0,360,"Mean Anomaly"),this.parsedData.eccentricity){const e=parseFloat("0."+this.parsedData.eccentricity.trim());!isNaN(e)&&(e<0||e>1)&&this.addIssue(exports.ErrorSeverity.ERROR,exports.ERROR_CODES.VALUE_OUT_OF_RANGE,`Eccentricity must be between 0 and 1 (got ${e})`,{field:"eccentricity",value:e,min:0,max:1})}this.validateNumericField("meanMotion",0,20,"Mean Motion",!0),this.validateNumericField("epochYear",0,99,"Epoch Year")}validateNumericField(e,t,r,i,s=!1){const n=this.parsedData[e];if(!n||"string"!=typeof n)return;const a=parseFloat(n.trim());isNaN(a)?this.addIssue(s?exports.ErrorSeverity.WARNING:exports.ErrorSeverity.ERROR,exports.ERROR_CODES.INVALID_NUMBER_FORMAT,`${i} must be numeric (got '${n}')`,{field:e,value:n}):(a<t||a>r)&&this.addIssue(s?exports.ErrorSeverity.WARNING:exports.ErrorSeverity.ERROR,exports.ERROR_CODES.VALUE_OUT_OF_RANGE,`${i} must be between ${t} and ${r} (got ${a})`,{field:e,value:a,min:t,max:r})}parseFieldSafe(e,t,r,i,s){try{t.length>=i?this.parsedData[e]=t.substring(r,i).trim():t.length>r?(this.parsedData[e]=t.substring(r).trim(),this.addIssue(exports.ErrorSeverity.WARNING,"PARTIAL_FIELD",`${s} is incomplete due to short line`,{field:e,expected:[r,i],actual:t.length}),this.options.attemptRecovery&&this.recordRecovery(exports.RecoveryAction.USE_DEFAULT,`Using partial value for ${s}`,{field:e})):(this.parsedData[e]=null,this.addIssue(exports.ErrorSeverity.WARNING,"MISSING_FIELD",`${s} is missing due to short line`,{field:e,expected:[r,i],actual:t.length}),this.options.attemptRecovery&&this.recordRecovery(exports.RecoveryAction.USE_DEFAULT,`Using null for missing ${s}`,{field:e}))}catch(t){this.parsedData[e]=null;const r=t instanceof Error?t.message:String(t);this.addIssue(exports.ErrorSeverity.ERROR,"FIELD_PARSE_ERROR",`Error parsing ${s}: ${r}`,{field:e,error:r})}}calculateChecksum(e){let t=0;for(let r=0;r<e.length-1;r++){const i=e[r];i&&i>="0"&&i<="9"?t+=parseInt(i,10):"-"===i&&(t+=1)}return t%10}getResult(){const e=this.errors.map(e=>({code:e.code,message:e.message,severity:e.severity===exports.ErrorSeverity.CRITICAL?"error":e.severity,...Object.fromEntries(Object.entries(e).filter(([e])=>!["severity","code","message","state"].includes(e)))})),t=this.warnings.map(e=>({code:e.code,message:e.message,severity:"warning",...Object.fromEntries(Object.entries(e).filter(([e])=>!["severity","code","message","state"].includes(e)))}));return{success:this.state===exports.ParserState.COMPLETED,state:this.state,data:this.parsedData,errors:e,warnings:t,recoveryActions:this.recoveryActions.map(e=>e.action),partialData:this.options.includePartialResults?this.parsedData:void 0,context:{lineCount:this.context.lineCount,hasName:this.context.hasName,recoveryAttempts:this.context.recoveryAttempts}}}}const m=r.promisify(t.readFile);function h(e,t={}){const{filter:r,continueOnError:i=!1,limit:s,skip:n=0,onTLE:a,onError:o,...l}=t,c=[],u=p(e);let E=0;for(let e=0;e<u.length;e++){if(e<n)continue;if(void 0!==s&&E>=s)break;const t=u[e];if(t)try{const i=ce(t,l);if(r&&!R(i,r))continue;c.push(i),E++,a&&a(i,e)}catch(r){if(o&&o(r,e,t),!i)throw r}}return c}function p(e){const t=q(e).split("\n").map(e=>e.trim()).filter(e=>e.length>0),r=[];let i=[];for(const e of t)e.startsWith("#")?i.length>0&&i.push(e):"1"===e[0]?(i.length>=2&&r.push(i.join("\n")),i=[e]):"2"===e[0]?i.push(e):i.length>=2?(r.push(i.join("\n")),i=[e]):0===i.length?i=[e]:i.push(e);return i.length>=2&&r.push(i.join("\n")),r}async function d(e,t={}){return Promise.resolve(ce(e,t))}function R(e,t){if(void 0!==t.satelliteNumber){const r=e.satelliteNumber1||"";if("function"==typeof t.satelliteNumber){if(!t.satelliteNumber(r))return!1}else if(Array.isArray(t.satelliteNumber)){if(!t.satelliteNumber.includes(r))return!1}else if(r!==t.satelliteNumber)return!1}if(void 0!==t.satelliteName&&e.satelliteName){const r=e.satelliteName;if("function"==typeof t.satelliteName){if(!t.satelliteName(r))return!1}else if(Array.isArray(t.satelliteName)){if(!t.satelliteName.some(e=>r.includes(e)))return!1}else if(!r.includes(t.satelliteName))return!1}if(void 0!==t.intlDesignator){const r=`${e.internationalDesignatorYear||""}${e.internationalDesignatorLaunchNumber||""}${e.internationalDesignatorPiece||""}`.trim();if("function"==typeof t.intlDesignator){if(!t.intlDesignator(r))return!1}else if(Array.isArray(t.intlDesignator)){if(!t.intlDesignator.includes(r))return!1}else if(r!==t.intlDesignator)return!1}if(void 0!==t.classification){const r=e.classification;if(Array.isArray(t.classification)){if(!t.classification.includes(r))return!1}else if(r!==t.classification)return!1}if(t.epochRange){const r=parseInt(e.epochYear||"0",10),i=e.epoch||"0",s=parseFloat(i),n=new Date(r>=57?1900+r:2e3+r,0,1);if(n.setDate(n.getDate()+s-1),t.epochRange.start&&n<t.epochRange.start)return!1;if(t.epochRange.end&&n>t.epochRange.end)return!1}if(t.inclinationRange){const r=parseFloat(e.inclination||"0");if(void 0!==t.inclinationRange.min&&r<t.inclinationRange.min)return!1;if(void 0!==t.inclinationRange.max&&r>t.inclinationRange.max)return!1}return!(t.custom&&!t.custom(e))}class N extends i.Transform{constructor(e={}){super({objectMode:!0,highWaterMark:e.highWaterMark||16}),this.buffer="",this.index=0,this.options=e}_transform(e,t,r){this.buffer+=e.toString();const i=this.buffer.split("\n");this.buffer=i.pop()||"";let s=[];for(const e of i){const t=e.trim();0!==t.length&&(t.startsWith("#")?s.push(t):"1"===t[0]?(s.length>=2&&this.processTLE(s.join("\n")),s=[t]):"2"===t[0]?(s.push(t),s.length>=2&&(this.processTLE(s.join("\n")),s=[])):(s.length>=2&&this.processTLE(s.join("\n")),s=[t]))}r()}_flush(e){if(this.buffer.trim().length>0){const e=this.buffer.split("\n").filter(e=>e.trim().length>0);e.length>=2&&this.processTLE(e.join("\n"))}e()}processTLE(e){const{continueOnError:t=!0,filter:r,onTLE:i,onError:s,...n}=this.options;try{const t=ce(e,n);if(r&&!R(t,r))return;this.push(t),i&&i(t,this.index),this.index++}catch(r){s&&s(r,this.index,e),t||this.destroy(r),this.index++}}}function I(e={}){return new N(e)}async function _(e,t={}){return new Promise((r,i)=>{const s=[],n=I({...t,onTLE:(e,r)=>{s.push(e),t.onTLE&&t.onTLE(e,r)}});e.pipe(n).on("data",()=>{}).on("end",()=>r(s)).on("error",i)})}class A{constructor(){this.middlewares=[],this.plugins=[]}use(e){return this.middlewares.push(e),this}plugin(e){return this.plugins.push(e),e.middleware&&this.use(e.middleware),this}async parse(e,t={}){const r={rawTLE:e,options:t,metadata:{}},i=async e=>{if(e>=this.middlewares.length)return ce(r.rawTLE,r.options);const t=this.middlewares[e];return t?t(r,()=>i(e+1)):ce(r.rawTLE,r.options)};return i(0)}async parseBatch(e,t={}){for(const e of this.plugins)e.onBatchStart&&await e.onBatchStart(t);const r=[],i=p(e);for(let e=0;e<i.length;e++){const s=i[e];if(s)try{const i=await this.parse(s,t);if(t.filter&&!R(i,t.filter))continue;r.push(i);for(const t of this.plugins)t.onTLEParsed&&await t.onTLEParsed(i,e);t.onTLE&&t.onTLE(i,e)}catch(r){for(const t of this.plugins)t.onError&&await t.onError(r,e);if(t.onError&&t.onError(r,e,s),!t.continueOnError)throw r}}for(const e of this.plugins)e.onBatchEnd&&await e.onBatchEnd(r);return r}}class g{constructor(e={}){this.cache=new Map,this.maxSize=e.maxSize||1e3,this.ttl=e.ttl||36e5,this.keyGenerator=e.keyGenerator||this.defaultKeyGenerator}defaultKeyGenerator(e,t){return`${e}:${JSON.stringify(t)}`}get(e,t={}){const r=this.keyGenerator(e,t),i=this.cache.get(r);return i?Date.now()-i.timestamp>this.ttl?(this.cache.delete(r),null):(this.cache.delete(r),this.cache.set(r,i),i.tle):null}set(e,t,r={}){const i=this.keyGenerator(e,r);if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(i,{tle:t,timestamp:Date.now()})}clear(){this.cache.clear()}size(){return this.cache.size}}function f(e){return{strict:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},permissive:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0},fast:{validate:!1,includeWarnings:!1,includeComments:!1},realtime:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!1,includeComments:!1},batch:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!1,includeComments:!1},recovery:{validate:!1,includeWarnings:!0,includeComments:!0},legacy:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0}}[e]}class O{constructor(e,t={}){this.buffer="",this.currentSet=[],this.onTLE=e,this.options=t}push(e){this.buffer+=e,this.processBuffer()}flush(){this.currentSet.length>=2&&(this.emitTLE(this.currentSet.join("\n")),this.currentSet=[])}processBuffer(){const e=this.buffer.split("\n");this.buffer=e.pop()||"";for(const t of e){const e=t.trim();0!==e.length&&(e.startsWith("#")?this.currentSet.push(e):"1"===e[0]?(this.currentSet.length>=2&&this.emitTLE(this.currentSet.join("\n")),this.currentSet=[e]):"2"===e[0]?(this.currentSet.push(e),this.currentSet.length>=2&&(this.emitTLE(this.currentSet.join("\n")),this.currentSet=[])):(this.currentSet.length>=2&&this.emitTLE(this.currentSet.join("\n")),this.currentSet=[e]))}}emitTLE(e){try{const t=ce(e,this.options);this.onTLE(t)}catch(e){}}}function T(e){return{celestrak:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},spacetrack:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},amsat:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0},custom:{validate:!1,includeWarnings:!0,includeComments:!0}}[e]}const S={meanMotion:{min:0,max:20,typical:{min:10,max:17}},eccentricity:{min:0,max:.999999,typical:{min:0,max:.25}},inclination:{min:0,max:180,typical:{min:0,max:100}},rightAscension:{min:0,max:360},argumentOfPerigee:{min:0,max:360},meanAnomaly:{min:0,max:360},bStar:{min:-1,max:1,typical:{min:-.001,max:.001}},meanMotionFirstDerivative:{min:-1,max:1,typical:{min:-.001,max:.001}},meanMotionSecondDerivative:{min:-1,max:1,typical:{min:-1e-5,max:1e-5}},revolutionNumber:{min:0,max:99999},elementSetNumber:{min:0,max:999},ephemerisType:{min:0,max:9}},x={min:1,max:999999,historical5Digit:99999,modern6Digit:999999},L={minYear:57,maxYear:99,minDayOfYear:1,maxDayOfYear:366.99999999,warningAgeThreshold:7,criticalAgeThreshold:30,maxFutureDays:30},C={yearMin:57,yearMax:99,launchNumberMin:1,launchNumberMax:999,piecePattern:/^[A-Z]{1,3}$/},D={checksumValid:20,fieldFormatValid:15,parametersInRange:15,parametersInTypicalRange:10,epochRecent:15,noAnomalies:10,designatorValid:5,consistencyChecks:10};function v(e,t){let r;r=e>=57?1900+e:2e3+e;const i=new Date(Date.UTC(r,0,1)).getTime()+864e5*(t-1),s=new Date(i),n=Math.floor((14-(s.getUTCMonth()+1))/12),a=r+4800-n,o=s.getUTCMonth()+1+12*n-3,l=s.getUTCDate()+Math.floor((153*o+2)/5)+365*a+Math.floor(a/4)-Math.floor(a/100)+Math.floor(a/400)-32045+(s.getUTCHours()+s.getUTCMinutes()/60+s.getUTCSeconds()/3600)/24,c=l-2400000.5;return{year:r,twoDigitYear:e,dayOfYear:t,isoDate:s.toISOString(),date:s,julianDate:l,modifiedJulianDate:c}}function y(e,t){const r=[];if((e<L.minYear||e>L.maxYear)&&r.push(`Epoch year ${e} outside valid range [${L.minYear}, ${L.maxYear}]`),(t<L.minDayOfYear||t>L.maxDayOfYear)&&r.push(`Epoch day ${t} outside valid range [${L.minDayOfYear}, ${L.maxDayOfYear}]`),r.length>0)return{valid:!1,message:r.join("; "),context:{epochYear:e,epochDay:t}};const i=v(e,t),s=i.year,n=s%4==0&&s%100!=0||s%400==0,a=n?366:365;return Math.floor(t)>a&&r.push(`Day ${Math.floor(t)} exceeds maximum for ${s} (${n?"leap year":"non-leap year"}: ${a} days)`),r.length>0?{valid:!1,message:r.join("; "),context:{epochYear:e,epochDay:t,fullYear:s,isLeapYear:n}}:{valid:!0,context:{epochDate:i}}}function M(e,t,r=new Date){const i=v(e,t);return(r.getTime()-i.date.getTime())/864e5}function b(e,t,r={}){const i=M(e,t,r.referenceDate||new Date),s=[];if(i<0){const e=Math.abs(i);if(!r.allowFuture)return{valid:!1,message:`Epoch is ${e.toFixed(2)} days in the future`,context:{age:i,futureDays:e}};e>L.maxFutureDays&&s.push(`Epoch is ${e.toFixed(2)} days in the future (threshold: ${L.maxFutureDays} days)`)}if(i>0){const e=r.maxAge||L.criticalAgeThreshold;i>e&&s.push(`Epoch is ${i.toFixed(2)} days old (threshold: ${e} days)`)}return{valid:!0,message:s.length>0?s.join("; "):void 0,context:{age:i}}}function V(e,t,r=!1){const i=S[e];if(!i)return{valid:!1,message:`Unknown parameter: ${e}`};if(t<i.min||t>i.max)return{valid:!1,message:`${e} value ${t} outside valid range [${i.min}, ${i.max}]`,context:{paramName:e,value:t,min:i.min,max:i.max}};if(r&&"typical"in i&&i.typical){const r=i.typical;if(t<r.min||t>r.max)return{valid:!0,message:`${e} value ${t} outside typical range [${r.min}, ${r.max}]`,context:{paramName:e,value:t,typicalMin:r.min,typicalMax:r.max,outsideTypical:!0}}}return{valid:!0,context:{paramName:e,value:t}}}function P(e,t=!1){const r=[],i={meanMotion:{field:"meanMotion",param:"meanMotion"},eccentricity:{field:"eccentricity",param:"eccentricity"},inclination:{field:"inclination",param:"inclination"},rightAscension:{field:"rightAscension",param:"rightAscension"},argumentOfPerigee:{field:"argumentOfPerigee",param:"argumentOfPerigee"},meanAnomaly:{field:"meanAnomaly",param:"meanAnomaly"},bStar:{field:"bStar",param:"bStar"},firstDerivative:{field:"firstDerivative",param:"meanMotionFirstDerivative"},secondDerivative:{field:"secondDerivative",param:"meanMotionSecondDerivative"},revolutionNumber:{field:"revolutionNumber",param:"revolutionNumber"},elementSetNumber:{field:"elementSetNumber",param:"elementSetNumber"},ephemerisType:{field:"ephemerisType",param:"ephemerisType"}};for(const[s,n]of Object.entries(i)){const i=parseFloat(e[n.field]);if(isNaN(i)){r.push({valid:!1,message:`Field ${s} is not a valid number`,context:{field:s,value:e[n.field]}});continue}const a=V(n.param,i,t);a.valid&&!a.message||r.push({...a,context:{...a.context,field:s}})}return r}function U(e,t){if(e.length<69)return{valid:!1,message:`Line ${t} is too short (${e.length} chars, expected 69)`,context:{lineNumber:t,length:e.length}};const r=e.charAt(68),i=parseInt(r,10),s=function(e){let t=0;const r=e.substring(0,68);for(const e of r)e>="0"&&e<="9"?t+=parseInt(e,10):"-"===e&&(t+=1);return t%10}(e);return isNaN(i)?{valid:!1,message:`Line ${t} checksum is not a digit: '${r}'`,context:{lineNumber:t,checksumChar:r}}:s!==i?{valid:!1,message:`Line ${t} checksum mismatch: expected ${i}, calculated ${s}`,context:{lineNumber:t,expected:i,calculated:s,line:e.substring(0,68)}}:{valid:!0,context:{lineNumber:t,checksum:s}}}function G(e){const t="-"===(e=e.trim())[0]?-1:1,r=e.replace(/^[-+\s]+/,"").replace(/\s+/g,""),i=r.match(/([+-])(\d+)$/);if(!i)return t*parseFloat("0."+r);const s=r.substring(0,r.length-i[0].length),n="-"===(i[1]||"+")?-1:1,a=parseInt(i[2]||"0",10);return t*parseFloat("0."+s)*Math.pow(10,n*a)}function F(e){const t="string"==typeof e?parseInt(e.trim(),10):e;return isNaN(t)?{valid:!1,message:`Satellite number is not a valid integer: '${e}'`,context:{satelliteNumber:e}}:t<x.min||t>x.max?{valid:!1,message:`Satellite number ${t} outside valid range [${x.min}, ${x.max}]`,context:{satelliteNumber:t,min:x.min,max:x.max}}:{valid:!0,context:{satelliteNumber:t,format:t<=x.historical5Digit?"5-digit":"6-digit"}}}function w(e){const t=e.trim(),r=t.match(/^(\d{2})(\d{1,3})([A-Z]{1,3})$/);if(!r)return{valid:!1,message:`Invalid international designator format: '${e}' (expected YYLLLPPP)`,context:{designator:t}};const i=r[1]||"0",s=r[2]||"0",n=r[3]||"",a=parseInt(i,10),o=parseInt(s,10);return a<C.yearMin||a>C.yearMax?{valid:!1,message:`International designator year ${a} outside valid range [${C.yearMin}, ${C.yearMax}]`,context:{designator:t,year:a}}:o<C.launchNumberMin||o>C.launchNumberMax?{valid:!1,message:`International designator launch number ${o} outside valid range [${C.launchNumberMin}, ${C.launchNumberMax}]`,context:{designator:t,launchNumber:o}}:C.piecePattern.test(n)?{valid:!0,context:{designator:t,year:a,launchNumber:o,piece:n,fullYear:a>=C.yearMin?1900+a:2e3+a}}:{valid:!1,message:`International designator piece '${n}' invalid (must be 1-3 uppercase letters)`,context:{designator:t,piece:n}}}const H=.01,$=.01;function W(e){const t=[],r=parseFloat(e.eccentricity),i=parseFloat(e.meanMotion),s=parseFloat(e.inclination),n=G(e.bStar),a=parseFloat(e.firstDerivative),o=parseInt(e.revolutionNumber,10);return r>.5&&t.push({hasAnomaly:!0,type:"HIGH_ECCENTRICITY",description:`Unusually high eccentricity: ${r.toFixed(6)} (threshold: 0.5)`,severity:r>.9?"error":"warning",score:Math.min(r/.5,1)}),i<1&&t.push({hasAnomaly:!0,type:"LOW_MEAN_MOTION",description:`Unusually low mean motion: ${i.toFixed(8)} rev/day (threshold: 1)`,severity:"warning",score:1-i/1}),i>18&&t.push({hasAnomaly:!0,type:"HIGH_MEAN_MOTION",description:`Unusually high mean motion: ${i.toFixed(8)} rev/day (threshold: 18)`,severity:"warning",score:Math.min(i/18,1)}),s>90&&s<180&&t.push({hasAnomaly:!0,type:"RETROGRADE_ORBIT",description:`Retrograde orbit detected: inclination ${s.toFixed(4)}° (>90°)`,severity:"info",score:(s-90)/90}),Math.abs(n)>H&&t.push({hasAnomaly:!0,type:"HIGH_DRAG",description:`Unusually high drag coefficient: B* = ${n.toExponential(4)} (threshold: 0.01)`,severity:"warning",score:Math.min(Math.abs(n)/H,1)}),Math.abs(a)>$&&t.push({hasAnomaly:!0,type:"RAPID_ORBITAL_CHANGE",description:`Rapid orbital evolution: dn/dt = ${a.toFixed(8)} (threshold: 0.01)`,severity:"warning",score:Math.min(Math.abs(a)/$,1)}),o<100&&t.push({hasAnomaly:!0,type:"NEW_SATELLITE",description:`Recently launched satellite: revolution number ${o}`,severity:"info",score:1-o/100}),0===r&&t.push({hasAnomaly:!0,type:"CIRCULAR_ORBIT",description:"Perfect circular orbit (eccentricity = 0)",severity:"info",score:.1}),t}function k(e,t){let r=0;const i={checksumScore:0,formatScore:0,rangeScore:0,epochScore:0,anomalyScore:0,consistencyScore:0};t.checksumValid&&(i.checksumScore=D.checksumValid),t.formatValid&&(i.formatScore=D.fieldFormatValid);const s=t.rangeErrors.filter(e=>!e.valid),n=t.rangeResults.filter(e=>e.valid&&e.message);if(0===s.length)i.rangeScore=D.parametersInRange,0===n.length&&(i.rangeScore+=D.parametersInTypicalRange);else{const e=s.length+n.length,t=n.length;i.rangeScore=t/e*D.parametersInRange}const a=Math.abs(t.epochAge);i.epochScore=a<=1?D.epochRecent:a<=L.warningAgeThreshold?.9*D.epochRecent:a<=L.criticalAgeThreshold?.5*D.epochRecent:.2*D.epochRecent;const o={error:1,warning:.5,info:.1},l=t.anomalies.reduce((e,t)=>{const r=o[t.severity||"info"];return e+(t.score||.5)*r},0);i.anomalyScore=Math.max(0,D.noAnomalies-2*l);let c,u,E=D.consistencyChecks;return e.satelliteNumber1!==e.satelliteNumber2&&(E-=5),["U","C","S"].includes(e.classification)||(E-=2),w(e.internationalDesignatorYear+e.internationalDesignatorLaunchNumber+e.internationalDesignatorPiece).valid||(E-=3),i.consistencyScore=Math.max(0,E),r=Object.values(i).reduce((e,t)=>e+t,0),c=r>=90?"A":r>=80?"B":r>=70?"C":r>=60?"D":"F",u="A"===c?"Excellent quality - TLE is fresh, valid, and anomaly-free":"B"===c?"Good quality - TLE is valid with minor warnings":"C"===c?"Acceptable quality - TLE has some issues but is usable":"D"===c?"Poor quality - TLE has significant issues, use with caution":"Invalid - TLE has critical errors and should not be used",{overall:Math.round(r),components:i,grade:c,assessment:u}}function Y(e,t){let r=e;const i=[];r.includes("\0")&&(r=r.replace(/\0/g,""),i.push("Removed null bytes")),r.includes("\t")&&(r=r.replace(/\t/g," "),i.push("Normalized tabs to spaces"));const s=/[\x00-\x1F\x7F-\x9F]/g;switch(s.test(r)&&(r=r.replace(s,""),i.push("Removed non-printable characters")),t){case"satelliteName":/^[A-Z0-9\s\-\(\)]+$/i.test(r)||(r=r.replace(/[^A-Z0-9\s\-\(\)]/gi,""),i.push("Removed invalid characters from satellite name"));break;case"classification":r=r.trim().toUpperCase(),r.length>1&&(r=r.charAt(0),i.push("Truncated classification to single character"));break;case"internationalDesignatorYear":case"internationalDesignatorLaunchNumber":case"satelliteNumber1":case"satelliteNumber2":case"elementSetNumber":case"revolutionNumber":/^\d+$/.test(r.trim())||(r=r.replace(/\D/g,""),i.push(`Removed non-numeric characters from ${t}`));break;case"internationalDesignatorPiece":{const e=r;r=r.trim().toUpperCase().replace(/[^A-Z]/g,""),r!==e.trim()&&i.push("Normalized designator piece to uppercase letters");break}}const n=r.trim();return n!==r&&(r=n,i.push("Trimmed whitespace")),{value:r,modified:i.length>0,modifications:i.length>0?i:void 0}}function B(e){const t=new Map;for(const[r,i]of Object.entries(e))if("string"==typeof i){const e=Y(i,r);e.modified&&t.set(r,e)}return t}const j=[{name:"checksum",description:"Validate line checksums",severity:"error",enabled:!0,validate:()=>({valid:!0})},{name:"satelliteNumberRange",description:"Validate satellite number is in valid range",severity:"error",enabled:!0,validate:e=>F(e)},{name:"epochDate",description:"Validate epoch date format and range",severity:"error",enabled:!0,validate:e=>y(parseInt(e.epochYear,10),parseFloat(e.epoch))},{name:"epochAge",description:"Warn if epoch is stale or in future",severity:"warning",enabled:!0,validate:(e,t)=>b(parseInt(e.epochYear,10),parseFloat(e.epoch),{referenceDate:t?.referenceDate})},{name:"internationalDesignator",description:"Validate international designator format",severity:"warning",enabled:!0,validate:e=>w(e.internationalDesignatorYear+e.internationalDesignatorLaunchNumber+e.internationalDesignatorPiece)},{name:"orbitalParameterRanges",description:"Validate orbital parameters are in valid ranges",severity:"error",enabled:!0,validate:e=>{const t=P(e,!1).filter(e=>!e.valid);return t.length>0?{valid:!1,message:t.map(e=>e.message).join("; "),context:{errors:t}}:{valid:!0}}},{name:"anomalyDetection",description:"Detect unusual orbital parameters",severity:"warning",enabled:!1,validate:e=>{const t=W(e);return t.length>0?{valid:!0,message:`${t.length} anomalies detected`,context:{anomalies:t}}:{valid:!0}}}],K={lineNumber1:[0,1],satelliteNumber1:[2,7],classification:[7,8],internationalDesignatorYear:[9,11],internationalDesignatorLaunchNumber:[11,14],internationalDesignatorPiece:[14,17],epochYear:[18,20],epoch:[20,32],firstDerivative:[33,43],secondDerivative:[44,52],bStar:[53,61],ephemerisType:[62,63],elementSetNumber:[64,68],checksum1:[68,69],lineNumber2:[0,1],satelliteNumber2:[2,7],inclination:[8,16],rightAscension:[17,25],eccentricity:[26,33],argumentOfPerigee:[34,42],meanAnomaly:[43,51],meanMotion:[52,63],revolutionNumber:[63,68],checksum2:[68,69]};class z extends Error{constructor(e,t,r=[]){super(e),this.name="TLEValidationError",this.errors=t,this.warnings=r,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class X extends Error{constructor(e,t,r={}){super(e),this.name="TLEFormatError",this.code=t,this.details=r,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}function q(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}function Z(e){return q(e).split("\n").map(e=>e.replace(/\t/g," ").trim()).filter(e=>e.length>0)}function Q(e){let t=0;for(let r=0;r<e.length-1;r++){const i=e[r];i&&i>="0"&&i<="9"?t+=parseInt(i,10):"-"===i&&(t+=1)}return t%10}function J(e){if(69!==e.length)return{isValid:!1,expected:null,actual:null,error:{code:exports.ERROR_CODES.INVALID_LINE_LENGTH,message:"Line length must be 69 characters",field:"line_length",expected:69,actual:e.length,severity:"error"}};const t=Q(e),r=parseInt(e[68]||"",10);if(isNaN(r))return{isValid:!1,expected:t,actual:null,error:{code:exports.ERROR_CODES.INVALID_CHECKSUM_CHARACTER,message:"Checksum position must contain a digit",field:"checksum",position:68,value:e[68],severity:"error"}};const i=t===r;return{isValid:i,expected:t,actual:r,error:i?null:{code:exports.ERROR_CODES.CHECKSUM_MISMATCH,message:`Checksum mismatch: expected ${t}, got ${r}`,field:"checksum",expected:t,actual:r,severity:"error"}}}function ee(e,t){const r=[];if(69!==e.length)return r.push({code:exports.ERROR_CODES.INVALID_LINE_LENGTH,message:`Line ${t} must be exactly 69 characters (got ${e.length})`,line:t,field:"line_length",expected:69,actual:e.length,severity:"error"}),{isValid:!1,errors:r};const i=e[0];i!==t.toString()&&r.push({code:exports.ERROR_CODES.INVALID_LINE_NUMBER,message:`Line ${t} must start with '${t}' (got '${i}')`,line:t,field:"line_number",expected:t.toString(),actual:i,severity:"error"});const s=J(e);return!s.isValid&&s.error&&r.push({...s.error,line:t,message:`Line ${t}: ${s.error.message}`}),{isValid:0===r.length,errors:r}}function te(e,t){const r=e.substring(2,7).trim(),i=t.substring(2,7).trim();return r!==i?{isValid:!1,error:{code:exports.ERROR_CODES.SATELLITE_NUMBER_MISMATCH,message:`Satellite numbers must match (Line 1: ${r}, Line 2: ${i})`,field:"satellite_number",line1Value:r,line2Value:i,severity:"error"}}:/^\d+$/.test(r)?{isValid:!0,error:null}:{isValid:!1,error:{code:exports.ERROR_CODES.INVALID_SATELLITE_NUMBER,message:`Satellite number must be numeric (got '${r}')`,field:"satellite_number",value:r,severity:"error"}}}function re(e){const t=e[7],r=["U","C","S"];return r.includes(t||"")?{isValid:!0,error:null}:{isValid:!1,error:{code:exports.ERROR_CODES.INVALID_CLASSIFICATION,message:`Classification must be U, C, or S (got '${t}')`,field:"classification",expected:r,actual:t,severity:"error"}}}function ie(e,t,r,i){const s=parseFloat(e);return isNaN(s)?{isValid:!1,error:{code:exports.ERROR_CODES.INVALID_NUMBER_FORMAT,message:`${t} must be numeric (got '${e}')`,field:t,value:e,severity:"error"}}:s<r||s>i?{isValid:!1,error:{code:exports.ERROR_CODES.VALUE_OUT_OF_RANGE,message:`${t} must be between ${r} and ${i} (got ${s})`,field:t,value:s,min:r,max:i,severity:"error"}}:{isValid:!0,error:null}}function se(e){const t=[],r=e[7];return"C"!==r&&"S"!==r||t.push({code:exports.ERROR_CODES.CLASSIFIED_DATA_WARNING,message:`Classification '${r}' is unusual in public TLE data (typically 'U' for unclassified)`,field:"classification",value:r,severity:"warning"}),t}function ne(e){const t=[],r=parseInt(e.substring(18,20),10),i=parseFloat(e.substring(20,32));if(isNaN(r)||isNaN(i))return t;const s=r>=57?1900+r:2e3+r;s<2e3&&t.push({code:exports.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING,message:`Epoch year ${s} is in the deprecated 1900s range (two-digit year: ${r})`,field:"epochYear",value:r,fullYear:s,severity:"warning"});const n=new Date(s,0,1);n.setDate(n.getDate()+i-1);const a=((new Date).getTime()-n.getTime())/864e5;return a>30&&t.push({code:exports.ERROR_CODES.STALE_TLE_WARNING,message:`TLE epoch is ${Math.floor(a)} days old (epoch: ${n.toISOString().split("T")[0]}). TLE data may be stale.`,field:"epoch",daysSinceEpoch:Math.floor(a),epochDate:n.toISOString().split("T")[0],severity:"warning"}),t}function ae(e){const t=[],r=parseFloat("0."+e.substring(26,33).trim());!isNaN(r)&&r>.25&&t.push({code:exports.ERROR_CODES.HIGH_ECCENTRICITY_WARNING,message:`Eccentricity ${r.toFixed(7)} is unusually high. This indicates a highly elliptical orbit.`,field:"eccentricity",value:r,severity:"warning"});const i=parseFloat(e.substring(52,63).trim());!isNaN(i)&&i<1&&t.push({code:exports.ERROR_CODES.LOW_MEAN_MOTION_WARNING,message:`Mean motion ${i.toFixed(8)} rev/day is unusually low. This indicates a very high orbit.`,field:"meanMotion",value:i,severity:"warning"});const s=parseInt(e.substring(63,68).trim(),10);return!isNaN(s)&&s>9e4&&t.push({code:exports.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING,message:`Revolution number ${s} is approaching rollover limit (99999). Counter may reset soon.`,field:"revolutionNumber",value:s,severity:"warning"}),t}function oe(e){const t=[],r=e.substring(53,61).trim();"00000-0"!==r&&"00000+0"!==r&&"00000 0"!==r||t.push({code:exports.ERROR_CODES.NEAR_ZERO_DRAG_WARNING,message:"B* drag term is zero or near-zero, which is unusual for most satellites in LEO",field:"bStar",value:r,severity:"warning"});const i=parseFloat(e.substring(33,43).trim());!isNaN(i)&&i<0&&t.push({code:exports.ERROR_CODES.NEGATIVE_DECAY_WARNING,message:`First derivative of mean motion is negative (${i}), indicating orbital decay`,field:"firstDerivative",value:i,severity:"warning"});const s=e.substring(62,63).trim();return"0"!==s&&""!==s&&t.push({code:exports.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING,message:`Ephemeris type '${s}' is non-standard (expected '0' for SGP4/SDP4)`,field:"ephemerisType",value:s,severity:"warning"}),t}function le(e,t={}){if("string"!=typeof e)throw new TypeError("TLE data must be a string");if("object"!=typeof t||null===t||Array.isArray(t))throw new TypeError("Options must be an object");if(0===e.length)throw new X("TLE string cannot be empty",exports.ERROR_CODES.EMPTY_INPUT,{inputLength:0});const{strictChecksums:r=!0,validateRanges:i=!0,mode:s="strict"}=t;if("strict"!==s&&"permissive"!==s)throw new TypeError('Mode must be either "strict" or "permissive"');const n=[],a=[],o=q(e).trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0&&!e.startsWith("#"));if(o.length<2)return n.push({code:exports.ERROR_CODES.INVALID_LINE_COUNT,message:"TLE must contain at least 2 lines",field:"line_count",expected:"2 or 3",actual:o.length,severity:"error"}),{isValid:!1,errors:n,warnings:a};if(o.length>3)return n.push({code:exports.ERROR_CODES.INVALID_LINE_COUNT,message:`TLE must contain 2 or 3 lines (got ${o.length})`,field:"line_count",expected:"2 or 3",actual:o.length,severity:"error"}),{isValid:!1,errors:n,warnings:a};let l=0,c=1;if(3===o.length){l=1,c=2;const e=o[0];!e||"1"!==e[0]&&"2"!==e[0]||a.push({code:exports.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,message:'Line 0 starts with "1" or "2", might be incorrectly formatted',field:"satellite_name",value:e,severity:"warning"}),e&&e.length>24&&a.push({code:exports.ERROR_CODES.SATELLITE_NAME_TOO_LONG,message:"Satellite name (Line 0) should be 24 characters or less",field:"satellite_name",expected:24,actual:e.length,severity:"warning"})}const u=o[l],E=o[c];if(!u||!E)return n.push({code:exports.ERROR_CODES.INVALID_LINE_COUNT,message:"Missing required TLE lines",severity:"error"}),{isValid:!1,errors:n,warnings:a};const m=ee(u,1);if(!m.isValid)if("permissive"===s){const e=m.errors.filter(e=>e.code!==exports.ERROR_CODES.CHECKSUM_MISMATCH&&e.code!==exports.ERROR_CODES.INVALID_CHECKSUM_CHARACTER),t=m.errors.filter(e=>e.code===exports.ERROR_CODES.CHECKSUM_MISMATCH||e.code===exports.ERROR_CODES.INVALID_CHECKSUM_CHARACTER);if(n.push(...e),a.push(...t.map(e=>({...e,severity:"warning"}))),e.length>0)return{isValid:!1,errors:n,warnings:a}}else if(n.push(...m.errors),r)return{isValid:!1,errors:n,warnings:a};const h=ee(E,2);if(!h.isValid)if("permissive"===s){const e=h.errors.filter(e=>e.code!==exports.ERROR_CODES.CHECKSUM_MISMATCH&&e.code!==exports.ERROR_CODES.INVALID_CHECKSUM_CHARACTER),t=h.errors.filter(e=>e.code===exports.ERROR_CODES.CHECKSUM_MISMATCH||e.code===exports.ERROR_CODES.INVALID_CHECKSUM_CHARACTER);if(n.push(...e),a.push(...t.map(e=>({...e,severity:"warning"}))),e.length>0)return{isValid:!1,errors:n,warnings:a}}else if(n.push(...h.errors),r)return{isValid:!1,errors:n,warnings:a};const p=te(u,E);!p.isValid&&p.error&&("permissive"===s?a.push({...p.error,severity:"warning"}):n.push(p.error));const d=re(u);if(!d.isValid&&d.error&&("permissive"===s?a.push({...d.error,severity:"warning"}):n.push(d.error)),i&&69===u.length&&69===E.length){const e=[{value:u.substring(2,7).trim(),name:"Satellite Number",min:1,max:99999},{value:u.substring(9,11).trim(),name:"International Designator Year",min:0,max:99,optional:!0},{value:u.substring(11,14).trim(),name:"International Designator Launch Number",min:1,max:999,optional:!0},{value:u.substring(62,63).trim(),name:"Ephemeris Type",min:0,max:9,optional:!0},{value:u.substring(64,68).trim(),name:"Element Set Number",min:0,max:9999,optional:!0},{value:u.substring(18,20).trim(),name:"Epoch Year",min:0,max:99},{value:u.substring(20,32).trim(),name:"Epoch Day",min:1,max:366.99999999},{value:E.substring(8,16).trim(),name:"Inclination",min:0,max:180},{value:E.substring(17,25).trim(),name:"Right Ascension",min:0,max:360},{value:"0."+E.substring(26,33).trim(),name:"Eccentricity",min:0,max:1},{value:E.substring(34,42).trim(),name:"Argument of Perigee",min:0,max:360},{value:E.substring(43,51).trim(),name:"Mean Anomaly",min:0,max:360},{value:E.substring(52,63).trim(),name:"Mean Motion",min:0,max:20,warningOnly:!0},{value:E.substring(63,68).trim(),name:"Revolution Number",min:0,max:99999,optional:!0}];for(const{value:t,name:r,min:i,max:o,optional:l,warningOnly:c}of e){if(l&&0===t.length)continue;const e=ie(t,r,i,o);!e.isValid&&e.error&&(c||"permissive"===s?a.push({...e.error,severity:"warning"}):n.push(e.error))}}return 69===u.length&&(a.push(...se(u)),a.push(...ne(u)),a.push(...oe(u))),69===E.length&&a.push(...ae(E)),{isValid:0===n.length,errors:n,warnings:a}}function ce(e,t={}){if("string"!=typeof e)throw new TypeError("TLE data must be a string");if("object"!=typeof t||null===t||Array.isArray(t))throw new TypeError("Options must be an object");const{validate:r=!0,strictChecksums:i=!0,validateRanges:s=!0,includeWarnings:n=!0,includeComments:a=!0,mode:o="strict"}=t;let l=[];if(r){const t=le(e,{strictChecksums:i,validateRanges:s,mode:o});if(!t.isValid){const e="TLE validation failed:\n"+t.errors.map(e=>"string"==typeof e?e:e.message).join("\n");throw new z(e,t.errors,t.warnings)}l=t.warnings}const c=q(e).trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0),u=c.filter(e=>e.startsWith("#")),E=c.filter(e=>!e.startsWith("#"));let m=0,h=1,p=null;3===E.length&&(p=E[0]||null,m=1,h=2);const d=E[m],R=E[h];if(!d||!R)throw new X("Missing required TLE lines",exports.ERROR_CODES.INVALID_LINE_COUNT);const N={satelliteName:p},I=["lineNumber2","satelliteNumber2","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion","revolutionNumber","checksum2"];for(const[e,t]of Object.entries(K)){const[r,i]=t,s=I.includes(e)?R:d;N[e]=s.substring(r,i).trim()}return n&&l.length>0&&(N.warnings=l),a&&u.length>0&&(N.comments=u),N}var ue={parseTLE:ce,validateTLE:le,calculateChecksum:Q,validateChecksum:J,validateLineStructure:ee,validateSatelliteNumber:te,validateClassification:re,validateNumericRange:ie,checkClassificationWarnings:se,checkEpochWarnings:ne,checkOrbitalParameterWarnings:ae,checkDragAndEphemerisWarnings:oe,normalizeLineEndings:q,parseTLELines:Z,TLEValidationError:z,TLEFormatError:X,ERROR_CODES:exports.ERROR_CODES};exports.DEFAULT_VALIDATION_RULES=j,exports.DESIGNATOR_CONSTRAINTS=C,exports.EPOCH_CONSTRAINTS=L,exports.IncrementalParser=O,exports.MiddlewareParser=A,exports.ORBITAL_PARAMETER_RANGES=S,exports.QUALITY_SCORE_WEIGHTS=D,exports.SATELLITE_NUMBER_RANGES=x,exports.TLECache=g,exports.TLEFormatError=X,exports.TLEParserStream=N,exports.TLEStateMachineParser=E,exports.TLEValidationError=z,exports.ValidationRuleManager=class{constructor(e=j){this.rules=new Map;for(const t of e)this.rules.set(t.name,t)}addRule(e){this.rules.set(e.name,e)}removeRule(e){return this.rules.delete(e)}enableRule(e){const t=this.rules.get(e);return!!t&&(t.enabled=!0,!0)}disableRule(e){const t=this.rules.get(e);return!!t&&(t.enabled=!1,!0)}getEnabledRules(){return Array.from(this.rules.values()).filter(e=>e.enabled)}getRule(e){return this.rules.get(e)}getAllRules(){return Array.from(this.rules.values())}},exports.applyFilter=R,exports.calculateChecksum=Q,exports.calculateEpochAge=M,exports.calculateQualityScore=k,exports.checkClassificationWarnings=se,exports.checkDragAndEphemerisWarnings=oe,exports.checkEpochWarnings=ne,exports.checkOrbitalParameterWarnings=ae,exports.convertEpochToDate=v,exports.createCachedParser=function(e={}){const t=new g(e);return{parse:(e,r={})=>{const i=t.get(e,r);if(i)return i;const s=ce(e,r);return t.set(e,s,r),s},parseAsync:async(e,r={})=>{const i=t.get(e,r);if(i)return i;const s=await d(e,r);return t.set(e,s,r),s},cache:t}},exports.createIncrementalParser=function(e,t={}){return new O(e,t)},exports.createMiddlewareParser=function(){return new A},exports.createTLEParserStream=I,exports.createValidationRule=function(e,t,r,i={}){return{name:e,description:t,severity:i.severity||"warning",enabled:!1!==i.enabled,validate:r,errorMessage:i.errorMessage}},exports.default=ue,exports.detectAnomalies=W,exports.generateValidationReport=function(e,t,r={}){const i=[],s=[],n=[],a=[],o=[];let l=0,c=0,u=0;if(!1!==r.validateChecksums){l+=2,o.push("checksum");const e=U(t.line1,1);e.valid?c++:(i.push({code:"CHECKSUM_MISMATCH",message:e.message||"Checksum validation failed",line:1,severity:"error",field:"checksum1"}),u++);const r=U(t.line2,2);r.valid?c++:(i.push({code:"CHECKSUM_MISMATCH",message:r.message||"Checksum validation failed",line:2,severity:"error",field:"checksum2"}),u++)}if(!1!==r.validateEpoch){l++,o.push("epochDate");const t=parseInt(e.epochYear,10),n=parseFloat(e.epoch),a=y(t,n);a.valid?c++:(i.push({code:"INVALID_EPOCH",message:a.message||"Invalid epoch date",severity:"error",field:"epoch"}),u++);const E=b(t,n,{referenceDate:r.referenceDate,allowFuture:r.allowFutureEpochs,maxAge:r.maxEpochAge});E.valid?E.message&&s.push({code:"STALE_EPOCH",message:E.message,severity:"warning",field:"epoch"}):i.push({code:"EPOCH_OUT_OF_RANGE",message:E.message||"Epoch age out of acceptable range",severity:"error",field:"epoch"})}const E={valid:[],invalid:[]};if(!1!==r.validateRanges){o.push("orbitalParameterRanges");const t=P(e,r.strict);l+=t.length;for(const e of t)e.valid?e.message?(s.push({code:"PARAMETER_OUTSIDE_TYPICAL",message:e.message,severity:"warning",field:e.context?.field}),c++,E.valid.push(e)):(c++,E.valid.push(e)):(i.push({code:"PARAMETER_OUT_OF_RANGE",message:e.message||"Parameter out of valid range",severity:"error",field:e.context?.field}),u++,E.invalid.push(e))}if(r.detectAnomalies&&(o.push("anomalyDetection"),n.push(...W(e))),r.sanitizeFields){o.push("fieldSanitization");const t=B(e);for(const[e]of t)a.push(e)}l++,o.push("satelliteNumber");const m=F(e.satelliteNumber1);m.valid?c++:(i.push({code:"INVALID_SATELLITE_NUMBER",message:m.message||"Invalid satellite number",severity:"error",field:"satelliteNumber"}),u++),e.satelliteNumber1!==e.satelliteNumber2&&s.push({code:"SATELLITE_NUMBER_MISMATCH",message:`Satellite numbers do not match: ${e.satelliteNumber1} vs ${e.satelliteNumber2}`,severity:"warning",field:"satelliteNumber"}),l++,o.push("internationalDesignator");const h=w(e.internationalDesignatorYear+e.internationalDesignatorLaunchNumber+e.internationalDesignatorPiece);let p;if(h.valid?c++:(s.push({code:"INVALID_DESIGNATOR",message:h.message||"Invalid international designator",severity:"warning",field:"internationalDesignator"}),u++),!1!==r.calculateQuality){const t=M(parseInt(e.epochYear,10),parseFloat(e.epoch),r.referenceDate);p=k(e,{checksumValid:0===i.filter(e=>"CHECKSUM_MISMATCH"===e.code).length,formatValid:0===i.filter(e=>e.code?.includes("FORMAT")).length,rangeErrors:E.invalid,rangeResults:[...E.valid,...E.invalid],epochAge:t,anomalies:n})}else p={overall:0,components:{checksumScore:0,formatScore:0,rangeScore:0,epochScore:0,anomalyScore:0,consistencyScore:0},grade:"F",assessment:"Not calculated"};return{isValid:0===i.length,qualityScore:p,errors:i,warnings:s,anomalies:n,sanitizedFields:a,timestamp:new Date,rulesApplied:o,summary:{totalChecks:l,passedChecks:c,failedChecks:u,warningCount:s.length,errorCount:i.length}}},exports.getErrorDescription=function(e){return{[exports.ERROR_CODES.INVALID_INPUT_TYPE]:"Input data must be a string",[exports.ERROR_CODES.EMPTY_INPUT]:"Input string is empty or contains only whitespace",[exports.ERROR_CODES.INVALID_LINE_COUNT]:"TLE must contain exactly 2 or 3 lines",[exports.ERROR_CODES.INVALID_LINE_LENGTH]:"TLE line must be exactly 69 characters",[exports.ERROR_CODES.INVALID_LINE_NUMBER]:"Line number must be 1 or 2",[exports.ERROR_CODES.CHECKSUM_MISMATCH]:"Calculated checksum does not match",[exports.ERROR_CODES.INVALID_CHECKSUM_CHARACTER]:"Checksum must be a digit 0-9",[exports.ERROR_CODES.SATELLITE_NUMBER_MISMATCH]:"Satellite numbers on line 1 and line 2 must match",[exports.ERROR_CODES.INVALID_SATELLITE_NUMBER]:"Satellite catalog number is invalid",[exports.ERROR_CODES.INVALID_CLASSIFICATION]:"Classification must be U, C, or S",[exports.ERROR_CODES.VALUE_OUT_OF_RANGE]:"Field value is outside valid range",[exports.ERROR_CODES.INVALID_NUMBER_FORMAT]:"Field contains invalid numeric format",[exports.ERROR_CODES.SATELLITE_NAME_TOO_LONG]:"Satellite name exceeds maximum length",[exports.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING]:"Satellite name contains unusual characters",[exports.ERROR_CODES.CLASSIFIED_DATA_WARNING]:"TLE contains classified satellite data",[exports.ERROR_CODES.STALE_TLE_WARNING]:"TLE epoch is significantly old",[exports.ERROR_CODES.HIGH_ECCENTRICITY_WARNING]:"Eccentricity is unusually high",[exports.ERROR_CODES.LOW_MEAN_MOTION_WARNING]:"Mean motion is unusually low",[exports.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING]:"Epoch year is in the far past",[exports.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING]:"Revolution number may have rolled over",[exports.ERROR_CODES.NEAR_ZERO_DRAG_WARNING]:"Drag coefficient is near zero",[exports.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING]:"Ephemeris type is non-standard",[exports.ERROR_CODES.NEGATIVE_DECAY_WARNING]:"Mean motion decay is negative"}[e]||"Unknown error code"},exports.getProfileOptions=f,exports.getProviderOptions=T,exports.isCriticalError=function(e){return!n(e)},exports.isParseFailure=function(e){return!1===e.success},exports.isParseSuccess=function(e){return!0===e.success},exports.isParsedTLE=function(e){return"object"==typeof e&&null!==e&&["lineNumber1","satelliteNumber1","classification","lineNumber2","satelliteNumber2","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion"].every(t=>t in e)},exports.isTLEError=u,exports.isTLEWarning=function(e){return u(e)&&"warning"===e.severity},exports.isValidClassification=function(e){return"U"===e||"C"===e||"S"===e},exports.isValidErrorCode=function(e){return Object.values(exports.ERROR_CODES).includes(e)},exports.isValidationFailure=function(e){return!1===e.success},exports.isValidationSuccess=function(e){return!0===e.success},exports.isWarningCode=n,exports.normalizeAssumedDecimalNotation=G,exports.normalizeLineEndings=q,exports.normalizeScientificNotation=function(e,t="standard"){return"assumedDecimal"===t?G(e):"integer"===t?parseInt(e.trim(),10):parseFloat(e.trim())},exports.parseBatch=h,exports.parseBatchAsync=async function(e,t={}){return Promise.resolve(h(e,t))},exports.parseFromCompressed=async function(e,r={}){const i=t.createReadStream(e),n=s.createGunzip();return _(i.pipe(n),r)},exports.parseFromFile=async function(e,t={}){const{encoding:r="utf8",...i}=t;return h(await m(e,{encoding:r}),i)},exports.parseFromStream=_,exports.parseFromURL=async function(e,t={}){const{headers:r,timeout:i=3e4,...s}=t,n=new AbortController,a=setTimeout(()=>n.abort(),i);try{const t=await fetch(e,{headers:r,signal:n.signal});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return h(await t.text(),s)}finally{clearTimeout(a)}},exports.parseParallel=async function(e,t={},r){return h(e,t)},exports.parseTLE=ce,exports.parseTLEAsync=d,exports.parseTLELines=Z,exports.parseWithProfile=function(e,t){return ce(e,f(t))},exports.parseWithProvider=function(e,t){return ce(e,T(t))},exports.parseWithStateMachine=function(e,t={}){return new E(t).parse(e)},exports.sanitizeAllFields=B,exports.sanitizeField=Y,exports.splitTLEs=p,exports.validateAllOrbitalParameters=P,exports.validateChecksum=J,exports.validateClassification=re,exports.validateEpochAge=b,exports.validateEpochDate=y,exports.validateInternationalDesignator=w,exports.validateLineStructure=ee,exports.validateNumericRange=ie,exports.validateOrbitalParameter=V,exports.validateSatelliteNumber=te,exports.validateTLE=le,exports.validateTLEAsync=async function(e,t={}){return Promise.resolve(le(e,t))};
//# sourceMappingURL=index.min.cjs.map
