/**
 * tle-parser v1.0.0
 * A parser for TLE (Two-Line Element) satellite data.
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("fs/promises"),require("fs"),require("path"),require("os"),require("util"),require("stream"),require("zlib")):"function"==typeof define&&define.amd?define(["exports","fs/promises","fs","path","os","util","stream","zlib"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TLEParser={},e.promises,e.fs,e.path,e.os,e.util,e.stream,e.zlib)}(this,function(e,t,i,n,a,r,s,o){"use strict";var c;function l(t){return[e.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,e.ERROR_CODES.CLASSIFIED_DATA_WARNING,e.ERROR_CODES.STALE_TLE_WARNING,e.ERROR_CODES.HIGH_ECCENTRICITY_WARNING,e.ERROR_CODES.LOW_MEAN_MOTION_WARNING,e.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING,e.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING,e.ERROR_CODES.NEAR_ZERO_DRAG_WARNING,e.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING,e.ERROR_CODES.NEGATIVE_DECAY_WARNING].includes(t)}e.ERROR_CODES=void 0,(c=e.ERROR_CODES||(e.ERROR_CODES={})).INVALID_INPUT_TYPE="INVALID_INPUT_TYPE",c.EMPTY_INPUT="EMPTY_INPUT",c.INVALID_LINE_COUNT="INVALID_LINE_COUNT",c.INVALID_LINE_LENGTH="INVALID_LINE_LENGTH",c.INVALID_LINE_NUMBER="INVALID_LINE_NUMBER",c.CHECKSUM_MISMATCH="CHECKSUM_MISMATCH",c.INVALID_CHECKSUM_CHARACTER="INVALID_CHECKSUM_CHARACTER",c.SATELLITE_NUMBER_MISMATCH="SATELLITE_NUMBER_MISMATCH",c.INVALID_SATELLITE_NUMBER="INVALID_SATELLITE_NUMBER",c.INVALID_CLASSIFICATION="INVALID_CLASSIFICATION",c.VALUE_OUT_OF_RANGE="VALUE_OUT_OF_RANGE",c.INVALID_NUMBER_FORMAT="INVALID_NUMBER_FORMAT",c.SATELLITE_NAME_TOO_LONG="SATELLITE_NAME_TOO_LONG",c.SATELLITE_NAME_FORMAT_WARNING="SATELLITE_NAME_FORMAT_WARNING",c.CLASSIFIED_DATA_WARNING="CLASSIFIED_DATA_WARNING",c.STALE_TLE_WARNING="STALE_TLE_WARNING",c.HIGH_ECCENTRICITY_WARNING="HIGH_ECCENTRICITY_WARNING",c.LOW_MEAN_MOTION_WARNING="LOW_MEAN_MOTION_WARNING",c.DEPRECATED_EPOCH_YEAR_WARNING="DEPRECATED_EPOCH_YEAR_WARNING",c.REVOLUTION_NUMBER_ROLLOVER_WARNING="REVOLUTION_NUMBER_ROLLOVER_WARNING",c.NEAR_ZERO_DRAG_WARNING="NEAR_ZERO_DRAG_WARNING",c.NON_STANDARD_EPHEMERIS_WARNING="NON_STANDARD_EPHEMERIS_WARNING",c.NEGATIVE_DECAY_WARNING="NEGATIVE_DECAY_WARNING",e.ERROR_CODES.INVALID_INPUT_TYPE,e.ERROR_CODES.EMPTY_INPUT,e.ERROR_CODES.INVALID_LINE_COUNT,e.ERROR_CODES.INVALID_LINE_LENGTH,e.ERROR_CODES.INVALID_LINE_NUMBER,e.ERROR_CODES.CHECKSUM_MISMATCH,e.ERROR_CODES.INVALID_CHECKSUM_CHARACTER,e.ERROR_CODES.SATELLITE_NUMBER_MISMATCH,e.ERROR_CODES.INVALID_SATELLITE_NUMBER,e.ERROR_CODES.INVALID_CLASSIFICATION,e.ERROR_CODES.VALUE_OUT_OF_RANGE,e.ERROR_CODES.INVALID_NUMBER_FORMAT,e.ERROR_CODES.SATELLITE_NAME_TOO_LONG,e.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,e.ERROR_CODES.CLASSIFIED_DATA_WARNING,e.ERROR_CODES.STALE_TLE_WARNING,e.ERROR_CODES.HIGH_ECCENTRICITY_WARNING,e.ERROR_CODES.LOW_MEAN_MOTION_WARNING,e.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING,e.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING,e.ERROR_CODES.NEAR_ZERO_DRAG_WARNING,e.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING,e.ERROR_CODES.NEGATIVE_DECAY_WARNING;var h,u,m,d;function p(e){return"object"==typeof e&&null!==e&&"code"in e&&"message"in e&&"severity"in e}e.TLEErrorCode=void 0,(h=e.TLEErrorCode||(e.TLEErrorCode={})).INVALID_LINE_COUNT="INVALID_LINE_COUNT",h.INVALID_LINE_LENGTH="INVALID_LINE_LENGTH",h.INVALID_LINE_NUMBER="INVALID_LINE_NUMBER",h.SATELLITE_NUMBER_MISMATCH="SATELLITE_NUMBER_MISMATCH",h.CHECKSUM_MISMATCH="CHECKSUM_MISMATCH",h.INVALID_CHECKSUM_CHARACTER="INVALID_CHECKSUM_CHARACTER",h.INVALID_CLASSIFICATION="INVALID_CLASSIFICATION",h.INVALID_SATELLITE_NUMBER="INVALID_SATELLITE_NUMBER",h.INVALID_INTL_DESIGNATOR_YEAR="INVALID_INTL_DESIGNATOR_YEAR",h.INVALID_INTL_DESIGNATOR_LAUNCH="INVALID_INTL_DESIGNATOR_LAUNCH",h.INVALID_EPOCH_YEAR="INVALID_EPOCH_YEAR",h.INVALID_EPOCH_DAY="INVALID_EPOCH_DAY",h.INVALID_EPHEMERIS_TYPE="INVALID_EPHEMERIS_TYPE",h.INVALID_ELEMENT_SET_NUMBER="INVALID_ELEMENT_SET_NUMBER",h.INVALID_INCLINATION="INVALID_INCLINATION",h.INVALID_RIGHT_ASCENSION="INVALID_RIGHT_ASCENSION",h.INVALID_ECCENTRICITY="INVALID_ECCENTRICITY",h.INVALID_ARG_OF_PERIGEE="INVALID_ARG_OF_PERIGEE",h.INVALID_MEAN_ANOMALY="INVALID_MEAN_ANOMALY",h.INVALID_MEAN_MOTION="INVALID_MEAN_MOTION",h.INVALID_REVOLUTION_NUMBER="INVALID_REVOLUTION_NUMBER",h.UNUSUAL_CLASSIFICATION="UNUSUAL_CLASSIFICATION",h.OLD_EPOCH="OLD_EPOCH",h.EXTREME_ECCENTRICITY="EXTREME_ECCENTRICITY",h.EXTREME_INCLINATION="EXTREME_INCLINATION",h.HIGH_MEAN_MOTION="HIGH_MEAN_MOTION",h.LOW_MEAN_MOTION="LOW_MEAN_MOTION",h.PARSE_ERROR="PARSE_ERROR",h.VALIDATION_ERROR="VALIDATION_ERROR",function(e){e.INITIAL="INITIAL",e.READING_NAME="READING_NAME",e.READING_LINE1="READING_LINE1",e.READING_LINE2="READING_LINE2",e.COMPLETE="COMPLETE",e.ERROR="ERROR",e.RECOVERING="RECOVERING"}(u||(u={})),function(e){e.CONTINUE="CONTINUE",e.SKIP_FIELD="SKIP_FIELD",e.USE_DEFAULT="USE_DEFAULT",e.ATTEMPT_FIX="ATTEMPT_FIX",e.ABORT="ABORT"}(m||(m={})),e.ParserState=void 0,function(e){e.INITIAL="INITIAL",e.DETECTING_FORMAT="DETECTING_FORMAT",e.PARSING_NAME="PARSING_NAME",e.PARSING_LINE1="PARSING_LINE1",e.PARSING_LINE2="PARSING_LINE2",e.VALIDATING="VALIDATING",e.COMPLETED="COMPLETED",e.ERROR="ERROR"}(e.ParserState||(e.ParserState={})),e.ErrorSeverity=void 0,(d=e.ErrorSeverity||(e.ErrorSeverity={})).WARNING="warning",d.ERROR="error",d.CRITICAL="critical",e.RecoveryAction=void 0,function(e){e.CONTINUE="CONTINUE",e.SKIP_FIELD="SKIP_FIELD",e.USE_DEFAULT="USE_DEFAULT",e.ATTEMPT_FIX="ATTEMPT_FIX",e.ABORT="ABORT"}(e.RecoveryAction||(e.RecoveryAction={}));class E{constructor(t={}){this.options=Object.assign({attemptRecovery:!0,maxRecoveryAttempts:10,includePartialResults:!0,strictMode:!1},t),this.state=e.ParserState.INITIAL,this.errors=[],this.warnings=[],this.recoveryActions=[],this.parsedData={},this.context={lineCount:0,hasName:!1,nameLineIndex:-1,line1Index:-1,line2Index:-1,lines:[],recoveryAttempts:0},this.reset()}reset(){this.state=e.ParserState.INITIAL,this.errors=[],this.warnings=[],this.recoveryActions=[],this.parsedData={},this.context={lineCount:0,hasName:!1,nameLineIndex:-1,line1Index:-1,line2Index:-1,lines:[],recoveryAttempts:0}}addIssue(t,i,n,a={}){const r=Object.assign({severity:t,code:i,message:n,state:this.state},a);return t===e.ErrorSeverity.WARNING?this.warnings.push(r):this.errors.push(r),r}recordRecovery(e,t,i={}){this.recoveryActions.push(Object.assign({action:e,description:t,state:this.state,timestamp:Date.now()},i)),this.context.recoveryAttempts++}transition(e,t=""){const i=this.state;return this.state=e,{from:i,to:e,reason:t}}parse(t){return this.reset(),"string"!=typeof t?(this.addIssue(e.ErrorSeverity.CRITICAL,e.ERROR_CODES.INVALID_INPUT_TYPE,"TLE data must be a string",{inputType:typeof t}),this.transition(e.ParserState.ERROR),this.getResult()):0===t.length?(this.addIssue(e.ErrorSeverity.CRITICAL,e.ERROR_CODES.EMPTY_INPUT,"TLE string cannot be empty",{inputLength:0}),this.transition(e.ParserState.ERROR),this.getResult()):(this.transition(e.ParserState.DETECTING_FORMAT,"Starting parse"),this.detectFormat(t),this.state===e.ParserState.DETECTING_FORMAT&&this.executeStateMachine(),this.getResult())}detectFormat(t){var i;const n=t.trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0);if(this.context.lines=n,this.context.lineCount=n.length,n.length<2)return this.addIssue(e.ErrorSeverity.CRITICAL,e.ERROR_CODES.INVALID_LINE_COUNT,`TLE must contain at least 2 lines (found ${n.length})`,{expected:"2 or 3",actual:n.length}),this.options.attemptRecovery&&this.recordRecovery(e.RecoveryAction.ABORT,"Insufficient lines to parse TLE",{lineCount:n.length}),void this.transition(e.ParserState.ERROR);if(n.length>3){if(this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.INVALID_LINE_COUNT,`TLE should contain 2 or 3 lines (found ${n.length})`,{expected:"2 or 3",actual:n.length}),this.options.attemptRecovery){this.recordRecovery(e.RecoveryAction.ATTEMPT_FIX,"Attempting to identify valid TLE lines from excess lines",{lineCount:n.length});const t=n.filter(e=>"1"===e[0]),i=n.filter(e=>"2"===e[0]);if(1===t.length&&1===i.length){const a=t[0],r=i[0];if(!a||!r)return;const s=n.indexOf(a),o=n.indexOf(r);if(s<o){s>0&&(this.context.hasName=!0,this.context.nameLineIndex=s-1),this.context.line1Index=s,this.context.line2Index=o;const t=n[this.context.nameLineIndex],i=n[s],a=n[o];this.context.lines=this.context.hasName&&t&&i&&a?[t,i,a]:i&&a?[i,a]:[],this.context.lineCount=this.context.lines.length,this.recordRecovery(e.RecoveryAction.CONTINUE,"Successfully identified TLE lines from excess input",{extractedLines:this.context.lineCount})}}}}else if(3===n.length){const t=null===(i=n[0])||void 0===i?void 0:i[0];"1"!==t&&"2"!==t||this.addIssue(e.ErrorSeverity.WARNING,e.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,'First line starts with "1" or "2", might be missing satellite name',{firstLine:n[0]}),this.context.hasName=!0,this.context.nameLineIndex=0,this.context.line1Index=1,this.context.line2Index=2}else this.context.hasName=!1,this.context.line1Index=0,this.context.line2Index=1}executeStateMachine(){let t=0;for(;this.state!==e.ParserState.COMPLETED&&this.state!==e.ParserState.ERROR&&t<100;){switch(this.state){case e.ParserState.DETECTING_FORMAT:this.context.hasName?this.transition(e.ParserState.PARSING_NAME):this.transition(e.ParserState.PARSING_LINE1);break;case e.ParserState.PARSING_NAME:this.parseSatelliteName(),this.transition(e.ParserState.PARSING_LINE1);break;case e.ParserState.PARSING_LINE1:this.parseLine1(),this.transition(e.ParserState.PARSING_LINE2);break;case e.ParserState.PARSING_LINE2:this.parseLine2(),this.transition(e.ParserState.VALIDATING);break;case e.ParserState.VALIDATING:this.validateCrossFields(),this.errors.some(t=>t.severity===e.ErrorSeverity.CRITICAL)&&!this.options.includePartialResults?this.transition(e.ParserState.ERROR):this.transition(e.ParserState.COMPLETED);break;default:this.transition(e.ParserState.ERROR,"Unexpected state")}t++}t>=100&&(this.addIssue(e.ErrorSeverity.CRITICAL,"STATE_MACHINE_LOOP","State machine exceeded maximum iterations",{iterations:t}),this.transition(e.ParserState.ERROR))}parseSatelliteName(){const t=this.context.nameLineIndex;if(t<0||t>=this.context.lines.length)return void this.addIssue(e.ErrorSeverity.ERROR,"INVALID_NAME_LINE_INDEX","Invalid satellite name line index",{index:t});const i=this.context.lines[t];i&&(this.parsedData.satelliteName=i,i.length>24&&this.addIssue(e.ErrorSeverity.WARNING,e.ERROR_CODES.SATELLITE_NAME_TOO_LONG,"Satellite name exceeds recommended 24 characters",{length:i.length,name:i}),"1"!==i[0]&&"2"!==i[0]||this.addIssue(e.ErrorSeverity.WARNING,e.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,'Satellite name starts with "1" or "2", might be incorrectly formatted',{name:i}))}parseLine1(){const t=this.context.line1Index;if(t<0||t>=this.context.lines.length)return void this.addIssue(e.ErrorSeverity.CRITICAL,"INVALID_LINE1_INDEX","Invalid Line 1 index",{index:t});const i=this.context.lines[t];if(!i)return;if(this.parsedData.line1Raw=i,69!==i.length)if(this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.INVALID_LINE_LENGTH,`Line 1 must be exactly 69 characters (got ${i.length})`,{line:1,expected:69,actual:i.length}),this.options.attemptRecovery)this.recordRecovery(e.RecoveryAction.CONTINUE,"Attempting to parse Line 1 despite incorrect length",{length:i.length});else if(this.options.strictMode)return;this.parseFieldSafe("lineNumber1",i,0,1,"Line 1 number"),this.parseFieldSafe("satelliteNumber1",i,2,7,"Satellite number"),this.parseFieldSafe("classification",i,7,8,"Classification"),this.parseFieldSafe("internationalDesignatorYear",i,9,11,"Int. designator year"),this.parseFieldSafe("internationalDesignatorLaunchNumber",i,11,14,"Int. designator launch"),this.parseFieldSafe("internationalDesignatorPiece",i,14,17,"Int. designator piece"),this.parseFieldSafe("epochYear",i,18,20,"Epoch year"),this.parseFieldSafe("epoch",i,20,32,"Epoch"),this.parseFieldSafe("firstDerivative",i,33,43,"First derivative"),this.parseFieldSafe("secondDerivative",i,44,52,"Second derivative"),this.parseFieldSafe("bStar",i,53,61,"B* drag term"),this.parseFieldSafe("ephemerisType",i,62,63,"Ephemeris type"),this.parseFieldSafe("elementSetNumber",i,64,68,"Element set number"),this.parseFieldSafe("checksum1",i,68,69,"Checksum"),"1"!==this.parsedData.lineNumber1&&this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.INVALID_LINE_NUMBER,`Line 1 must start with '1' (got '${this.parsedData.lineNumber1}')`,{line:1,expected:"1",actual:this.parsedData.lineNumber1});const n=["U","C","S"];if(this.parsedData.classification&&!n.includes(this.parsedData.classification)&&this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.INVALID_CLASSIFICATION,`Classification must be U, C, or S (got '${this.parsedData.classification}')`,{expected:n,actual:this.parsedData.classification}),69===i.length){const t=this.calculateChecksum(i),n=parseInt(this.parsedData.checksum1||"",10);isNaN(n)||t===n||(this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.CHECKSUM_MISMATCH,`Line 1 checksum mismatch (expected ${t}, got ${n})`,{line:1,expected:t,actual:n}),this.options.attemptRecovery&&this.recordRecovery(e.RecoveryAction.CONTINUE,"Continuing despite checksum mismatch",{line:1}))}}parseLine2(){const t=this.context.line2Index;if(t<0||t>=this.context.lines.length)return void this.addIssue(e.ErrorSeverity.CRITICAL,"INVALID_LINE2_INDEX","Invalid Line 2 index",{index:t});const i=this.context.lines[t];if(i){if(this.parsedData.line2Raw=i,69!==i.length)if(this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.INVALID_LINE_LENGTH,`Line 2 must be exactly 69 characters (got ${i.length})`,{line:2,expected:69,actual:i.length}),this.options.attemptRecovery)this.recordRecovery(e.RecoveryAction.CONTINUE,"Attempting to parse Line 2 despite incorrect length",{length:i.length});else if(this.options.strictMode)return;if(this.parseFieldSafe("lineNumber2",i,0,1,"Line 2 number"),this.parseFieldSafe("satelliteNumber2",i,2,7,"Satellite number"),this.parseFieldSafe("inclination",i,8,16,"Inclination"),this.parseFieldSafe("rightAscension",i,17,25,"Right ascension"),this.parseFieldSafe("eccentricity",i,26,33,"Eccentricity"),this.parseFieldSafe("argumentOfPerigee",i,34,42,"Argument of perigee"),this.parseFieldSafe("meanAnomaly",i,43,51,"Mean anomaly"),this.parseFieldSafe("meanMotion",i,52,63,"Mean motion"),this.parseFieldSafe("revolutionNumber",i,63,68,"Revolution number"),this.parseFieldSafe("checksum2",i,68,69,"Checksum"),"2"!==this.parsedData.lineNumber2&&this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.INVALID_LINE_NUMBER,`Line 2 must start with '2' (got '${this.parsedData.lineNumber2}')`,{line:2,expected:"2",actual:this.parsedData.lineNumber2}),69===i.length){const t=this.calculateChecksum(i),n=parseInt(this.parsedData.checksum2||"",10);isNaN(n)||t===n||(this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.CHECKSUM_MISMATCH,`Line 2 checksum mismatch (expected ${t}, got ${n})`,{line:2,expected:t,actual:n}),this.options.attemptRecovery&&this.recordRecovery(e.RecoveryAction.CONTINUE,"Continuing despite checksum mismatch",{line:2}))}}}validateCrossFields(){if(this.parsedData.satelliteNumber1&&this.parsedData.satelliteNumber2){const t=this.parsedData.satelliteNumber1.trim(),i=this.parsedData.satelliteNumber2.trim();t!==i&&this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.SATELLITE_NUMBER_MISMATCH,`Satellite numbers must match (Line 1: ${t}, Line 2: ${i})`,{line1Value:t,line2Value:i})}if(this.validateNumericField("inclination",0,180,"Inclination"),this.validateNumericField("rightAscension",0,360,"Right Ascension"),this.validateNumericField("argumentOfPerigee",0,360,"Argument of Perigee"),this.validateNumericField("meanAnomaly",0,360,"Mean Anomaly"),this.parsedData.eccentricity){const t=parseFloat("0."+this.parsedData.eccentricity.trim());!isNaN(t)&&(t<0||t>1)&&this.addIssue(e.ErrorSeverity.ERROR,e.ERROR_CODES.VALUE_OUT_OF_RANGE,`Eccentricity must be between 0 and 1 (got ${t})`,{field:"eccentricity",value:t,min:0,max:1})}this.validateNumericField("meanMotion",0,20,"Mean Motion",!0),this.validateNumericField("epochYear",0,99,"Epoch Year")}validateNumericField(t,i,n,a,r=!1){const s=this.parsedData[t];if(!s||"string"!=typeof s)return;const o=parseFloat(s.trim());isNaN(o)?this.addIssue(r?e.ErrorSeverity.WARNING:e.ErrorSeverity.ERROR,e.ERROR_CODES.INVALID_NUMBER_FORMAT,`${a} must be numeric (got '${s}')`,{field:t,value:s}):(o<i||o>n)&&this.addIssue(r?e.ErrorSeverity.WARNING:e.ErrorSeverity.ERROR,e.ERROR_CODES.VALUE_OUT_OF_RANGE,`${a} must be between ${i} and ${n} (got ${o})`,{field:t,value:o,min:i,max:n})}parseFieldSafe(t,i,n,a,r){try{i.length>=a?this.parsedData[t]=i.substring(n,a).trim():i.length>n?(this.parsedData[t]=i.substring(n).trim(),this.addIssue(e.ErrorSeverity.WARNING,"PARTIAL_FIELD",`${r} is incomplete due to short line`,{field:t,expected:[n,a],actual:i.length}),this.options.attemptRecovery&&this.recordRecovery(e.RecoveryAction.USE_DEFAULT,`Using partial value for ${r}`,{field:t})):(this.parsedData[t]=null,this.addIssue(e.ErrorSeverity.WARNING,"MISSING_FIELD",`${r} is missing due to short line`,{field:t,expected:[n,a],actual:i.length}),this.options.attemptRecovery&&this.recordRecovery(e.RecoveryAction.USE_DEFAULT,`Using null for missing ${r}`,{field:t}))}catch(i){this.parsedData[t]=null;const n=i instanceof Error?i.message:String(i);this.addIssue(e.ErrorSeverity.ERROR,"FIELD_PARSE_ERROR",`Error parsing ${r}: ${n}`,{field:t,error:n})}}calculateChecksum(e){let t=0;for(let i=0;i<e.length-1;i++){const n=e[i];n&&n>="0"&&n<="9"?t+=parseInt(n,10):"-"===n&&(t+=1)}return t%10}getResult(){const t=this.errors.map(t=>Object.assign({code:t.code,message:t.message,severity:t.severity===e.ErrorSeverity.CRITICAL?"error":t.severity},Object.fromEntries(Object.entries(t).filter(([e])=>!["severity","code","message","state"].includes(e))))),i=this.warnings.map(e=>Object.assign({code:e.code,message:e.message,severity:"warning"},Object.fromEntries(Object.entries(e).filter(([e])=>!["severity","code","message","state"].includes(e)))));return{success:this.state===e.ParserState.COMPLETED,state:this.state,data:this.parsedData,errors:t,warnings:i,recoveryActions:this.recoveryActions.map(e=>e.action),partialData:this.options.includePartialResults?this.parsedData:void 0,context:{lineCount:this.context.lineCount,hasName:this.context.hasName,recoveryAttempts:this.context.recoveryAttempts}}}}function g(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(i[n[a]]=e[n[a]])}return i}function f(e,t,i,n){return new(i||(i=Promise))(function(a,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function o(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,o)}c((n=n.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;const N=r.promisify(i.readFile);function R(e,t={}){const{filter:i,continueOnError:n=!1,limit:a,skip:r=0,onTLE:s,onError:o}=t,c=g(t,["filter","continueOnError","limit","skip","onTLE","onError"]),l=[],h=T(e);let u=0;for(let e=0;e<h.length;e++){if(e<r)continue;if(void 0!==a&&u>=a)break;const t=h[e];if(t)try{const n=xt(t,c);if(i&&!I(n,i))continue;l.push(n),u++,s&&s(n,e)}catch(i){if(o&&o(i,e,t),!n)throw i}}return l}function T(e){const t=Tt(e).split("\n").map(e=>e.trim()).filter(e=>e.length>0),i=[];let n=[];for(const e of t)e.startsWith("#")?n.length>0&&n.push(e):"1"===e[0]?(n.length>=2&&i.push(n.join("\n")),n=[e]):"2"===e[0]?n.push(e):n.length>=2?(i.push(n.join("\n")),n=[e]):0===n.length?n=[e]:n.push(e);return n.length>=2&&i.push(n.join("\n")),i}function A(e){return f(this,arguments,void 0,function*(e,t={}){return Promise.resolve(xt(e,t))})}function I(e,t){if(void 0!==t.satelliteNumber){const i=e.satelliteNumber1||"";if("function"==typeof t.satelliteNumber){if(!t.satelliteNumber(i))return!1}else if(Array.isArray(t.satelliteNumber)){if(!t.satelliteNumber.includes(i))return!1}else if(i!==t.satelliteNumber)return!1}if(void 0!==t.satelliteName&&e.satelliteName){const i=e.satelliteName;if("function"==typeof t.satelliteName){if(!t.satelliteName(i))return!1}else if(Array.isArray(t.satelliteName)){if(!t.satelliteName.some(e=>i.includes(e)))return!1}else if(!i.includes(t.satelliteName))return!1}if(void 0!==t.intlDesignator){const i=`${e.internationalDesignatorYear||""}${e.internationalDesignatorLaunchNumber||""}${e.internationalDesignatorPiece||""}`.trim();if("function"==typeof t.intlDesignator){if(!t.intlDesignator(i))return!1}else if(Array.isArray(t.intlDesignator)){if(!t.intlDesignator.includes(i))return!1}else if(i!==t.intlDesignator)return!1}if(void 0!==t.classification){const i=e.classification;if(Array.isArray(t.classification)){if(!t.classification.includes(i))return!1}else if(i!==t.classification)return!1}if(t.epochRange){const i=parseInt(e.epochYear||"0",10),n=e.epoch||"0",a=parseFloat(n),r=new Date(i>=57?1900+i:2e3+i,0,1);if(r.setDate(r.getDate()+a-1),t.epochRange.start&&r<t.epochRange.start)return!1;if(t.epochRange.end&&r>t.epochRange.end)return!1}if(t.inclinationRange){const i=parseFloat(e.inclination||"0");if(void 0!==t.inclinationRange.min&&i<t.inclinationRange.min)return!1;if(void 0!==t.inclinationRange.max&&i>t.inclinationRange.max)return!1}return!(t.custom&&!t.custom(e))}class O extends s.Transform{constructor(e={}){super({objectMode:!0,highWaterMark:e.highWaterMark||16}),this.buffer="",this.index=0,this.options=e}_transform(e,t,i){this.buffer+=e.toString();const n=this.buffer.split("\n");this.buffer=n.pop()||"";let a=[];for(const e of n){const t=e.trim();0!==t.length&&(t.startsWith("#")?a.push(t):"1"===t[0]?(a.length>=2&&this.processTLE(a.join("\n")),a=[t]):"2"===t[0]?(a.push(t),a.length>=2&&(this.processTLE(a.join("\n")),a=[])):(a.length>=2&&this.processTLE(a.join("\n")),a=[t]))}i()}_flush(e){if(this.buffer.trim().length>0){const e=this.buffer.split("\n").filter(e=>e.trim().length>0);e.length>=2&&this.processTLE(e.join("\n"))}e()}processTLE(e){const t=this.options,{continueOnError:i=!0,filter:n,onTLE:a,onError:r}=t,s=g(t,["continueOnError","filter","onTLE","onError"]);try{const t=xt(e,s);if(n&&!I(t,n))return;this.push(t),a&&a(t,this.index),this.index++}catch(t){r&&r(t,this.index,e),i||this.destroy(t),this.index++}}}function M(e={}){return new O(e)}function S(e){return f(this,arguments,void 0,function*(e,t={}){return new Promise((i,n)=>{const a=[],r=M(Object.assign(Object.assign({},t),{onTLE:(e,i)=>{a.push(e),t.onTLE&&t.onTLE(e,i)}}));e.pipe(r).on("data",()=>{}).on("end",()=>i(a)).on("error",n)})})}class _{constructor(){this.middlewares=[],this.plugins=[]}use(e){return this.middlewares.push(e),this}plugin(e){return this.plugins.push(e),e.middleware&&this.use(e.middleware),this}parse(e){return f(this,arguments,void 0,function*(e,t={}){const i={rawTLE:e,options:t,metadata:{}},n=e=>f(this,void 0,void 0,function*(){if(e>=this.middlewares.length)return xt(i.rawTLE,i.options);const t=this.middlewares[e];return t?t(i,()=>n(e+1)):xt(i.rawTLE,i.options)});return n(0)})}parseBatch(e){return f(this,arguments,void 0,function*(e,t={}){for(const e of this.plugins)e.onBatchStart&&(yield e.onBatchStart(t));const i=[],n=T(e);for(let e=0;e<n.length;e++){const a=n[e];if(a)try{const n=yield this.parse(a,t);if(t.filter&&!I(n,t.filter))continue;i.push(n);for(const t of this.plugins)t.onTLEParsed&&(yield t.onTLEParsed(n,e));t.onTLE&&t.onTLE(n,e)}catch(i){for(const t of this.plugins)t.onError&&(yield t.onError(i,e));if(t.onError&&t.onError(i,e,a),!t.continueOnError)throw i}}for(const e of this.plugins)e.onBatchEnd&&(yield e.onBatchEnd(i));return i})}}class y{constructor(e={}){this.cache=new Map,this.maxSize=e.maxSize||1e3,this.ttl=e.ttl||36e5,this.keyGenerator=e.keyGenerator||this.defaultKeyGenerator}defaultKeyGenerator(e,t){return`${e}:${JSON.stringify(t)}`}get(e,t={}){const i=this.keyGenerator(e,t),n=this.cache.get(i);return n?Date.now()-n.timestamp>this.ttl?(this.cache.delete(i),null):(this.cache.delete(i),this.cache.set(i,n),n.tle):null}set(e,t,i={}){const n=this.keyGenerator(e,i);if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(n,{tle:t,timestamp:Date.now()})}clear(){this.cache.clear()}size(){return this.cache.size}}function v(e){return{strict:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},permissive:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0},fast:{validate:!1,includeWarnings:!1,includeComments:!1},realtime:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!1,includeComments:!1},batch:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!1,includeComments:!1},recovery:{validate:!1,includeWarnings:!0,includeComments:!0},legacy:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0}}[e]}class C{constructor(e,t={}){this.buffer="",this.currentSet=[],this.onTLE=e,this.options=t}push(e){this.buffer+=e,this.processBuffer()}flush(){this.currentSet.length>=2&&(this.emitTLE(this.currentSet.join("\n")),this.currentSet=[])}processBuffer(){const e=this.buffer.split("\n");this.buffer=e.pop()||"";for(const t of e){const e=t.trim();0!==e.length&&(e.startsWith("#")?this.currentSet.push(e):"1"===e[0]?(this.currentSet.length>=2&&this.emitTLE(this.currentSet.join("\n")),this.currentSet=[e]):"2"===e[0]?(this.currentSet.push(e),this.currentSet.length>=2&&(this.emitTLE(this.currentSet.join("\n")),this.currentSet=[])):(this.currentSet.length>=2&&this.emitTLE(this.currentSet.join("\n")),this.currentSet=[e]))}}emitTLE(e){try{const t=xt(e,this.options);this.onTLE(t)}catch(e){}}}function L(e){return{celestrak:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},spacetrack:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},amsat:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0},custom:{validate:!1,includeWarnings:!0,includeComments:!0}}[e]}const D={meanMotion:{min:0,max:20,typical:{min:10,max:17}},eccentricity:{min:0,max:.999999,typical:{min:0,max:.25}},inclination:{min:0,max:180,typical:{min:0,max:100}},rightAscension:{min:0,max:360},argumentOfPerigee:{min:0,max:360},meanAnomaly:{min:0,max:360},bStar:{min:-1,max:1,typical:{min:-.001,max:.001}},meanMotionFirstDerivative:{min:-1,max:1,typical:{min:-.001,max:.001}},meanMotionSecondDerivative:{min:-1,max:1,typical:{min:-1e-5,max:1e-5}},revolutionNumber:{min:0,max:99999},elementSetNumber:{min:0,max:999},ephemerisType:{min:0,max:9}},b={min:1,max:999999,historical5Digit:99999,modern6Digit:999999},x={minYear:57,maxYear:99,minDayOfYear:1,maxDayOfYear:366.99999999,warningAgeThreshold:7,criticalAgeThreshold:30,maxFutureDays:30},w={yearMin:57,yearMax:99,launchNumberMin:1,launchNumberMax:999,piecePattern:/^[A-Z]{1,3}$/},$={checksumValid:20,fieldFormatValid:15,parametersInRange:15,parametersInTypicalRange:10,epochRecent:15,noAnomalies:10,designatorValid:5,consistencyChecks:10};function F(e,t){let i;i=e>=57?1900+e:2e3+e;const n=new Date(Date.UTC(i,0,1)).getTime()+864e5*(t-1),a=new Date(n),r=Math.floor((14-(a.getUTCMonth()+1))/12),s=i+4800-r,o=a.getUTCMonth()+1+12*r-3,c=a.getUTCDate()+Math.floor((153*o+2)/5)+365*s+Math.floor(s/4)-Math.floor(s/100)+Math.floor(s/400)-32045+(a.getUTCHours()+a.getUTCMinutes()/60+a.getUTCSeconds()/3600)/24,l=c-2400000.5;return{year:i,twoDigitYear:e,dayOfYear:t,isoDate:a.toISOString(),date:a,julianDate:c,modifiedJulianDate:l}}function P(e,t){const i=[];if((e<x.minYear||e>x.maxYear)&&i.push(`Epoch year ${e} outside valid range [${x.minYear}, ${x.maxYear}]`),(t<x.minDayOfYear||t>x.maxDayOfYear)&&i.push(`Epoch day ${t} outside valid range [${x.minDayOfYear}, ${x.maxDayOfYear}]`),i.length>0)return{valid:!1,message:i.join("; "),context:{epochYear:e,epochDay:t}};const n=F(e,t),a=n.year,r=a%4==0&&a%100!=0||a%400==0,s=r?366:365;return Math.floor(t)>s&&i.push(`Day ${Math.floor(t)} exceeds maximum for ${a} (${r?"leap year":"non-leap year"}: ${s} days)`),i.length>0?{valid:!1,message:i.join("; "),context:{epochYear:e,epochDay:t,fullYear:a,isLeapYear:r}}:{valid:!0,context:{epochDate:n}}}function U(e,t,i=new Date){const n=F(e,t);return(i.getTime()-n.date.getTime())/864e5}function V(e,t,i={}){const n=U(e,t,i.referenceDate||new Date),a=[];if(n<0){const e=Math.abs(n);if(!i.allowFuture)return{valid:!1,message:`Epoch is ${e.toFixed(2)} days in the future`,context:{age:n,futureDays:e}};e>x.maxFutureDays&&a.push(`Epoch is ${e.toFixed(2)} days in the future (threshold: ${x.maxFutureDays} days)`)}if(n>0){const e=i.maxAge||x.criticalAgeThreshold;n>e&&a.push(`Epoch is ${n.toFixed(2)} days old (threshold: ${e} days)`)}return{valid:!0,message:a.length>0?a.join("; "):void 0,context:{age:n}}}function G(e,t,i=!1){const n=D[e];if(!n)return{valid:!1,message:`Unknown parameter: ${e}`};if(t<n.min||t>n.max)return{valid:!1,message:`${e} value ${t} outside valid range [${n.min}, ${n.max}]`,context:{paramName:e,value:t,min:n.min,max:n.max}};if(i&&"typical"in n&&n.typical){const i=n.typical;if(t<i.min||t>i.max)return{valid:!0,message:`${e} value ${t} outside typical range [${i.min}, ${i.max}]`,context:{paramName:e,value:t,typicalMin:i.min,typicalMax:i.max,outsideTypical:!0}}}return{valid:!0,context:{paramName:e,value:t}}}function k(e,t=!1){const i=[],n={meanMotion:{field:"meanMotion",param:"meanMotion"},eccentricity:{field:"eccentricity",param:"eccentricity"},inclination:{field:"inclination",param:"inclination"},rightAscension:{field:"rightAscension",param:"rightAscension"},argumentOfPerigee:{field:"argumentOfPerigee",param:"argumentOfPerigee"},meanAnomaly:{field:"meanAnomaly",param:"meanAnomaly"},bStar:{field:"bStar",param:"bStar"},firstDerivative:{field:"firstDerivative",param:"meanMotionFirstDerivative"},secondDerivative:{field:"secondDerivative",param:"meanMotionSecondDerivative"},revolutionNumber:{field:"revolutionNumber",param:"revolutionNumber"},elementSetNumber:{field:"elementSetNumber",param:"elementSetNumber"},ephemerisType:{field:"ephemerisType",param:"ephemerisType"}};for(const[a,r]of Object.entries(n)){const n=parseFloat(e[r.field]);if(isNaN(n)){i.push({valid:!1,message:`Field ${a} is not a valid number`,context:{field:a,value:e[r.field]}});continue}const s=G(r.param,n,t);s.valid&&!s.message||i.push(Object.assign(Object.assign({},s),{context:Object.assign(Object.assign({},s.context),{field:a})}))}return i}function z(e,t){if(e.length<69)return{valid:!1,message:`Line ${t} is too short (${e.length} chars, expected 69)`,context:{lineNumber:t,length:e.length}};const i=e.charAt(68),n=parseInt(i,10),a=function(e){let t=0;const i=e.substring(0,68);for(const e of i)e>="0"&&e<="9"?t+=parseInt(e,10):"-"===e&&(t+=1);return t%10}(e);return isNaN(n)?{valid:!1,message:`Line ${t} checksum is not a digit: '${i}'`,context:{lineNumber:t,checksumChar:i}}:a!==n?{valid:!1,message:`Line ${t} checksum mismatch: expected ${n}, calculated ${a}`,context:{lineNumber:t,expected:n,calculated:a,line:e.substring(0,68)}}:{valid:!0,context:{lineNumber:t,checksum:a}}}function Y(e){const t="-"===(e=e.trim())[0]?-1:1,i=e.replace(/^[-+\s]+/,"").replace(/\s+/g,""),n=i.match(/([+-])(\d+)$/);if(!n)return t*parseFloat("0."+i);const a=i.substring(0,i.length-n[0].length),r="-"===(n[1]||"+")?-1:1,s=parseInt(n[2]||"0",10);return t*parseFloat("0."+a)*Math.pow(10,r*s)}function H(e){const t="string"==typeof e?parseInt(e.trim(),10):e;return isNaN(t)?{valid:!1,message:`Satellite number is not a valid integer: '${e}'`,context:{satelliteNumber:e}}:t<b.min||t>b.max?{valid:!1,message:`Satellite number ${t} outside valid range [${b.min}, ${b.max}]`,context:{satelliteNumber:t,min:b.min,max:b.max}}:{valid:!0,context:{satelliteNumber:t,format:t<=b.historical5Digit?"5-digit":"6-digit"}}}function j(e){const t=e.trim(),i=t.match(/^(\d{2})(\d{1,3})([A-Z]{1,3})$/);if(!i)return{valid:!1,message:`Invalid international designator format: '${e}' (expected YYLLLPPP)`,context:{designator:t}};const n=i[1]||"0",a=i[2]||"0",r=i[3]||"",s=parseInt(n,10),o=parseInt(a,10);return s<w.yearMin||s>w.yearMax?{valid:!1,message:`International designator year ${s} outside valid range [${w.yearMin}, ${w.yearMax}]`,context:{designator:t,year:s}}:o<w.launchNumberMin||o>w.launchNumberMax?{valid:!1,message:`International designator launch number ${o} outside valid range [${w.launchNumberMin}, ${w.launchNumberMax}]`,context:{designator:t,launchNumber:o}}:w.piecePattern.test(r)?{valid:!0,context:{designator:t,year:s,launchNumber:o,piece:r,fullYear:s>=w.yearMin?1900+s:2e3+s}}:{valid:!1,message:`International designator piece '${r}' invalid (must be 1-3 uppercase letters)`,context:{designator:t,piece:r}}}const W=.01,B=.01;function q(e){const t=[],i=parseFloat(e.eccentricity),n=parseFloat(e.meanMotion),a=parseFloat(e.inclination),r=Y(e.bStar),s=parseFloat(e.firstDerivative),o=parseInt(e.revolutionNumber,10);return i>.5&&t.push({hasAnomaly:!0,type:"HIGH_ECCENTRICITY",description:`Unusually high eccentricity: ${i.toFixed(6)} (threshold: 0.5)`,severity:i>.9?"error":"warning",score:Math.min(i/.5,1)}),n<1&&t.push({hasAnomaly:!0,type:"LOW_MEAN_MOTION",description:`Unusually low mean motion: ${n.toFixed(8)} rev/day (threshold: 1)`,severity:"warning",score:1-n/1}),n>18&&t.push({hasAnomaly:!0,type:"HIGH_MEAN_MOTION",description:`Unusually high mean motion: ${n.toFixed(8)} rev/day (threshold: 18)`,severity:"warning",score:Math.min(n/18,1)}),a>90&&a<180&&t.push({hasAnomaly:!0,type:"RETROGRADE_ORBIT",description:`Retrograde orbit detected: inclination ${a.toFixed(4)}Â° (>90Â°)`,severity:"info",score:(a-90)/90}),Math.abs(r)>W&&t.push({hasAnomaly:!0,type:"HIGH_DRAG",description:`Unusually high drag coefficient: B* = ${r.toExponential(4)} (threshold: 0.01)`,severity:"warning",score:Math.min(Math.abs(r)/W,1)}),Math.abs(s)>B&&t.push({hasAnomaly:!0,type:"RAPID_ORBITAL_CHANGE",description:`Rapid orbital evolution: dn/dt = ${s.toFixed(8)} (threshold: 0.01)`,severity:"warning",score:Math.min(Math.abs(s)/B,1)}),o<100&&t.push({hasAnomaly:!0,type:"NEW_SATELLITE",description:`Recently launched satellite: revolution number ${o}`,severity:"info",score:1-o/100}),0===i&&t.push({hasAnomaly:!0,type:"CIRCULAR_ORBIT",description:"Perfect circular orbit (eccentricity = 0)",severity:"info",score:.1}),t}function K(e,t){let i=0;const n={checksumScore:0,formatScore:0,rangeScore:0,epochScore:0,anomalyScore:0,consistencyScore:0};t.checksumValid&&(n.checksumScore=$.checksumValid),t.formatValid&&(n.formatScore=$.fieldFormatValid);const a=t.rangeErrors.filter(e=>!e.valid),r=t.rangeResults.filter(e=>e.valid&&e.message);if(0===a.length)n.rangeScore=$.parametersInRange,0===r.length&&(n.rangeScore+=$.parametersInTypicalRange);else{const e=a.length+r.length,t=r.length;n.rangeScore=t/e*$.parametersInRange}const s=Math.abs(t.epochAge);n.epochScore=s<=1?$.epochRecent:s<=x.warningAgeThreshold?.9*$.epochRecent:s<=x.criticalAgeThreshold?.5*$.epochRecent:.2*$.epochRecent;const o={error:1,warning:.5,info:.1},c=t.anomalies.reduce((e,t)=>{const i=o[t.severity||"info"];return e+(t.score||.5)*i},0);n.anomalyScore=Math.max(0,$.noAnomalies-2*c);let l,h,u=$.consistencyChecks;return e.satelliteNumber1!==e.satelliteNumber2&&(u-=5),["U","C","S"].includes(e.classification)||(u-=2),j(e.internationalDesignatorYear+e.internationalDesignatorLaunchNumber+e.internationalDesignatorPiece).valid||(u-=3),n.consistencyScore=Math.max(0,u),i=Object.values(n).reduce((e,t)=>e+t,0),l=i>=90?"A":i>=80?"B":i>=70?"C":i>=60?"D":"F",h="A"===l?"Excellent quality - TLE is fresh, valid, and anomaly-free":"B"===l?"Good quality - TLE is valid with minor warnings":"C"===l?"Acceptable quality - TLE has some issues but is usable":"D"===l?"Poor quality - TLE has significant issues, use with caution":"Invalid - TLE has critical errors and should not be used",{overall:Math.round(i),components:n,grade:l,assessment:h}}function J(e,t){let i=e;const n=[];i.includes("\0")&&(i=i.replace(/\0/g,""),n.push("Removed null bytes")),i.includes("\t")&&(i=i.replace(/\t/g," "),n.push("Normalized tabs to spaces"));const a=/[\x00-\x1F\x7F-\x9F]/g;switch(a.test(i)&&(i=i.replace(a,""),n.push("Removed non-printable characters")),t){case"satelliteName":/^[A-Z0-9\s\-\(\)]+$/i.test(i)||(i=i.replace(/[^A-Z0-9\s\-\(\)]/gi,""),n.push("Removed invalid characters from satellite name"));break;case"classification":i=i.trim().toUpperCase(),i.length>1&&(i=i.charAt(0),n.push("Truncated classification to single character"));break;case"internationalDesignatorYear":case"internationalDesignatorLaunchNumber":case"satelliteNumber1":case"satelliteNumber2":case"elementSetNumber":case"revolutionNumber":/^\d+$/.test(i.trim())||(i=i.replace(/\D/g,""),n.push(`Removed non-numeric characters from ${t}`));break;case"internationalDesignatorPiece":{const e=i;i=i.trim().toUpperCase().replace(/[^A-Z]/g,""),i!==e.trim()&&n.push("Normalized designator piece to uppercase letters");break}}const r=i.trim();return r!==i&&(i=r,n.push("Trimmed whitespace")),{value:i,modified:n.length>0,modifications:n.length>0?n:void 0}}function Z(e){const t=new Map;for(const[i,n]of Object.entries(e))if("string"==typeof n){const e=J(n,i);e.modified&&t.set(i,e)}return t}const X=[{name:"checksum",description:"Validate line checksums",severity:"error",enabled:!0,validate:()=>({valid:!0})},{name:"satelliteNumberRange",description:"Validate satellite number is in valid range",severity:"error",enabled:!0,validate:e=>H(e)},{name:"epochDate",description:"Validate epoch date format and range",severity:"error",enabled:!0,validate:e=>P(parseInt(e.epochYear,10),parseFloat(e.epoch))},{name:"epochAge",description:"Warn if epoch is stale or in future",severity:"warning",enabled:!0,validate:(e,t)=>V(parseInt(e.epochYear,10),parseFloat(e.epoch),{referenceDate:null==t?void 0:t.referenceDate})},{name:"internationalDesignator",description:"Validate international designator format",severity:"warning",enabled:!0,validate:e=>j(e.internationalDesignatorYear+e.internationalDesignatorLaunchNumber+e.internationalDesignatorPiece)},{name:"orbitalParameterRanges",description:"Validate orbital parameters are in valid ranges",severity:"error",enabled:!0,validate:e=>{const t=k(e,!1).filter(e=>!e.valid);return t.length>0?{valid:!1,message:t.map(e=>e.message).join("; "),context:{errors:t}}:{valid:!0}}},{name:"anomalyDetection",description:"Detect unusual orbital parameters",severity:"warning",enabled:!1,validate:e=>{const t=q(e);return t.length>0?{valid:!0,message:`${t.length} anomalies detected`,context:{anomalies:t}}:{valid:!0}}}];function Q(e){return e.satelliteNumber1||e.satelliteNumber2||""}function ee(e){return`${e.internationalDesignatorYear||""}${e.internationalDesignatorLaunchNumber||""}${e.internationalDesignatorPiece||""}`.trim()}const te={reset:"[0m",bright:"[1m",dim:"[2m",black:"[30m",red:"[31m",green:"[32m",yellow:"[33m",blue:"[34m",magenta:"[35m",cyan:"[36m",white:"[37m",bgBlack:"[40m",bgRed:"[41m",bgGreen:"[42m",bgYellow:"[43m",bgBlue:"[44m",bgMagenta:"[45m",bgCyan:"[46m",bgWhite:"[47m"};function ie(e,t,i=!0){return i?`${t}${e}${te.reset}`:e}function ne(e,t={}){const{pretty:i=!1,includeWarnings:n=!0,includeComments:a=!0,verbosity:r="normal"}=t,s=e=>{const t=Object.assign({},e);return!n&&"warnings"in t&&delete t.warnings,!a&&"comments"in t&&delete t.comments,"compact"===r?{satelliteName:t.satelliteName,satelliteNumber:Q(t),epoch:t.epochYear+":"+t.epoch,inclination:t.inclination,eccentricity:t.eccentricity,meanMotion:t.meanMotion}:t},o=Array.isArray(e)?e.map(s):s(e);return JSON.stringify(o,null,i?2:0)}function ae(e,t={}){const{includeHeader:i=!0,delimiter:n=",",quote:a=!0,verbosity:r="normal"}=t,s=Array.isArray(e)?e:[e],o=[],c=Object.keys(s[0]||{}).filter(e=>!["warnings","comments","checksum1","checksum2","lineNumber1","lineNumber2"].includes(e)),l="compact"===r?["satelliteName","satelliteNumber1","epochYear","epoch","inclination","eccentricity","meanMotion"]:"verbose"===r?c:["satelliteName","satelliteNumber1","classification","epochYear","epoch","firstDerivative","secondDerivative","bStar","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion","revolutionNumber"];i&&o.push(l.map(e=>a?`"${e}"`:e).join(n));for(const e of s){const t=l.map(t=>{var i;const n=null!==(i=e[t])&&void 0!==i?i:"",r=String(n);return a?`"${r.replace(/"/g,'""')}"`:r});o.push(t.join(n))}return o.join("\n")}function re(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function se(e,t={}){const{pretty:i=!1,includeWarnings:n=!0,includeComments:a=!0}=t,r=i?"  ":"",s=i?"\n":"",o=Array.isArray(e)?e:[e],c=['<?xml version="1.0" encoding="UTF-8"?>'];c.push(`<tles>${s}`);for(const e of o){c.push(`${r}<tle>${s}`);for(const[t,i]of Object.entries(e))if(("warnings"!==t||n)&&("comments"!==t||a))if(Array.isArray(i)){c.push(`${r}${r}<${t}>${s}`);for(const e of i){const t="object"==typeof e?JSON.stringify(e):String(e);c.push(`${r}${r}${r}<item>${re(t)}</item>${s}`)}c.push(`${r}${r}</${t}>${s}`)}else{const e=re(String(null!=i?i:""));c.push(`${r}${r}<${t}>${e}</${t}>${s}`)}c.push(`${r}</tle>${s}`)}return c.push("</tles>"),c.join("")}function oe(e,t={}){const{includeWarnings:i=!0,includeComments:n=!0}=t,a=Array.isArray(e)?e:[e],r=[],s=(e,t=0)=>{const i="  ".repeat(t);return null==e?"null":"string"==typeof e?/[:#\[\]{},&*!|>'"%@`]/.test(e)||/^\s|\s$/.test(e)?`"${e.replace(/"/g,'\\"')}"`:e:"number"==typeof e||"boolean"==typeof e?String(e):Array.isArray(e)?0===e.length?"[]":"\n"+e.map(e=>{if("object"==typeof e&&null!==e){const n=o(e,t+1);return`${i}  -${n.substring(i.length+3)}`}return`${i}  - ${s(e,0)}`}).join("\n"):"object"==typeof e?"\n"+o(e,t+1):String(e)},o=(e,t=0)=>{const a="  ".repeat(t),r=[];for(const[o,c]of Object.entries(e)){if("warnings"===o&&!i)continue;if("comments"===o&&!n)continue;const e=s(c,t);e.startsWith("\n")?r.push(`${a}${o}:${e}`):r.push(`${a}${o}: ${e}`)}return r.join("\n")};if(1===a.length)return o(a[0],0);r.push("tles:");for(const e of a){r.push("  -");const t=o(e,2);r.push(t)}return r.join("\n")}function ce(e,t={}){const{colors:i=!1,verbosity:n="normal",includeWarnings:a=!0}=t,r=[];if(r.push(ie("â•".repeat(70),te.cyan,i)),r.push(ie(`  ${e.satelliteName||"Unknown Satellite"}`,te.bright+te.cyan,i)),r.push(ie("â•".repeat(70),te.cyan,i)),r.push(""),r.push(ie("Basic Information:",te.bright+te.yellow,i)),r.push(`  ${ie("Satellite Number:",te.green,i)} ${Q(e)}`),r.push(`  ${ie("Classification:",te.green,i)} ${e.classification||"N/A"}`),r.push(`  ${ie("International Designator:",te.green,i)} ${ee(e)||"N/A"}`),r.push(""),r.push(ie("Epoch Information:",te.bright+te.yellow,i)),r.push(`  ${ie("Epoch Year:",te.green,i)} ${e.epochYear}`),r.push(`  ${ie("Epoch Day:",te.green,i)} ${e.epoch}`),r.push(""),r.push(ie("Orbital Parameters:",te.bright+te.yellow,i)),r.push(`  ${ie("Inclination:",te.green,i)} ${e.inclination}Â°`),r.push(`  ${ie("Right Ascension:",te.green,i)} ${e.rightAscension}Â°`),r.push(`  ${ie("Eccentricity:",te.green,i)} ${e.eccentricity}`),r.push(`  ${ie("Argument of Perigee:",te.green,i)} ${e.argumentOfPerigee}Â°`),r.push(`  ${ie("Mean Anomaly:",te.green,i)} ${e.meanAnomaly}Â°`),r.push(`  ${ie("Mean Motion:",te.green,i)} ${e.meanMotion} rev/day`),r.push(""),"verbose"===n&&(r.push(ie("Additional Parameters:",te.bright+te.yellow,i)),r.push(`  ${ie("First Derivative (Mean Motion):",te.green,i)} ${e.firstDerivative}`),r.push(`  ${ie("Second Derivative (Mean Motion):",te.green,i)} ${e.secondDerivative}`),r.push(`  ${ie("B* Drag Term:",te.green,i)} ${e.bStar}`),r.push(`  ${ie("Ephemeris Type:",te.green,i)} ${e.ephemerisType}`),r.push(`  ${ie("Element Set Number:",te.green,i)} ${e.elementSetNumber}`),r.push(`  ${ie("Revolution Number:",te.green,i)} ${e.revolutionNumber}`),r.push("")),a&&"warnings"in e&&Array.isArray(e.warnings)&&e.warnings.length>0){r.push(ie("Warnings:",te.bright+te.yellow,i));for(const t of e.warnings){const e="object"==typeof t&&"message"in t?t.message:String(t);r.push(`  ${ie("âš ",te.yellow,i)} ${e}`)}r.push("")}return r.push(ie("â•".repeat(70),te.cyan,i)),r.join("\n")}function le(e,t={}){const{includeName:i=!0}=t,n=(e,t)=>e.padEnd(t," "),a=(e,t,i=" ")=>e.padStart(t,i);let r="1 ";r+=a(Q(e),5," "),r+=e.classification||"U",r+=" "+n(ee(e),8),r+=" "+a(e.epochYear||"",2,"0"),r+=a(e.epoch||"",12," "),r+=" "+a(e.firstDerivative||"",10," "),r+=" "+n(e.secondDerivative||"",8),r+=" "+n(e.bStar||"",8),r+=" "+(e.ephemerisType||"0"),r+=" "+a(e.elementSetNumber||"",4," ");let s=0;for(let e=0;e<r.length;e++){const t=r[e];t&&t>="0"&&t<="9"?s+=parseInt(t,10):"-"===t&&(s+=1)}r+=(s%10).toString();let o="2 ";o+=a(Q(e),5," "),o+=" "+a(e.inclination||"",8," "),o+=" "+a(e.rightAscension||"",8," "),o+=" "+a((e.eccentricity||"").replace(/^0\./,""),7,"0"),o+=" "+a(e.argumentOfPerigee||"",8," "),o+=" "+a(e.meanAnomaly||"",8," "),o+=" "+a(e.meanMotion||"",11," "),o+=a(e.revolutionNumber||"",5," ");let c=0;for(let e=0;e<o.length;e++){const t=o[e];t&&t>="0"&&t<="9"?c+=parseInt(t,10):"-"===t&&(c+=1)}o+=(c%10).toString();const l=[];return i&&e.satelliteName&&l.push(e.satelliteName),l.push(r),l.push(o),l.join("\n")}class he{constructor(e){this.config=e,this.queue=[],this.processing=!1,this.tokens=e.maxRequests,this.lastRefill=Date.now()}refillTokens(){const e=Date.now(),t=(e-this.lastRefill)/this.config.intervalMs*this.config.maxRequests;t>=1&&(this.tokens=Math.min(this.config.maxRequests,this.tokens+Math.floor(t)),this.lastRefill=e)}processQueue(){return f(this,void 0,void 0,function*(){if(!this.processing){for(this.processing=!0;this.queue.length>0;)if(this.refillTokens(),this.tokens>=1){const e=this.queue.shift();e&&(this.tokens-=1,e.resolve())}else{const e=this.config.intervalMs-(Date.now()-this.lastRefill);e>0&&(yield new Promise(t=>setTimeout(t,e)))}this.processing=!1}})}acquire(){return f(this,void 0,void 0,function*(){if(this.refillTokens(),this.tokens>=1)return this.tokens-=1,Promise.resolve();if(this.config.maxQueueSize&&this.queue.length>=this.config.maxQueueSize)throw new Error("Rate limiter queue is full");return new Promise((e,t)=>{this.queue.push({resolve:e,reject:t,timestamp:Date.now()}),this.processQueue()})})}execute(e){return f(this,void 0,void 0,function*(){return yield this.acquire(),e()})}getStatus(){return this.refillTokens(),{tokens:this.tokens,queueLength:this.queue.length,maxRequests:this.config.maxRequests,intervalMs:this.config.intervalMs}}clearQueue(){for(const e of this.queue)e.reject(new Error("Rate limiter queue cleared"));this.queue=[]}reset(){this.tokens=this.config.maxRequests,this.lastRefill=Date.now(),this.clearQueue()}}class ue{constructor(e={}){this.cache=new Map,this.accessOrder=[],this.persistTimer=null,this.maxSize=e.maxSize||100,this.defaultTTL=e.defaultTTL||36e5,this.persistent=e.persistent||!1,this.cacheDir=e.cacheDir||n.join(a.homedir(),".tle-parser","cache"),this.cacheFile=e.cacheFile||"tle-cache.json",this.persistent&&(this.loadFromDisk().catch(()=>{}),this.persistTimer=setInterval(()=>{this.saveToDisk().catch(()=>{})},3e5))}get(e){const t=this.cache.get(e);if(t){if(!(Date.now()-t.timestamp>t.ttl))return this.updateAccessOrder(e),t.value;this.delete(e)}}set(e,t,i){const n={value:t,timestamp:Date.now(),ttl:i||this.defaultTTL};if(this.cache.size>=this.maxSize&&!this.cache.has(e)){const e=this.accessOrder[0];e&&this.delete(e)}this.cache.set(e,n),this.updateAccessOrder(e)}has(e){return void 0!==this.get(e)}delete(e){return this.accessOrder=this.accessOrder.filter(t=>t!==e),this.cache.delete(e)}clear(){this.cache.clear(),this.accessOrder=[]}size(){return this.cleanExpired(),this.cache.size}cleanExpired(){const e=Date.now();let t=0;for(const[i,n]of this.cache.entries())e-n.timestamp>n.ttl&&(this.delete(i),t++);return t}keys(){return this.cleanExpired(),Array.from(this.cache.keys())}getStats(){const e=this.size(),t=this.accessOrder[0]||null,i=this.accessOrder[this.accessOrder.length-1]||null;return{size:e,maxSize:this.maxSize,hitRate:0,oldestEntry:t,newestEntry:i}}updateAccessOrder(e){this.accessOrder=this.accessOrder.filter(t=>t!==e),this.accessOrder.push(e)}saveToDisk(){return f(this,void 0,void 0,function*(){if(this.persistent)try{i.existsSync(this.cacheDir)||(yield t.mkdir(this.cacheDir,{recursive:!0}));const e={entries:Array.from(this.cache.entries()),accessOrder:this.accessOrder,timestamp:Date.now()},a=n.join(this.cacheDir,this.cacheFile);yield t.writeFile(a,JSON.stringify(e,null,2),"utf8")}catch(e){console.error("Failed to save cache to disk:",e)}})}loadFromDisk(){return f(this,void 0,void 0,function*(){if(this.persistent)try{const e=n.join(this.cacheDir,this.cacheFile);if(!i.existsSync(e))return;const a=yield t.readFile(e,"utf8"),r=JSON.parse(a);this.cache.clear();for(const[e,t]of r.entries)this.cache.set(e,t);this.accessOrder=r.accessOrder||[],this.cleanExpired()}catch(e){console.error("Failed to load cache from disk:",e)}})}destroy(){this.persistTimer&&(clearInterval(this.persistTimer),this.persistTimer=null),this.persistent&&this.saveToDisk().catch(()=>{}),this.clear()}}const me=new ue({maxSize:1e3,defaultTTL:36e5,persistent:!0,cacheFile:"tle-data.json"});function de(e,t={}){const i=Object.keys(t).sort().map(e=>`${e}=${t[e]}`).join("&");return i?`${e}:${i}`:e}function pe(e,t=2592e5){const i=parseInt(e.epochYear,10),n=parseFloat(e.epoch),a=new Date(i<57?2e3+i:1900+i,0,1);a.setDate(n);const r=Date.now()-a.getTime(),s=r<=t,o=Math.floor(r/864e5);return{isFresh:s,age:r,epochDate:a,message:s?`TLE is fresh (${o} days old)`:`TLE is stale (${o} days old)`}}const Ee={starlink:{name:"Starlink",description:"SpaceX Starlink satellite constellation",namePatterns:[/^STARLINK-/i,/^STARLINK /i],intlDesignatorPatterns:[/^\d{2}-(0[0-9]{2}|1[0-9]{2})[A-Z]{1,3}$/]},oneweb:{name:"OneWeb",description:"OneWeb satellite constellation",namePatterns:[/^ONEWEB-/i,/^ONEWEB /i]},gps:{name:"GPS",description:"Global Positioning System satellites",namePatterns:[/^GPS /i,/^NAVSTAR/i,/^USA-/i],catalogNumbers:[[20959,20959],[22014,22014],[22877,22877],[23833,23833],[24876,24876],[25933,25933],[26360,26360],[26407,26407],[26605,26605],[26690,26690],[28361,28361],[28474,28474],[28874,28874],[29486,29486],[29601,29601],[32260,32260],[32384,32384],[32711,32711],[35752,35752],[36585,36585],[37753,37753],[38833,38833],[39166,39166],[40105,40105],[40294,40294],[40534,40534],[40730,40730],[41019,41019],[41328,41328],[36500,36600],[4e4,41400]]},galileo:{name:"Galileo",description:"European GNSS constellation",namePatterns:[/^GALILEO/i,/^GSAT/i],catalogNumbers:[[37846,37846],[37847,37847],[38857,38857],[38858,38858],[40128,40128],[40129,40129],[40544,40544],[40545,40545],[40889,40889],[40890,40890],[41174,41174],[41175,41175],[41549,41549],[41550,41550],[41859,41859],[41860,41860],[41861,41861],[41862,41862],[43055,43055],[43056,43056],[43057,43057],[43058,43058],[43564,43564],[43565,43565],[43566,43566],[43567,43567]]},glonass:{name:"GLONASS",description:"Russian GNSS constellation",namePatterns:[/^COSMOS \d+$/i,/^GLONASS/i],catalogNumbers:[[28915,28915],[32275,32275],[32276,32276],[32393,32393],[32395,32395],[36111,36111],[36112,36112],[36113,36113],[36400,36400],[36401,36401],[36402,36402],[37139,37139],[37140,37140],[37141,37141],[37829,37829],[37869,37869],[37870,37870],[39155,39155],[39620,39620],[39621,39621],[39622,39622],[40001,40001],[40315,40315],[40315,40315],[41330,41330],[41554,41554],[41555,41555],[36400,36410],[37800,37900],[39100,39700],[4e4,41600]]},beidou:{name:"BeiDou",description:"Chinese GNSS constellation",namePatterns:[/^BEIDOU/i,/^BDS/i,/^COMPASS/i],catalogNumbers:[[36287,36287],[36828,36828],[37210,37210],[37384,37384],[37763,37763],[37948,37948],[38091,38091],[38250,38250],[38251,38251],[38775,38775],[40549,40549],[40748,40748],[40749,40749],[40938,40938],[41434,41434],[41586,41586],[43001,43001],[43002,43002],[43107,43107],[43108,43108],[43207,43207],[43208,43208],[43245,43245],[43246,43246],[36200,43300]]},iss:{name:"ISS",description:"International Space Station",catalogNumbers:[25544],namePatterns:[/^ISS/i]},amateur:{name:"Amateur Radio",description:"Amateur radio satellites",namePatterns:[/^AO-/i,/^SO-/i,/^FO-/i,/^FUNCUBE/i,/^LILACSAT/i,/^DIWATA/i,/^OSCAR/i,/^AMSAT/i,/^CUBESAT/i,/^RS-/i,/^ZARYA/i]},weather:{name:"Weather",description:"Weather and meteorological satellites",namePatterns:[/^NOAA /i,/^GOES /i,/^METEOSAT/i,/^METEOR/i,/^FENGYUN/i,/^FY-/i,/^HIMAWARI/i]},iridium:{name:"Iridium",description:"Iridium satellite constellation",namePatterns:[/^IRIDIUM/i],catalogNumbers:[[41917,41927],[41934,41944],[42803,42813],[42955,42965],[43070,43080],[43249,43259],[43478,43488],[43569,43579]]},planet:{name:"Planet Labs",description:"Planet Labs Earth imaging satellites",namePatterns:[/^DOVE/i,/^FLOCK/i,/^PLANET/i,/^SKYSAT/i]},spire:{name:"Spire",description:"Spire Global satellite constellation",namePatterns:[/^LEMUR/i,/^SPIRE/i]}};function ge(e){return Ee[e.toLowerCase()]}function fe(e,t){const i=ge(t);if(!i)return!1;if(i.catalogNumbers&&i.catalogNumbers.length>0){const t=parseInt(e.satelliteNumber1,10);if(!isNaN(t)&&i.catalogNumbers.some(e=>Array.isArray(e)?t>=e[0]&&t<=e[1]:t===e))return!0}return!!(i.namePatterns&&e.satelliteName&&i.namePatterns.some(t=>t.test(e.satelliteName)))||!!i.customFilter&&i.customFilter(e)}class Ne{constructor(e,t){this.manager=e,this.config=t,this.timer=null,this.isRunning=!1,this.lastUpdate=null,this.updateCount=0,this.errorCount=0,this.lastError=null,this.retryCount=0,t.autoStart&&this.start()}start(){this.isRunning||(this.isRunning=!0,this.scheduleNext())}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.isRunning=!1}scheduleNext(){this.isRunning&&(this.timer=setTimeout(()=>{this.executeUpdate()},this.config.intervalMs))}executeUpdate(){return f(this,void 0,void 0,function*(){try{const e=yield this.manager.fetch(this.config.source||null,this.config.fetchOptions||{});this.lastUpdate=new Date,this.updateCount++,this.retryCount=0,this.lastError=null,this.config.onUpdate&&this.config.onUpdate(e),this.scheduleNext()}catch(e){this.errorCount++,this.lastError=e,this.config.onError&&this.config.onError(this.lastError);const t=this.config.maxRetries||3;if(this.retryCount<t){this.retryCount++;const e=this.config.retryDelayMs||6e4;this.timer=setTimeout(()=>{this.executeUpdate()},e)}else this.retryCount=0,this.scheduleNext()}})}updateNow(){return f(this,void 0,void 0,function*(){return this.manager.fetch(this.config.source||null,this.config.fetchOptions||{})})}getStatus(){return{isRunning:this.isRunning,lastUpdate:this.lastUpdate,nextUpdate:this.timer?new Date(Date.now()+this.config.intervalMs):null,updateCount:this.updateCount,errorCount:this.errorCount,lastError:this.lastError}}updateConfig(e){Object.assign(this.config,e),this.isRunning&&(this.stop(),this.start())}resetStats(){this.updateCount=0,this.errorCount=0,this.lastError=null,this.retryCount=0}}var Re,Te=Math.PI,Ae=2*Te,Ie=Te/180,Oe=180/Te,Me=6378.135,Se=60/Math.sqrt(650942.9922085947),_e=Me*Se/60,ye=1/Se,ve=.001082616,Ce=-253881e-11/ve,Le=2/3,De=1440/(2*Te);function be(e,t,i,n,a,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return 367*e-Math.floor(7*(e+Math.floor((t+9)/12))*.25)+Math.floor(275*t/9)+i+1721013.5+((s/6e4+r/60+a)/60+n)/24}function xe(e,t,i,n,a,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(e instanceof Date){var o=e;return be(o.getUTCFullYear(),o.getUTCMonth()+1,o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds())}return be(e,t,i,n,a,r,s)}function we(e,t){var i,n,a,r,s,o,c,l,h,u,m,d,p,E,g,f,N,R,T=e.e3,A=e.ee2,I=e.peo,O=e.pgho,M=e.pho,S=e.pinco,_=e.plo,y=e.se2,v=e.se3,C=e.sgh2,L=e.sgh3,D=e.sgh4,b=e.sh2,x=e.sh3,w=e.si2,$=e.si3,F=e.sl2,P=e.sl3,U=e.sl4,V=e.t,G=e.xgh2,k=e.xgh3,z=e.xgh4,Y=e.xh2,H=e.xh3,j=e.xi2,W=e.xi3,B=e.xl2,q=e.xl3,K=e.xl4,J=e.zmol,Z=e.zmos,X=t.init,Q=t.opsmode,ee=t.ep,te=t.inclp,ie=t.nodep,ne=t.argpp,ae=t.mp;R=Z+119459e-10*V,"y"===X&&(R=Z),N=R+.0335*Math.sin(R);var re=y*(c=.5*(E=Math.sin(N))*E-.25)+v*(l=-.5*E*Math.cos(N)),se=w*c+$*l,oe=F*c+P*l+U*E,ce=C*c+L*l+D*E,le=b*c+x*l;return R=J+.00015835218*V,"y"===X&&(R=J),N=R+.1098*Math.sin(R),h=re+(A*(c=.5*(E=Math.sin(N))*E-.25)+T*(l=-.5*E*Math.cos(N))),d=se+(j*c+W*l),p=oe+(B*c+q*l+K*E),u=ce+(G*c+k*l+z*E),m=le+(Y*c+H*l),"n"===X&&(p-=_,u-=O,m-=M,te+=d-=S,ee+=h-=I,r=Math.sin(te),a=Math.cos(te),te>=.2?(ne+=u-=a*(m/=r),ie+=m,ae+=p):(i=r*(o=Math.sin(ie)),n=r*(s=Math.cos(ie)),i+=m*s+d*a*o,n+=-m*o+d*a*s,(ie%=Ae)<0&&"a"===Q&&(ie+=Ae),g=ae+ne+a*ie,g+=p+u-d*ie*r,f=ie,(ie=Math.atan2(i,n))<0&&"a"===Q&&(ie+=Ae),Math.abs(f-ie)>Te&&(ie<f?ie+=Ae:ie-=Ae),ne=g-(ae+=p)-a*ie)),{ep:ee,inclp:te,nodep:ie,argpp:ne,mp:ae}}function $e(e){var t=(e-2451545)/36525,i=-62e-7*t*t*t+.093104*t*t+3164400184.812866*t+67310.54841;return(i=i*Ie/240%Ae)<0&&(i+=Ae),i}function Fe(e,t,i,n,a,r,s){return e instanceof Date?$e(xe(e)):$e(e)}function Pe(e,t){var i,n,a,r,s,o,c,l,h,u,m,d,p,E,g,f,N,R,T,A,I,O,M,S,_,y;e.t=t,e.error=Re.None;var v=e.mo+e.mdot*e.t,C=e.argpo+e.argpdot*e.t,L=e.nodeo+e.nodedot*e.t;l=C,A=v;var D=e.t*e.t;if(O=L+e.nodecf*D,f=1-e.cc1*e.t,N=e.bstar*e.cc4*e.t,R=e.t2cof*D,1!==e.isimp){o=e.omgcof*e.t;var b=1+e.eta*Math.cos(v);A=v+(g=o+e.xmcof*(b*b*b-e.delmo)),l=C-g,d=(m=D*e.t)*e.t,f=f-e.d2*D-e.d3*m-e.d4*d,N+=e.bstar*e.cc5*(Math.sin(A)-e.sinmao),R=R+e.t3cof*m+d*(e.t4cof+e.t*e.t5cof)}I=e.no;var x=e.ecco;if(T=e.inclo,"d"===e.method){p=e.t;var w=function(e){var t,i,n,a,r,s,o,c,l=e.irez,h=e.d2201,u=e.d2211,m=e.d3210,d=e.d3222,p=e.d4410,E=e.d4422,g=e.d5220,f=e.d5232,N=e.d5421,R=e.d5433,T=e.del1,A=e.del2,I=e.del3,O=e.argpo,M=e.argpdot,S=e.t,_=e.xfact,y=e.xlamo,v=e.no,C=e.atime,L=e.em,D=e.argpm,b=e.inclm,x=e.xli,w=e.mm,$=e.xni,F=e.nodem,P=e.nm,U=.13130908,V=2.8843198,G=.37448087,k=5.7686396,z=.95240898,Y=1.8014998,H=1.050833,j=4.4108898,W=259200,B=0,q=0,K=(e.gsto+.0043752690880113*e.tc)%Ae;if(L+=e.dedt*S,b+=e.didt*S,D+=e.domdt*S,F+=e.dnodt*S,w+=e.dmdt*S,0!==l){(0===C||S*C<=0||Math.abs(S)<Math.abs(C))&&(C=0,$=v,x=y),t=S>0?720:-720;for(var J=381;381===J;)2!==l?(o=T*Math.sin(x-U)+A*Math.sin(2*(x-V))+I*Math.sin(3*(x-G)),r=$+_,s=T*Math.cos(x-U)+2*A*Math.cos(2*(x-V))+3*I*Math.cos(3*(x-G)),s*=r):(n=(c=O+M*C)+c,i=x+x,o=h*Math.sin(n+x-k)+u*Math.sin(x-k)+m*Math.sin(c+x-z)+d*Math.sin(-c+x-z)+p*Math.sin(n+i-Y)+E*Math.sin(i-Y)+g*Math.sin(c+x-H)+f*Math.sin(-c+x-H)+N*Math.sin(c+i-j)+R*Math.sin(-c+i-j),r=$+_,s=h*Math.cos(n+x-k)+u*Math.cos(x-k)+m*Math.cos(c+x-z)+d*Math.cos(-c+x-z)+g*Math.cos(c+x-H)+f*Math.cos(-c+x-H)+2*(p*Math.cos(n+i-Y)+E*Math.cos(i-Y)+N*Math.cos(c+i-j)+R*Math.cos(-c+i-j)),s*=r),Math.abs(S-C)>=720?J=381:(q=S-C,J=0),381===J&&(x+=r*t+o*W,$+=o*t+s*W,C+=t);P=$+o*q+s*q*q*.5,a=x+r*q+o*q*q*.5,1!==l?(w=a-2*F+2*K,B=P-v):(w=a-F-D+K,B=P-v),P=v+B}return{atime:C,em:L,argpm:D,inclm:b,xli:x,mm:w,xni:$,nodem:F,dndt:B,nm:P}}({irez:e.irez,d2201:e.d2201,d2211:e.d2211,d3210:e.d3210,d3222:e.d3222,d4410:e.d4410,d4422:e.d4422,d5220:e.d5220,d5232:e.d5232,d5421:e.d5421,d5433:e.d5433,dedt:e.dedt,del1:e.del1,del2:e.del2,del3:e.del3,didt:e.didt,dmdt:e.dmdt,dnodt:e.dnodt,domdt:e.domdt,argpo:e.argpo,argpdot:e.argpdot,t:e.t,tc:p,gsto:e.gsto,xfact:e.xfact,xlamo:e.xlamo,no:e.no,atime:e.atime,em:x,argpm:l,inclm:T,xli:e.xli,mm:A,xni:e.xni,nodem:O,nm:I});x=w.em,l=w.argpm,T=w.inclm,A=w.mm,O=w.nodem,I=w.nm}if(I<=0)return e.error=Re.MeanMotionBelowZero,null;var $=Math.pow(Se/I,Le)*f*f;if(I=Se/Math.pow($,1.5),(x-=N)>=1||x<-.001)return e.error=Re.MeanEccentricityOutOfRange,null;x<1e-6&&(x=1e-6),S=(A+=e.no*R)+l+O;var F={am:$,em:x,im:T,Om:O%=Ae,om:l%=Ae,mm:A=((S%=Ae)-l-O)%Ae,nm:I},P=x;if(M=T,h=l,y=O,_=A,r=Math.sin(T),a=Math.cos(T),"d"===e.method){var U=we(e,{inclo:e.inclo,init:"n",ep:P,inclp:M,nodep:y,argpp:h,mp:_,opsmode:e.operationmode});if(P=U.ep,y=U.nodep,h=U.argpp,_=U.mp,(M=U.inclp)<0&&(M=-M,y+=Te,h-=Te),P<0||P>1)return e.error=Re.PerturbedEccentricityOutOfRange,null}"d"===e.method&&(r=Math.sin(M),a=Math.cos(M),e.aycof=-.5*Ce*r,Math.abs(a+1)>15e-13?e.xlcof=-.25*Ce*r*(3+5*a)/(1+a):e.xlcof=-.25*Ce*r*(3+5*a)/15e-13);var V=P*Math.cos(h);g=1/($*(1-P*P));var G=P*Math.sin(h)+g*e.aycof,k=(_+h+y+g*e.xlcof*V-y)%Ae;c=k,E=9999.9;for(var z=1;Math.abs(E)>=1e-12&&z<=10;)n=Math.sin(c),E=(k-G*(i=Math.cos(c))+V*n-c)/(E=1-i*V-n*G),Math.abs(E)>=.95&&(E=E>0?.95:-.95),c+=E,z+=1;var Y=V*i+G*n,H=V*n-G*i,j=V*V+G*G,W=$*(1-j);if(W<0)return e.error=Re.SemiLatusRectumBelowZero,null;var B=$*(1-Y),q=Math.sqrt($)*H/B,K=Math.sqrt(W)/B,J=Math.sqrt(1-j),Z=$/B*(n-G-V*(g=H/(1+J))),X=$/B*(i-V+G*g);u=Math.atan2(Z,X);var Q=(X+X)*Z,ee=1-2*Z*Z,te=.5*ve*(g=1/W),ie=te*g;"d"===e.method&&(s=a*a,e.con41=3*s-1,e.x1mth2=1-s,e.x7thm1=7*s-1);var ne=B*(1-1.5*ie*J*e.con41)+.5*te*e.x1mth2*ee;if(ne<1)return e.error=Re.Decayed,null;u-=.25*ie*e.x7thm1*Q;var ae=y+1.5*ie*a*Q,re=M+1.5*ie*a*r*ee,se=q-I*te*e.x1mth2*Q/Se,oe=K+I*te*(e.x1mth2*ee+1.5*e.con41)/Se,ce=Math.sin(u),le=Math.cos(u),he=Math.sin(ae),ue=Math.cos(ae),me=Math.sin(re),de=Math.cos(re),pe=-he*de,Ee=ue*de,ge=pe*ce+ue*le,fe=Ee*ce+he*le,Ne=me*ce;return{position:{x:ne*ge*Me,y:ne*fe*Me,z:ne*Ne*Me},velocity:{x:(se*ge+oe*(pe*le-ue*ce))*_e,y:(se*fe+oe*(Ee*le-he*ce))*_e,z:(se*Ne+oe*(me*le))*_e},meanElements:F}}function Ue(e,t){var i=e.substring(2,7),n=parseInt(e.substring(18,20),10),a=parseFloat(e.substring(20,32)),r=parseFloat(e.substring(33,43)),s=parseFloat("".concat(e.substring(44,45),".").concat(e.substring(45,50),"E").concat(e.substring(50,52))),o=parseFloat("".concat(e.substring(53,54),".").concat(e.substring(54,59),"E").concat(e.substring(59,61))),c=parseFloat(t.substring(8,16))*Ie,l=parseFloat(t.substring(17,25))*Ie,h=parseFloat(".".concat(t.substring(26,33))),u=parseFloat(t.substring(34,42))*Ie,m=parseFloat(t.substring(43,51))*Ie,d=parseFloat(t.substring(52,63))/De,p=n<57?n+2e3:n+1900,E=function(e,t){for(var i=[31,e%4==0?29:28,31,30,31,30,31,31,30,31,30,31],n=Math.floor(t),a=1,r=0;n>r+i[a-1]&&a<12;)r+=i[a-1],a+=1;var s=a,o=n-r,c=24*(t-n),l=Math.floor(c);c=60*(c-l);var h=Math.floor(c);return{mon:s,day:o,hr:l,minute:h,sec:60*(c-h)}}(p,a),g={error:0,satnum:i,epochyr:n,epochdays:a,ndot:r,nddot:s,bstar:o,inclo:c,nodeo:l,ecco:h,argpo:u,mo:m,no:d,jdsatepoch:xe(p,E.mon,E.day,E.hr,E.minute,E.sec)};return function(e,t){var i,n,a,r,s,o,c,l,h,u,m,d,p,E,g,f,N,R,T,A,I,O,M,S,_,y,v,C,L,D,b,x,w,$,F,P,U,V,G,k,z,Y,H,j,W,B,q,K,J,Z,X,Q,ee=t.opsmode,te=t.epoch,ie=t.xbstar,ne=t.xecco,ae=t.xargpo,re=t.xinclo,se=t.xmo,oe=t.xno,ce=t.xnodeo,le=e;le.isimp=0,le.method="n",le.aycof=0,le.con41=0,le.cc1=0,le.cc4=0,le.cc5=0,le.d2=0,le.d3=0,le.d4=0,le.delmo=0,le.eta=0,le.argpdot=0,le.omgcof=0,le.sinmao=0,le.t=0,le.t2cof=0,le.t3cof=0,le.t4cof=0,le.t5cof=0,le.x1mth2=0,le.x7thm1=0,le.mdot=0,le.nodedot=0,le.xlcof=0,le.xmcof=0,le.nodecf=0,le.irez=0,le.d2201=0,le.d2211=0,le.d3210=0,le.d3222=0,le.d4410=0,le.d4422=0,le.d5220=0,le.d5232=0,le.d5421=0,le.d5433=0,le.dedt=0,le.del1=0,le.del2=0,le.del3=0,le.didt=0,le.dmdt=0,le.dnodt=0,le.domdt=0,le.e3=0,le.ee2=0,le.peo=0,le.pgho=0,le.pho=0,le.pinco=0,le.plo=0,le.se2=0,le.se3=0,le.sgh2=0,le.sgh3=0,le.sgh4=0,le.sh2=0,le.sh3=0,le.si2=0,le.si3=0,le.sl2=0,le.sl3=0,le.sl4=0,le.gsto=0,le.xfact=0,le.xgh2=0,le.xgh3=0,le.xgh4=0,le.xh2=0,le.xh3=0,le.xi2=0,le.xi3=0,le.xl2=0,le.xl3=0,le.xl4=0,le.xlamo=0,le.zmol=0,le.zmos=0,le.atime=0,le.xli=0,le.xni=0,le.bstar=ie,le.ecco=ne,le.argpo=ae,le.inclo=re,le.mo=se,le.no=oe,le.nodeo=ce,le.operationmode=ee;var he=78/Me+1;le.init="y",le.t=0;var ue=function(e){var t=e.ecco,i=e.epoch,n=e.inclo,a=e.opsmode,r=e.no,s=t*t,o=1-s,c=Math.sqrt(o),l=Math.cos(n),h=l*l,u=Math.pow(Se/r,Le),m=.75*ve*(3*h-1)/(c*o),d=m/(u*u),p=u*(1-d*d-d*(1/3+134*d*d/81));r/=1+(d=m/(p*p));var E,g=Math.pow(Se/r,Le),f=Math.sin(n),N=g*o,R=1-5*h,T=-R-h-h,A=1/g,I=N*N,O=g*(1-t);if("a"===a){var M=i-7305,S=Math.floor(M+1e-8),_=.017202791694070362;(E=(1.7321343856509375+_*S+(_+Ae)*(M-S)+M*M*5075514194322695e-30)%Ae)<0&&(E+=Ae)}else E=Fe(i+2433281.5);return{no:r,method:"n",ainv:A,ao:g,con41:T,con42:R,cosio:l,cosio2:h,eccsq:s,omeosq:o,posq:I,rp:O,rteosq:c,sinio:f,gsto:E}}({ecco:le.ecco,epoch:te,inclo:le.inclo,no:le.no,method:le.method,opsmode:le.operationmode}),me=ue.ao,de=ue.con42,pe=ue.cosio,Ee=ue.cosio2,ge=ue.eccsq,fe=ue.omeosq,Ne=ue.posq,Re=ue.rp,Ie=ue.rteosq,Oe=ue.sinio;if(le.no=ue.no,le.con41=ue.con41,le.gsto=ue.gsto,le.a=Math.pow(le.no*ye,-2/3),le.alta=le.a*(1+le.ecco)-1,le.altp=le.a*(1-le.ecco)-1,le.error=0,fe>=0||le.no>=0){if(le.isimp=0,Re<1.034492841559484&&(le.isimp=1),S=he,R=1.880279159015271e-9,(g=(Re-1)*Me)<156){S=g-78,g<98&&(S=20);var _e=(120-S)/Me;R=_e*_e*_e*_e,S=S/Me+1}f=1/Ne,Y=1/(me-S),le.eta=me*le.ecco*Y,d=le.eta*le.eta,m=le.ecco*le.eta,N=Math.abs(1-d),r=(c=(o=R*Math.pow(Y,4))/Math.pow(N,3.5))*le.no*(me*(1+1.5*d+m*(4+d))+.375*ve*Y/N*le.con41*(8+3*d*(8+d))),le.cc1=le.bstar*r,s=0,le.ecco>1e-4&&(s=-2*o*Y*Ce*le.no*Oe/le.ecco),le.x1mth2=1-Ee,le.cc4=2*le.no*c*me*fe*(le.eta*(2+.5*d)+le.ecco*(.5+2*d)-ve*Y/(me*N)*(-3*le.con41*(1-2*m+d*(1.5-.5*m))+.75*le.x1mth2*(2*d-m*(1+d))*Math.cos(2*le.argpo))),le.cc5=2*c*me*fe*(1+2.75*(d+m)+m*d),l=Ee*Ee,k=.5*(G=1.5*ve*f*le.no)*ve*f,z=7.762359375e-7*f*f*le.no,le.mdot=le.no+.5*G*Ie*le.con41+.0625*k*Ie*(13-78*Ee+137*l),le.argpdot=-.5*G*de+.0625*k*(7-114*Ee+395*l)+z*(3-36*Ee+49*l),j=-G*pe,le.nodedot=j+(.5*k*(4-19*Ee)+2*z*(3-7*Ee))*pe,H=le.argpdot+le.nodedot,le.omgcof=le.bstar*s*Math.cos(le.argpo),le.xmcof=0,le.ecco>1e-4&&(le.xmcof=-Le*o*le.bstar/m),le.nodecf=3.5*fe*j*le.cc1,le.t2cof=1.5*le.cc1,Math.abs(pe+1)>15e-13?le.xlcof=-.25*Ce*Oe*(3+5*pe)/(1+pe):le.xlcof=-.25*Ce*Oe*(3+5*pe)/15e-13,le.aycof=-.5*Ce*Oe;var De=1+le.eta*Math.cos(le.mo);if(le.delmo=De*De*De,le.sinmao=Math.sin(le.mo),le.x7thm1=7*Ee-1,2*Te/le.no>=225){le.method="d",le.isimp=1,p=le.inclo;var be=function(e){var t,i,n,a,r,s,o,c,l,h,u,m,d,p,E,g,f,N,R,T,A,I,O,M,S,_,y,v,C,L,D,b,x,w,$,F,P,U,V,G,k,z,Y,H,j,W,B,q,K,J,Z,X,Q,ee,te,ie,ne,ae,re,se,oe,ce,le,he=e.epoch,ue=e.argpp,me=e.tc,de=e.inclp,pe=e.nodep,Ee=.01675,ge=.0549,fe=e.np,Ne=e.ep,Re=Math.sin(pe),Te=Math.cos(pe),Ie=Math.sin(ue),Oe=Math.cos(ue),Me=Math.sin(de),Se=Math.cos(de),_e=Ne*Ne,ye=1-_e,ve=Math.sqrt(ye),Ce=he+18261.5+me/1440,Le=(4.523602-.00092422029*Ce)%Ae,De=Math.sin(Le),be=Math.cos(Le),xe=.91375164-.03568096*be,we=Math.sqrt(1-xe*xe),$e=.089683511*De/we,Fe=Math.sqrt(1-$e*$e),Pe=5.8351514+.001944368*Ce,Ue=.39785416*De/we,Ve=Fe*be+.91744867*$e*De;Ue=Math.atan2(Ue,Ve),Ue+=Pe-Le;var Ge=Math.cos(Ue),ke=Math.sin(Ue);T=.1945905,A=-.98088458,M=.91744867,S=.39785416,I=Te,O=Re,u=29864797e-13;for(var ze=1/fe,Ye=0;Ye<2;)te=-6*(t=T*I+A*M*O)*(r=-Me*(o=-T*O+A*M*I)+Se*(c=A*S))+_e*(-24*(m=t*Oe+(i=Se*o+Me*c)*Ie)*(N=r*Oe)-6*(p=-t*Ie+i*Oe)*(g=r*Ie)),ie=-6*(t*(s=-Me*(l=A*O+T*M*I)+Se*(h=T*S))+(n=-A*I+T*M*O)*r)+_e*(-24*((d=n*Oe+(a=Se*l+Me*h)*Ie)*N+m*(R=s*Oe))+-6*(p*(f=s*Ie)+(E=-n*Ie+a*Oe)*g)),ne=-6*n*s+_e*(-24*d*R-6*E*f),ae=6*i*r+_e*(24*m*g-6*p*N),re=6*(a*r+i*s)+_e*(24*(d*g+m*f)-6*(E*N+p*R)),se=6*a*s+_e*(24*d*f-6*E*R),X=(X=3*(t*t+i*i)+(oe=12*m*m-3*p*p)*_e)+X+ye*oe,Q=(Q=6*(t*n+i*a)+(ce=24*m*d-6*p*E)*_e)+Q+ye*ce,ee=(ee=3*(n*n+a*a)+(le=12*d*d-3*E*E)*_e)+ee+ye*le,W=-.5*(B=u*ze)/ve,j=-15*Ne*(q=B*ve),K=m*p+d*E,J=d*p+m*E,Z=d*E-m*p,1===(Ye+=1)&&(_=j,y=W,v=B,C=q,L=K,D=J,b=Z,x=X,w=Q,$=ee,F=te,P=ie,U=ne,V=ae,G=re,k=se,z=oe,Y=ce,H=le,T=Ge,A=ke,M=xe,S=we,I=Fe*Te+$e*Re,O=Re*Fe-Te*$e,u=4.7968065e-7);return{snodm:Re,cnodm:Te,sinim:Me,cosim:Se,sinomm:Ie,cosomm:Oe,day:Ce,e3:2*j*Z,ee2:2*j*J,em:Ne,emsq:_e,gam:Pe,peo:0,pgho:0,pho:0,pinco:0,plo:0,rtemsq:ve,se2:2*_*D,se3:2*_*b,sgh2:2*C*Y,sgh3:2*C*(H-z),sgh4:-18*C*Ee,sh2:-2*y*G,sh3:-2*y*(k-V),si2:2*y*P,si3:2*y*(U-F),sl2:-2*v*w,sl3:-2*v*($-x),sl4:-2*v*(-21-9*_e)*Ee,s1:j,s2:W,s3:B,s4:q,s5:K,s6:J,s7:Z,ss1:_,ss2:y,ss3:v,ss4:C,ss5:L,ss6:D,ss7:b,sz1:x,sz2:w,sz3:$,sz11:F,sz12:P,sz13:U,sz21:V,sz22:G,sz23:k,sz31:z,sz32:Y,sz33:H,xgh2:2*q*ce,xgh3:2*q*(le-oe),xgh4:-18*q*ge,xh2:-2*W*re,xh3:-2*W*(se-ae),xi2:2*W*ie,xi3:2*W*(ne-te),xl2:-2*B*Q,xl3:-2*B*(ee-X),xl4:-2*B*(-21-9*_e)*ge,nm:fe,z1:X,z2:Q,z3:ee,z11:te,z12:ie,z13:ne,z21:ae,z22:re,z23:se,z31:oe,z32:ce,z33:le,zmol:(.2299715*Ce-Pe+4.7199672)%Ae,zmos:(6.2565837+.017201977*Ce)%Ae}}({epoch:te,ep:le.ecco,argpp:le.argpo,tc:0,inclp:le.inclo,nodep:le.nodeo,np:le.no,e3:le.e3,ee2:le.ee2,peo:le.peo,pgho:le.pgho,pho:le.pho,pinco:le.pinco,plo:le.plo,se2:le.se2,se3:le.se3,sgh2:le.sgh2,sgh3:le.sgh3,sgh4:le.sgh4,sh2:le.sh2,sh3:le.sh3,si2:le.si2,si3:le.si3,sl2:le.sl2,sl3:le.sl3,sl4:le.sl4,xgh2:le.xgh2,xgh3:le.xgh3,xgh4:le.xgh4,xh2:le.xh2,xh3:le.xh3,xi2:le.xi2,xi3:le.xi3,xl2:le.xl2,xl3:le.xl3,xl4:le.xl4,zmol:le.zmol,zmos:le.zmos});le.e3=be.e3,le.ee2=be.ee2,le.peo=be.peo,le.pgho=be.pgho,le.pho=be.pho,le.pinco=be.pinco,le.plo=be.plo,le.se2=be.se2,le.se3=be.se3,le.sgh2=be.sgh2,le.sgh3=be.sgh3,le.sgh4=be.sgh4,le.sh2=be.sh2,le.sh3=be.sh3,le.si2=be.si2,le.si3=be.si3,le.sl2=be.sl2,le.sl3=be.sl3,le.sl4=be.sl4,n=be.sinim,i=be.cosim,h=be.em,u=be.emsq,T=be.s1,A=be.s2,I=be.s3,O=be.s4,M=be.s5,_=be.ss1,y=be.ss2,v=be.ss3,C=be.ss4,L=be.ss5,D=be.sz1,b=be.sz3,x=be.sz11,w=be.sz13,$=be.sz21,F=be.sz23,P=be.sz31,U=be.sz33,le.xgh2=be.xgh2,le.xgh3=be.xgh3,le.xgh4=be.xgh4,le.xh2=be.xh2,le.xh3=be.xh3,le.xi2=be.xi2,le.xi3=be.xi3,le.xl2=be.xl2,le.xl3=be.xl3,le.xl4=be.xl4,le.zmol=be.zmol,le.zmos=be.zmos,E=be.nm,W=be.z1,B=be.z3,q=be.z11,K=be.z13,J=be.z21,Z=be.z23,X=be.z31,Q=be.z33;var xe=we(le,{inclo:p,init:le.init,ep:le.ecco,inclp:le.inclo,nodep:le.nodeo,argpp:le.argpo,mp:le.mo,opsmode:le.operationmode});le.ecco=xe.ep,le.inclo=xe.inclp,le.nodeo=xe.nodep,le.argpo=xe.argpp,le.mo=xe.mp;var $e=function(e){var t,i,n,a,r,s,o,c,l,h,u,m,d,p,E,g,f,N,R,T,A=e.cosim,I=e.argpo,O=e.s2,M=e.sinim,S=e.ss2,_=e.t,y=e.mo,v=e.mdot,C=e.no,L=e.nodeo,D=e.nodedot,b=e.xpidot,x=e.ecco,w=e.eccsq,$=e.emsq,F=e.em,P=e.argpm,U=e.inclm,V=e.mm,G=e.nm,k=e.nodem,z=e.irez,Y=e.atime,H=e.d2201,j=e.d2211,W=e.d3210,B=e.d3222,q=e.d4410,K=e.d4422,J=e.d5220,Z=e.d5232,X=e.d5421,Q=e.d5433,ee=e.dnodt,te=e.domdt,ie=e.del1,ne=e.del2,ae=e.del3,re=e.xfact,se=e.xlamo,oe=e.xli,ce=e.xni,le=.0043752690880113,he=.00015835218,ue=119459e-10;z=0,G<.0052359877&&G>.0034906585&&(z=1),G>=.00826&&G<=.00924&&F>=.5&&(z=2);var me=-ue*S*(e.sz21+e.sz23);(U<.052359877||U>Te-.052359877)&&(me=0),0!==M&&(me/=M);var de=-he*O*(e.z21+e.z23);(U<.052359877||U>Te-.052359877)&&(de=0),te=e.ss4*ue*(e.sz31+e.sz33-6)-A*me+e.s4*he*(e.z31+e.z33-6),ee=me,0!==M&&(te-=A/M*de,ee+=de/M);var pe=(e.gsto+e.tc*le)%Ae;if(F+=(N=e.ss1*ue*e.ss5+e.s1*he*e.s5)*_,U+=(R=S*ue*(e.sz11+e.sz13)+O*he*(e.z11+e.z13))*_,P+=te*_,k+=ee*_,V+=(T=-ue*e.ss3*(e.sz1+e.sz3-14-6*$)-he*e.s3*(e.z1+e.z3-14-6*$))*_,0!==z){if(E=Math.pow(G/Se,Le),2===z){var Ee=F,ge=$;f=(F=x)*($=w),F<=.65?(n=3.616-13.247*F+16.29*$,a=117.39*F-19.302-228.419*$+156.591*f,r=109.7927*F-18.9068-214.6334*$+146.5816*f,s=242.694*F-41.122-471.094*$+313.953*f,o=841.88*F-146.407-1629.014*$+1083.435*f,c=3017.977*F-532.114-5740.032*$+3708.276*f):(n=331.819*F-72.099-508.738*$+266.724*f,a=1582.851*F-346.844-2415.925*$+1246.113*f,r=1554.908*F-342.585-2366.899*$+1215.972*f,s=4758.686*F-1052.797-7193.992*$+3651.957*f,o=16178.11*F-3581.69-24462.77*$+12422.52*f,c=F>.715?29936.92*F-5149.66-54087.36*$+31324.56*f:1464.74-4664.75*F+3763.64*$),F<.7?(u=4988.61*F-919.2277-9064.77*$+5542.21*f,l=4568.6173*F-822.71072-8491.4146*$+5337.524*f,h=4690.25*F-853.666-8624.77*$+5341.4*f):(u=161616.52*F-37995.78-229838.2*$+109377.94*f,l=218913.95*F-51752.104-309468.16*$+146349.42*f,h=170470.89*F-40023.88-242699.48*$+115605.82*f),H=(d=17891679e-13*(p=G*G*3*(E*E)))*(t=.75*(1+2*A+(g=A*A)))*(-.306-.44*(F-.64)),j=d*(1.5*(m=M*M))*n,W=(d=3.7393792e-7*(p*=E))*(1.875*M*(1-2*A-3*g))*a,B=d*(-1.875*M*(1+2*A-3*g))*r,q=(d=2*(p*=E)*7.3636953e-9)*(35*m*t)*s,K=d*(39.375*m*m)*o,J=(d=1.1428639e-7*(p*=E))*(9.84375*M*(m*(1-2*A-5*g)+.33333333*(4*A-2+6*g)))*c,Z=d*(M*(4.92187512*m*(-2-4*A+10*g)+6.56250012*(1+2*A-3*g)))*h,X=(d=2*p*2.1765803e-9)*(29.53125*M*(2-8*A+g*(8*A-12+10*g)))*l,Q=d*(29.53125*M*(-2-8*A+g*(12+8*A-10*g)))*u,se=(y+L+L-(pe+pe))%Ae,re=v+T+2*(D+ee-le)-C,F=Ee,$=ge}1===z&&(i=1+A,ne=2*(ie=3*G*G*E*E)*(t=.75*(1+A)*(1+A))*(1+$*(.8125*$-2.5))*17891679e-13,ae=3*ie*(i*=1.875*i*i)*(1+$*(6.60937*$-6))*2.2123015e-7*E,ie=ie*(.9375*M*M*(1+3*A)-.75*(1+A))*(a=1+2*$)*21460748e-13*E,se=(y+L+I-pe)%Ae,re=v+b+T+te+ee-(C+le)),oe=se,ce=C,Y=0,G=C+0}return{em:F,argpm:P,inclm:U,mm:V,nm:G,nodem:k,irez:z,atime:Y,d2201:H,d2211:j,d3210:W,d3222:B,d4410:q,d4422:K,d5220:J,d5232:Z,d5421:X,d5433:Q,dedt:N,didt:R,dmdt:T,dndt:0,dnodt:ee,domdt:te,del1:ie,del2:ne,del3:ae,xfact:re,xlamo:se,xli:oe,xni:ce}}({cosim:i,emsq:u,argpo:le.argpo,s1:T,s2:A,s3:I,s4:O,s5:M,sinim:n,ss1:_,ss2:y,ss3:v,ss4:C,ss5:L,sz1:D,sz3:b,sz11:x,sz13:w,sz21:$,sz23:F,sz31:P,sz33:U,t:le.t,tc:0,gsto:le.gsto,mo:le.mo,mdot:le.mdot,no:le.no,nodeo:le.nodeo,nodedot:le.nodedot,xpidot:H,z1:W,z3:B,z11:q,z13:K,z21:J,z23:Z,z31:X,z33:Q,ecco:le.ecco,eccsq:ge,em:h,argpm:0,inclm:p,mm:0,nm:E,nodem:0,irez:le.irez,atime:le.atime,d2201:le.d2201,d2211:le.d2211,d3210:le.d3210,d3222:le.d3222,d4410:le.d4410,d4422:le.d4422,d5220:le.d5220,d5232:le.d5232,d5421:le.d5421,d5433:le.d5433,dedt:le.dedt,didt:le.didt,dmdt:le.dmdt,dnodt:le.dnodt,domdt:le.domdt,del1:le.del1,del2:le.del2,del3:le.del3,xfact:le.xfact,xlamo:le.xlamo,xli:le.xli,xni:le.xni});le.irez=$e.irez,le.atime=$e.atime,le.d2201=$e.d2201,le.d2211=$e.d2211,le.d3210=$e.d3210,le.d3222=$e.d3222,le.d4410=$e.d4410,le.d4422=$e.d4422,le.d5220=$e.d5220,le.d5232=$e.d5232,le.d5421=$e.d5421,le.d5433=$e.d5433,le.dedt=$e.dedt,le.didt=$e.didt,le.dmdt=$e.dmdt,le.dnodt=$e.dnodt,le.domdt=$e.domdt,le.del1=$e.del1,le.del2=$e.del2,le.del3=$e.del3,le.xfact=$e.xfact,le.xlamo=$e.xlamo,le.xli=$e.xli,le.xni=$e.xni}1!==le.isimp&&(a=le.cc1*le.cc1,le.d2=4*me*Y*a,V=le.d2*Y*le.cc1/3,le.d3=(17*me+S)*V,le.d4=.5*V*me*Y*(221*me+31*S)*le.cc1,le.t3cof=le.d2+2*a,le.t4cof=.25*(3*le.d3+le.cc1*(12*le.d2+10*a)),le.t5cof=.2*(3*le.d4+12*le.cc1*le.d3+6*le.d2*le.d2+15*a*(2*le.d2+a)))}Pe(le,0),le.init="n"}(g,{opsmode:"i",satn:g.satnum,epoch:g.jdsatepoch-2433281.5,xbstar:g.bstar,xecco:g.ecco,xargpo:g.argpo,xinclo:g.inclo,xmo:g.mo,xno:g.no,xnodeo:g.nodeo}),g}!function(e){e[e.None=0]="None",e[e.MeanEccentricityOutOfRange=1]="MeanEccentricityOutOfRange",e[e.MeanMotionBelowZero=2]="MeanMotionBelowZero",e[e.PerturbedEccentricityOutOfRange=3]="PerturbedEccentricityOutOfRange",e[e.SemiLatusRectumBelowZero=4]="SemiLatusRectumBelowZero",e[e.Decayed=6]="Decayed"}(Re||(Re={}));var Ve,Ge,ke,ze=7292115e-11;function Ye(e,t,i){var n=t.x-e.x,a=t.y-e.y,r=t.z-e.z,s=Math.sqrt(Math.pow(n,2)+Math.pow(a,2)+Math.pow(r,2));return 1-(n*(i.x+ze*e.y)+a*(i.y-ze*e.x)+r*i.z)/s/299792.458}function He(e){return e*Oe}function je(e){return e*Ie}function We(e){if(e<-Te/2||e>Te/2)throw new RangeError("Latitude radians must be in range [-pi/2; pi/2].");return He(e)}function Be(e){if(e<-Te||e>Te)throw new RangeError("Longitude radians must be in range [-pi; pi].");return He(e)}function qe(e){var t=e.longitude,i=e.latitude,n=e.height,a=6378.137,r=(a-6356.7523142)/a,s=2*r-r*r,o=a/Math.sqrt(1-s*(Math.sin(i)*Math.sin(i)));return{x:(o+n)*Math.cos(i)*Math.cos(t),y:(o+n)*Math.cos(i)*Math.sin(t),z:(o*(1-s)+n)*Math.sin(i)}}function Ke(e,t){return{x:e.x*Math.cos(t)+e.y*Math.sin(t),y:e.x*-Math.sin(t)+e.y*Math.cos(t),z:e.z}}function Je(e){try{const t=["1",e.satelliteNumber1.padStart(5," "),e.classification," ",e.internationalDesignatorYear.padStart(2," "),e.internationalDesignatorLaunchNumber.padStart(3," "),e.internationalDesignatorPiece.padEnd(3," ")," ",e.epochYear.padStart(2," "),e.epoch.padStart(12," ")," ",e.firstDerivative.padStart(10," ")," ",e.secondDerivative.padStart(8," ")," ",e.bStar.padStart(8," ")," ",e.ephemerisType," ",e.elementSetNumber.padStart(4," "),e.checksum1],i=["2",e.satelliteNumber2.padStart(5," ")," ",e.inclination.padStart(8," ")," ",e.rightAscension.padStart(8," ")," ",e.eccentricity.padStart(7," ")," ",e.argumentOfPerigee.padStart(8," ")," ",e.meanAnomaly.padStart(8," ")," ",e.meanMotion.padStart(11," "),e.revolutionNumber.padStart(5," "),e.checksum2],n=Ue(t.join(""),i.join(""));return n.error?(console.error(`Satellite record initialization error: ${n.error}`),null):n}catch(e){return console.error("Failed to initialize satellite record:",e),null}}function Ze(e,t){const i=Je(e);if(!i)return null;const n=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Pe(e,1440*(xe.apply(void 0,i)-e.jdsatepoch))}(i,t);if(!n||!n.position||!n.velocity)return null;const a=n.position,r=n.velocity,s=function(e,t){for(var i=6378.137,n=Math.sqrt(e.x*e.x+e.y*e.y),a=(i-6356.7523142)/i,r=2*a-a*a,s=Math.atan2(e.y,e.x)-t;s<-Te;)s+=Ae;for(;s>Te;)s-=Ae;for(var o,c=0,l=Math.atan2(e.z,Math.sqrt(e.x*e.x+e.y*e.y));c++<20;)o=1/Math.sqrt(1-r*(Math.sin(l)*Math.sin(l))),l=Math.atan2(e.z+i*o*r*Math.sin(l),n);return{longitude:s,latitude:l,height:n/Math.cos(l)-i*o}}(a,Fe(t));return{timestamp:t,position:a,velocity:r,geographicLocation:{latitude:We(s.latitude),longitude:Be(s.longitude),altitude:s.height},altitude:s.height}}function Xe(e,t,i,n=60){if(!Je(e))return null;const a=[],r=t.getTime(),s=i.getTime();for(let t=r;t<=s;t+=1e3*n){const i=Ze(e,new Date(t));i&&a.push(i)}return a}function Qe(e,t,i){const n=Ze(e,i);if(!n)return null;const a=Fe(i),r=(s={latitude:je(t.latitude),longitude:je(t.longitude),height:t.altitude},o=Ke(n.position,a),p=function(e,t){var i=e.longitude,n=e.latitude,a=qe(e),r=t.x-a.x,s=t.y-a.y,o=t.z-a.z;return{topS:Math.sin(n)*Math.cos(i)*r+Math.sin(n)*Math.sin(i)*s-Math.cos(n)*o,topE:-Math.sin(i)*r+Math.cos(i)*s,topZ:Math.cos(n)*Math.cos(i)*r+Math.cos(n)*Math.sin(i)*s+Math.sin(n)*o}}(s,o),l=(c=p).topS,h=c.topE,u=c.topZ,m=Math.sqrt(l*l+h*h+u*u),d=Math.asin(u/m),{azimuth:Math.atan2(-h,l)+Te,elevation:d,rangeSat:m});var s,o,c,l,h,u,m,d,p;return{azimuth:r.azimuth*(180/Math.PI),elevation:r.elevation*(180/Math.PI),range:r.rangeSat}}function et(e){try{const t=parseFloat(e.meanMotion);return t<=0?null:1440/t}catch(e){return null}}function tt(e){try{const t=Je(e);if(!t)return null;const i=parseFloat(e.meanMotion),n=t.inclo,a=t.ecco,r=t.argpo,s=t.nodeo,o=t.mo,c=1440/i,l=398600.4418,h=60*c,u=Math.pow(l*Math.pow(h,2)/(4*Math.pow(Math.PI,2)),1/3),m=6378.137,d=u*(1-a)-m,p=u*(1+a)-m;let E="Unknown";return d<2e3?E="LEO":d>=2e3&&p<35786?E="MEO":Math.abs(p-35786)<100&&a<.01?E="GEO":p>=35786&&(E="HEO"),{periodMinutes:c,semiMajorAxis:u,perigeeAltitude:d,apogeeAltitude:p,meanMotionRevPerDay:i,inclinationDegrees:n*(180/Math.PI),eccentricity:a,argumentOfPerigee:r*(180/Math.PI),rightAscension:s*(180/Math.PI),meanAnomaly:o*(180/Math.PI),orbitType:E}}catch(e){return null}}function it(e){const t=parseInt(e.epochYear),i=t<57?2e3+t:1900+t,n=parseFloat(e.epoch),a=Math.floor(n),r=n-a,s=new Date(Date.UTC(i,0,a));return s.setUTCMilliseconds(864e5*r),s}function nt(e,t){const i=[],n=["epoch","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion","firstDerivative","bStar","revolutionNumber"];for(const a of n){const n=parseFloat(e[a]),r=parseFloat(t[a]);if(n!==r){const e=r-n,t=0!==n?e/n*100:0;i.push({field:a,oldValue:n,newValue:r,absoluteChange:e,percentChange:t})}}const a=ot(e.epochYear,e.epoch),r=(ot(t.epochYear,t.epoch).getTime()-a.getTime())/864e5,s=i.filter(e=>"meanMotion"===e.field&&Math.abs(e.absoluteChange||0)>.001||"inclination"===e.field&&Math.abs(e.absoluteChange||0)>.1||"eccentricity"===e.field&&Math.abs(e.absoluteChange||0)>1e-4||!!(e.percentChange&&Math.abs(e.percentChange)>1)),o=function(e,t,i){if(0===e.length)return"No changes detected between TLEs.";let n=`${e.length} field(s) changed over ${i.toFixed(2)} days. `;if(t.length>0){n+=`${t.length} significant change(s): `;n+=t.map(e=>e.field).join(", ")+"."}else n+="All changes are minor.";return n}(i,s,r);return{satelliteNumber:t.satelliteNumber1,satelliteName:t.satelliteName,timeDifference:r,differences:i,significantChanges:s,summary:o}}function at(e,t=new Date){const i=ot(e.epochYear,e.epoch),n=t.getTime()-i.getTime(),a=n/864e5;let r,s,o;return a<1?(r="fresh",s=!1,o="TLE is current and suitable for high-precision applications."):a<3?(r="recent",s=!1,o="TLE is recent and suitable for most applications."):a<7?(r="old",s=!0,o="TLE is getting old. Consider updating for better accuracy."):a<30?(r="very_old",s=!0,o="TLE is very old. Update recommended for accurate predictions."):(r="ancient",s=!0,o="TLE is ancient. Predictions may be highly inaccurate. Update required."),{ageInDays:a,ageInHours:n/36e5,isStale:s,staleness:r,recommendation:o}}function rt(e){if(e.length<2)return{isDecaying:!1,decayRate:0,estimatedLifetimeDays:null,severity:"none",details:"Insufficient data for decay analysis (need at least 2 TLEs)"};const t=[...e].sort((e,t)=>{const i=ot(e.epochYear,e.epoch),n=ot(t.epochYear,t.epoch);return i.getTime()-n.getTime()}),i=t[0],n=t[t.length-1],a=parseFloat(i.meanMotion),r=parseFloat(n.meanMotion),s=ot(i.epochYear,i.epoch),o=(r-a)/((ot(n.epochYear,n.epoch).getTime()-s.getTime())/864e5),c=o>1e-4;let l="none",h=null;c&&(o>.01?(l="critical",h=30):o>.001?(l="high",h=180):o>5e-4?(l="moderate",h=365):(l="low",h=1825));const u=c?`Orbital decay detected. Mean motion increasing at ${o.toExponential(2)} rev/dayÂ². Estimated lifetime: ${h} days.`:"No significant orbital decay detected.";return{isDecaying:c,decayRate:o,estimatedLifetimeDays:h,severity:l,details:u}}function st(t){const i=parseFloat(t.meanMotion),n=parseFloat(t.eccentricity),a=parseFloat(t.inclination),r=ct(i);return r>35e3&&r<36500&&a<15&&n<.05?e.OrbitType.GEO:n>.3?e.OrbitType.HEO:r<2e3?e.OrbitType.LEO:r>=2e3&&r<35786?e.OrbitType.MEO:r>36500?e.OrbitType.CISLUNAR:e.OrbitType.UNKNOWN}function ot(e,t){const i=parseInt(e),n=i>=57?1900+i:2e3+i,a=parseFloat(t),r=new Date(Date.UTC(n,0,1));return r.setUTCDate(a),r}function ct(e){const t=2*e*Math.PI/86400;return Math.pow(398600.4418/(t*t),1/3)-6371}function lt(e){const t=parseFloat(e.meanMotion),i=parseFloat(e.eccentricity),n=parseFloat(e.inclination),a=parseFloat(e.rightAscension),r=parseFloat(e.argumentOfPerigee),s=parseFloat(e.meanAnomaly),o=pt(e.epochYear,e.epoch),c=398600.4418,l=2*t*Math.PI/86400,h=Math.pow(c/(l*l),1/3),u=2*Math.PI*Math.sqrt(Math.pow(h,3)/c);return{semiMajorAxis:h,eccentricity:i,inclination:n,rightAscensionOfAscendingNode:a,argumentOfPerigee:r,meanAnomaly:s,trueAnomaly:180*function(e,t,i=1e-8){let n=e,a=1;for(;Math.abs(a)>i;)a=(n-t*Math.sin(n)-e)/(1-t*Math.cos(n)),n-=a;return 2*Math.atan2(Math.sqrt(1+t)*Math.sin(n/2),Math.sqrt(1-t)*Math.cos(n/2))}(s*Math.PI/180,i)/Math.PI,epoch:o,meanMotion:l,period:u}}function ht(e){const t=e.semiMajorAxis,i=e.eccentricity,n=e.inclination*Math.PI/180,a=e.rightAscensionOfAscendingNode*Math.PI/180,r=e.argumentOfPerigee*Math.PI/180,s=(e.trueAnomaly||0)*Math.PI/180,o=398600.4418,c=t*(1-i*i)/(1+i*Math.cos(s)),l=c*Math.cos(s),h=c*Math.sin(s),u=Math.sqrt(o*t*(1-i*i)),m=-o/u*Math.sin(s),d=o/u*(i+Math.cos(s)),p=Math.cos(a),E=Math.sin(a),g=Math.cos(n),f=Math.sin(n),N=Math.cos(r),R=Math.sin(r);return{position:{x:(p*N-E*R*g)*l+(-p*R-E*N*g)*h,y:(E*N+p*R*g)*l+(-E*R+p*N*g)*h,z:R*f*l+N*f*h},velocity:{vx:(p*N-E*R*g)*m+(-p*R-E*N*g)*d,vy:(E*N+p*R*g)*m+(-E*R+p*N*g)*d,vz:R*f*m+N*f*d}}}function ut(e){return`["${e.satelliteName||`SATELLITE ${e.satelliteNumber1}`}","${e.lineNumber1} ${e.satelliteNumber1}${e.classification}...","${e.lineNumber2} ${e.satelliteNumber2}..."]`}function mt(e){const t=lt(e),i=pt(e.epochYear,e.epoch);let n=`"${e.satelliteName||e.satelliteNumber1}" "Sol/Earth"\n{\n`;return n+='  Class "spacecraft"\n',n+='  Mesh "satellite.3ds"\n',n+="  Radius 0.01\n\n",n+="  EllipticalOrbit\n  {\n",n+=`    Epoch ${i.getTime()/1e3}\n`,n+=`    SemiMajorAxis ${t.semiMajorAxis}\n`,n+=`    Eccentricity ${t.eccentricity}\n`,n+=`    Inclination ${t.inclination}\n`,n+=`    AscendingNode ${t.rightAscensionOfAscendingNode}\n`,n+=`    ArgOfPericenter ${t.argumentOfPerigee}\n`,n+=`    MeanAnomaly ${t.meanAnomaly}\n`,n+="  }\n}\n",n}function dt(e){let t="";return e.satelliteName&&(t+=e.satelliteName+"\n"),t+=`1 ${e.satelliteNumber1}${e.classification} `,t+=`${e.internationalDesignatorYear}${e.internationalDesignatorLaunchNumber}${e.internationalDesignatorPiece} `,t+=`${e.epochYear}${e.epoch} `,t+=`${e.firstDerivative} `,t+=`${e.secondDerivative} `,t+=`${e.bStar} `,t+=`${e.ephemerisType} `,t+=`${e.elementSetNumber}`,t+=e.checksum1+"\n",t+=`2 ${e.satelliteNumber2} `,t+=`${e.inclination} `,t+=`${e.rightAscension} `,t+=`${e.eccentricity} `,t+=`${e.argumentOfPerigee} `,t+=`${e.meanAnomaly} `,t+=`${e.meanMotion}`,t+=`${e.revolutionNumber}`,t+=e.checksum2,t}function pt(e,t){const i=parseInt(e),n=i>=57?1900+i:2e3+i,a=parseFloat(t),r=new Date(Date.UTC(n,0,1));return r.setTime(r.getTime()+864e5*(a-1)),r}function Et(e,t){const i=e>=0?" ":"-",n=Math.abs(e),a=Math.floor(Math.log10(n));return`${i}${(n/Math.pow(10,a)).toFixed(t-4)}${a>=0?"+":""}${a}`}function gt(e){let t=0;for(const i of e)i>="0"&&i<="9"?t+=parseInt(i):"-"===i&&(t+=1);return(t%10).toString()}e.OrbitType=void 0,(Ve=e.OrbitType||(e.OrbitType={})).LEO="LEO",Ve.MEO="MEO",Ve.GEO="GEO",Ve.HEO="HEO",Ve.CISLUNAR="CISLUNAR",Ve.UNKNOWN="UNKNOWN",e.CoordinateFrame=void 0,(Ge=e.CoordinateFrame||(e.CoordinateFrame={})).TEME="TEME",Ge.J2000="J2000",Ge.ITRF="ITRF",Ge.GCRF="GCRF",Ge.EME2000="EME2000",e.PlanetariumFormat=void 0,(ke=e.PlanetariumFormat||(e.PlanetariumFormat={})).STELLARIUM="STELLARIUM",ke.CELESTIA="CELESTIA",ke.SPACENGINE="SPACENGINE",ke.UNIVERSESANDBOX="UNIVERSESANDBOX";const ft={lineNumber1:[0,1],satelliteNumber1:[2,7],classification:[7,8],internationalDesignatorYear:[9,11],internationalDesignatorLaunchNumber:[11,14],internationalDesignatorPiece:[14,17],epochYear:[18,20],epoch:[20,32],firstDerivative:[33,43],secondDerivative:[44,52],bStar:[53,61],ephemerisType:[62,63],elementSetNumber:[64,68],checksum1:[68,69],lineNumber2:[0,1],satelliteNumber2:[2,7],inclination:[8,16],rightAscension:[17,25],eccentricity:[26,33],argumentOfPerigee:[34,42],meanAnomaly:[43,51],meanMotion:[52,63],revolutionNumber:[63,68],checksum2:[68,69]};class Nt extends Error{constructor(e,t,i=[]){super(e),this.name="TLEValidationError",this.errors=t,this.warnings=i,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Rt extends Error{constructor(e,t,i={}){super(e),this.name="TLEFormatError",this.code=t,this.details=i,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}function Tt(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}function At(e){return Tt(e).split("\n").map(e=>e.replace(/\t/g," ").trim()).filter(e=>e.length>0)}function It(e){let t=0;for(let i=0;i<e.length-1;i++){const n=e[i];n&&n>="0"&&n<="9"?t+=parseInt(n,10):"-"===n&&(t+=1)}return t%10}function Ot(t){if(69!==t.length)return{isValid:!1,expected:null,actual:null,error:{code:e.ERROR_CODES.INVALID_LINE_LENGTH,message:"Line length must be 69 characters",field:"line_length",expected:69,actual:t.length,severity:"error"}};const i=It(t),n=parseInt(t[68]||"",10);if(isNaN(n))return{isValid:!1,expected:i,actual:null,error:{code:e.ERROR_CODES.INVALID_CHECKSUM_CHARACTER,message:"Checksum position must contain a digit",field:"checksum",position:68,value:t[68],severity:"error"}};const a=i===n;return{isValid:a,expected:i,actual:n,error:a?null:{code:e.ERROR_CODES.CHECKSUM_MISMATCH,message:`Checksum mismatch: expected ${i}, got ${n}`,field:"checksum",expected:i,actual:n,severity:"error"}}}function Mt(t,i){const n=[];if(69!==t.length)return n.push({code:e.ERROR_CODES.INVALID_LINE_LENGTH,message:`Line ${i} must be exactly 69 characters (got ${t.length})`,line:i,field:"line_length",expected:69,actual:t.length,severity:"error"}),{isValid:!1,errors:n};const a=t[0];a!==i.toString()&&n.push({code:e.ERROR_CODES.INVALID_LINE_NUMBER,message:`Line ${i} must start with '${i}' (got '${a}')`,line:i,field:"line_number",expected:i.toString(),actual:a,severity:"error"});const r=Ot(t);return!r.isValid&&r.error&&n.push(Object.assign(Object.assign({},r.error),{line:i,message:`Line ${i}: ${r.error.message}`})),{isValid:0===n.length,errors:n}}function St(t,i){const n=t.substring(2,7).trim(),a=i.substring(2,7).trim();return n!==a?{isValid:!1,error:{code:e.ERROR_CODES.SATELLITE_NUMBER_MISMATCH,message:`Satellite numbers must match (Line 1: ${n}, Line 2: ${a})`,field:"satellite_number",line1Value:n,line2Value:a,severity:"error"}}:/^\d+$/.test(n)?{isValid:!0,error:null}:{isValid:!1,error:{code:e.ERROR_CODES.INVALID_SATELLITE_NUMBER,message:`Satellite number must be numeric (got '${n}')`,field:"satellite_number",value:n,severity:"error"}}}function _t(t){const i=t[7],n=["U","C","S"];return n.includes(i||"")?{isValid:!0,error:null}:{isValid:!1,error:{code:e.ERROR_CODES.INVALID_CLASSIFICATION,message:`Classification must be U, C, or S (got '${i}')`,field:"classification",expected:n,actual:i,severity:"error"}}}function yt(t,i,n,a){const r=parseFloat(t);return isNaN(r)?{isValid:!1,error:{code:e.ERROR_CODES.INVALID_NUMBER_FORMAT,message:`${i} must be numeric (got '${t}')`,field:i,value:t,severity:"error"}}:r<n||r>a?{isValid:!1,error:{code:e.ERROR_CODES.VALUE_OUT_OF_RANGE,message:`${i} must be between ${n} and ${a} (got ${r})`,field:i,value:r,min:n,max:a,severity:"error"}}:{isValid:!0,error:null}}function vt(t){const i=[],n=t[7];return"C"!==n&&"S"!==n||i.push({code:e.ERROR_CODES.CLASSIFIED_DATA_WARNING,message:`Classification '${n}' is unusual in public TLE data (typically 'U' for unclassified)`,field:"classification",value:n,severity:"warning"}),i}function Ct(t){const i=[],n=parseInt(t.substring(18,20),10),a=parseFloat(t.substring(20,32));if(isNaN(n)||isNaN(a))return i;const r=n>=57?1900+n:2e3+n;r<2e3&&i.push({code:e.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING,message:`Epoch year ${r} is in the deprecated 1900s range (two-digit year: ${n})`,field:"epochYear",value:n,fullYear:r,severity:"warning"});const s=new Date(r,0,1);s.setDate(s.getDate()+a-1);const o=((new Date).getTime()-s.getTime())/864e5;return o>30&&i.push({code:e.ERROR_CODES.STALE_TLE_WARNING,message:`TLE epoch is ${Math.floor(o)} days old (epoch: ${s.toISOString().split("T")[0]}). TLE data may be stale.`,field:"epoch",daysSinceEpoch:Math.floor(o),epochDate:s.toISOString().split("T")[0],severity:"warning"}),i}function Lt(t){const i=[],n=parseFloat("0."+t.substring(26,33).trim());!isNaN(n)&&n>.25&&i.push({code:e.ERROR_CODES.HIGH_ECCENTRICITY_WARNING,message:`Eccentricity ${n.toFixed(7)} is unusually high. This indicates a highly elliptical orbit.`,field:"eccentricity",value:n,severity:"warning"});const a=parseFloat(t.substring(52,63).trim());!isNaN(a)&&a<1&&i.push({code:e.ERROR_CODES.LOW_MEAN_MOTION_WARNING,message:`Mean motion ${a.toFixed(8)} rev/day is unusually low. This indicates a very high orbit.`,field:"meanMotion",value:a,severity:"warning"});const r=parseInt(t.substring(63,68).trim(),10);return!isNaN(r)&&r>9e4&&i.push({code:e.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING,message:`Revolution number ${r} is approaching rollover limit (99999). Counter may reset soon.`,field:"revolutionNumber",value:r,severity:"warning"}),i}function Dt(t){const i=[],n=t.substring(53,61).trim();"00000-0"!==n&&"00000+0"!==n&&"00000 0"!==n||i.push({code:e.ERROR_CODES.NEAR_ZERO_DRAG_WARNING,message:"B* drag term is zero or near-zero, which is unusual for most satellites in LEO",field:"bStar",value:n,severity:"warning"});const a=parseFloat(t.substring(33,43).trim());!isNaN(a)&&a<0&&i.push({code:e.ERROR_CODES.NEGATIVE_DECAY_WARNING,message:`First derivative of mean motion is negative (${a}), indicating orbital decay`,field:"firstDerivative",value:a,severity:"warning"});const r=t.substring(62,63).trim();return"0"!==r&&""!==r&&i.push({code:e.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING,message:`Ephemeris type '${r}' is non-standard (expected '0' for SGP4/SDP4)`,field:"ephemerisType",value:r,severity:"warning"}),i}function bt(t,i={}){if("string"!=typeof t)throw new TypeError("TLE data must be a string");if("object"!=typeof i||null===i||Array.isArray(i))throw new TypeError("Options must be an object");if(0===t.length)throw new Rt("TLE string cannot be empty",e.ERROR_CODES.EMPTY_INPUT,{inputLength:0});const{strictChecksums:n=!0,validateRanges:a=!0,mode:r="strict"}=i;if("strict"!==r&&"permissive"!==r)throw new TypeError('Mode must be either "strict" or "permissive"');const s=[],o=[],c=Tt(t).trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0&&!e.startsWith("#"));if(c.length<2)return s.push({code:e.ERROR_CODES.INVALID_LINE_COUNT,message:"TLE must contain at least 2 lines",field:"line_count",expected:"2 or 3",actual:c.length,severity:"error"}),{isValid:!1,errors:s,warnings:o};if(c.length>3)return s.push({code:e.ERROR_CODES.INVALID_LINE_COUNT,message:`TLE must contain 2 or 3 lines (got ${c.length})`,field:"line_count",expected:"2 or 3",actual:c.length,severity:"error"}),{isValid:!1,errors:s,warnings:o};let l=0,h=1;if(3===c.length){l=1,h=2;const t=c[0];!t||"1"!==t[0]&&"2"!==t[0]||o.push({code:e.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING,message:'Line 0 starts with "1" or "2", might be incorrectly formatted',field:"satellite_name",value:t,severity:"warning"}),t&&t.length>24&&o.push({code:e.ERROR_CODES.SATELLITE_NAME_TOO_LONG,message:"Satellite name (Line 0) should be 24 characters or less",field:"satellite_name",expected:24,actual:t.length,severity:"warning"})}const u=c[l],m=c[h];if(!u||!m)return s.push({code:e.ERROR_CODES.INVALID_LINE_COUNT,message:"Missing required TLE lines",severity:"error"}),{isValid:!1,errors:s,warnings:o};const d=Mt(u,1);if(!d.isValid)if("permissive"===r){const t=d.errors.filter(t=>t.code!==e.ERROR_CODES.CHECKSUM_MISMATCH&&t.code!==e.ERROR_CODES.INVALID_CHECKSUM_CHARACTER),i=d.errors.filter(t=>t.code===e.ERROR_CODES.CHECKSUM_MISMATCH||t.code===e.ERROR_CODES.INVALID_CHECKSUM_CHARACTER);if(s.push(...t),o.push(...i.map(e=>Object.assign(Object.assign({},e),{severity:"warning"}))),t.length>0)return{isValid:!1,errors:s,warnings:o}}else if(s.push(...d.errors),n)return{isValid:!1,errors:s,warnings:o};const p=Mt(m,2);if(!p.isValid)if("permissive"===r){const t=p.errors.filter(t=>t.code!==e.ERROR_CODES.CHECKSUM_MISMATCH&&t.code!==e.ERROR_CODES.INVALID_CHECKSUM_CHARACTER),i=p.errors.filter(t=>t.code===e.ERROR_CODES.CHECKSUM_MISMATCH||t.code===e.ERROR_CODES.INVALID_CHECKSUM_CHARACTER);if(s.push(...t),o.push(...i.map(e=>Object.assign(Object.assign({},e),{severity:"warning"}))),t.length>0)return{isValid:!1,errors:s,warnings:o}}else if(s.push(...p.errors),n)return{isValid:!1,errors:s,warnings:o};const E=St(u,m);!E.isValid&&E.error&&("permissive"===r?o.push(Object.assign(Object.assign({},E.error),{severity:"warning"})):s.push(E.error));const g=_t(u);if(!g.isValid&&g.error&&("permissive"===r?o.push(Object.assign(Object.assign({},g.error),{severity:"warning"})):s.push(g.error)),a&&69===u.length&&69===m.length){const e=[{value:u.substring(2,7).trim(),name:"Satellite Number",min:1,max:99999},{value:u.substring(9,11).trim(),name:"International Designator Year",min:0,max:99,optional:!0},{value:u.substring(11,14).trim(),name:"International Designator Launch Number",min:1,max:999,optional:!0},{value:u.substring(62,63).trim(),name:"Ephemeris Type",min:0,max:9,optional:!0},{value:u.substring(64,68).trim(),name:"Element Set Number",min:0,max:9999,optional:!0},{value:u.substring(18,20).trim(),name:"Epoch Year",min:0,max:99},{value:u.substring(20,32).trim(),name:"Epoch Day",min:1,max:366.99999999},{value:m.substring(8,16).trim(),name:"Inclination",min:0,max:180},{value:m.substring(17,25).trim(),name:"Right Ascension",min:0,max:360},{value:"0."+m.substring(26,33).trim(),name:"Eccentricity",min:0,max:1},{value:m.substring(34,42).trim(),name:"Argument of Perigee",min:0,max:360},{value:m.substring(43,51).trim(),name:"Mean Anomaly",min:0,max:360},{value:m.substring(52,63).trim(),name:"Mean Motion",min:0,max:20,warningOnly:!0},{value:m.substring(63,68).trim(),name:"Revolution Number",min:0,max:99999,optional:!0}];for(const{value:t,name:i,min:n,max:a,optional:c,warningOnly:l}of e){if(c&&0===t.length)continue;const e=yt(t,i,n,a);!e.isValid&&e.error&&(l||"permissive"===r?o.push(Object.assign(Object.assign({},e.error),{severity:"warning"})):s.push(e.error))}}return 69===u.length&&(o.push(...vt(u)),o.push(...Ct(u)),o.push(...Dt(u))),69===m.length&&o.push(...Lt(m)),{isValid:0===s.length,errors:s,warnings:o}}function xt(t,i={}){if("string"!=typeof t)throw new TypeError("TLE data must be a string");if("object"!=typeof i||null===i||Array.isArray(i))throw new TypeError("Options must be an object");const{validate:n=!0,strictChecksums:a=!0,validateRanges:r=!0,includeWarnings:s=!0,includeComments:o=!0,mode:c="strict"}=i;let l=[];if(n){const e=bt(t,{strictChecksums:a,validateRanges:r,mode:c});if(!e.isValid){const t="TLE validation failed:\n"+e.errors.map(e=>"string"==typeof e?e:e.message).join("\n");throw new Nt(t,e.errors,e.warnings)}l=e.warnings}const h=Tt(t).trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0),u=h.filter(e=>e.startsWith("#")),m=h.filter(e=>!e.startsWith("#"));let d=0,p=1,E=null;3===m.length&&(E=m[0]||null,d=1,p=2);const g=m[d],f=m[p];if(!g||!f)throw new Rt("Missing required TLE lines",e.ERROR_CODES.INVALID_LINE_COUNT);const N={satelliteName:E},R=["lineNumber2","satelliteNumber2","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion","revolutionNumber","checksum2"];for(const[e,t]of Object.entries(ft)){const[i,n]=t,a=R.includes(e)?f:g;N[e]=a.substring(i,n).trim()}return s&&l.length>0&&(N.warnings=l),o&&u.length>0&&(N.comments=u),N}var wt={parseTLE:xt,validateTLE:bt,calculateChecksum:It,validateChecksum:Ot,validateLineStructure:Mt,validateSatelliteNumber:St,validateClassification:_t,validateNumericRange:yt,checkClassificationWarnings:vt,checkEpochWarnings:Ct,checkOrbitalParameterWarnings:Lt,checkDragAndEphemerisWarnings:Dt,normalizeLineEndings:Tt,parseTLELines:At,TLEValidationError:Nt,TLEFormatError:Rt,ERROR_CODES:e.ERROR_CODES};e.AMSATSource=class{constructor(e={}){this.baseUrl="https://www.amsat.org/tle/current/nasabare.txt",this.config=Object.assign({type:"amsat",baseUrl:e.baseUrl||this.baseUrl,enableCache:!1!==e.enableCache,cacheTTL:e.cacheTTL||36e5,timeout:e.timeout||3e4,rateLimit:e.rateLimit||{maxRequests:10,intervalMs:6e4}},e),this.rateLimiter=new he(this.config.rateLimit),this.cache=new ue({maxSize:10,defaultTTL:this.config.cacheTTL,persistent:!0,cacheFile:"amsat-cache.json"})}fetch(){return f(this,arguments,void 0,function*(e={}){const t="amsat:all",i=Date.now();if(this.config.enableCache&&!e.forceRefresh){const n=this.cache.get(t);if(n){const t=R(n,e.parseOptions||{});return{data:t,source:"amsat",timestamp:new Date,cached:!0,count:t.length,age:Date.now()-i}}}const n=yield this.rateLimiter.execute(()=>f(this,void 0,void 0,function*(){const e=new AbortController,t=setTimeout(()=>e.abort(),this.config.timeout);try{const t=yield fetch(this.config.baseUrl,{headers:this.config.headers,signal:e.signal});if(!t.ok)throw new Error(`AMSAT fetch failed: ${t.status} ${t.statusText}`);return yield t.text()}finally{clearTimeout(t)}}));this.config.enableCache&&this.cache.set(t,n,this.config.cacheTTL);const a=R(n,e.parseOptions||{});return{data:a,source:"amsat",timestamp:new Date,cached:!1,count:a.length,age:Date.now()-i}})}clearCache(){this.cache.clear()}getCacheStats(){return this.cache.getStats()}},e.CONSTELLATIONS=Ee,e.CelesTrakSource=class{constructor(e={}){this.baseUrl="https://celestrak.org/NORAD/elements/gp.php",this.config=Object.assign({type:"celestrak",baseUrl:e.baseUrl||this.baseUrl,enableCache:!1!==e.enableCache,cacheTTL:e.cacheTTL||36e5,timeout:e.timeout||3e4,rateLimit:e.rateLimit||{maxRequests:20,intervalMs:6e4}},e),this.rateLimiter=new he(this.config.rateLimit),this.cache=new ue({maxSize:100,defaultTTL:this.config.cacheTTL,persistent:!0,cacheFile:"celestrak-cache.json"})}fetch(){return f(this,arguments,void 0,function*(e={}){const t=this.generateCacheKey(e),i=Date.now();if(this.config.enableCache&&!e.forceRefresh){const n=this.cache.get(t);if(n){const t=R(n,e.parseOptions||{});return{data:t,source:"celestrak",timestamp:new Date,cached:!0,count:t.length,age:Date.now()-i}}}const n=this.buildUrl(e),a=yield this.rateLimiter.execute(()=>f(this,void 0,void 0,function*(){const e=new AbortController,t=setTimeout(()=>e.abort(),this.config.timeout);try{const t=yield fetch(n,{headers:this.config.headers,signal:e.signal});if(!t.ok)throw new Error(`CelesTrak fetch failed: ${t.status} ${t.statusText}`);return yield t.text()}finally{clearTimeout(t)}}));this.config.enableCache&&this.cache.set(t,a,this.config.cacheTTL);const r=R(a,e.parseOptions||{});return{data:r,source:"celestrak",timestamp:new Date,cached:!1,count:r.length,age:Date.now()-i}})}buildUrl(e){const t=new URLSearchParams;if(e.catalogNumber){const i=Array.isArray(e.catalogNumber)?e.catalogNumber:[e.catalogNumber];t.append("CATNR",i.join(",")),t.append("FORMAT","TLE")}else e.group?(t.append("GROUP",e.group),t.append("FORMAT","TLE")):e.namePattern?(t.append("NAME",e.namePattern),t.append("FORMAT","TLE")):e.intlDesignator?(t.append("INTDES",e.intlDesignator),t.append("FORMAT","TLE")):(t.append("GROUP","active"),t.append("FORMAT","TLE"));if(e.queryParams)for(const[i,n]of Object.entries(e.queryParams))t.append(i,n);return`${this.config.baseUrl}?${t.toString()}`}generateCacheKey(e){return de("celestrak",{catalog:e.catalogNumber,group:e.group,name:e.namePattern,intl:e.intlDesignator})}clearCache(){this.cache.clear()}getCacheStats(){return this.cache.getStats()}},e.Colors=te,e.CustomSource=class{constructor(e){if(!e.baseUrl)throw new Error("Custom source requires a base URL");this.config=Object.assign(Object.assign({},e),{type:"custom",enableCache:!1!==e.enableCache,cacheTTL:e.cacheTTL||36e5,timeout:e.timeout||3e4,rateLimit:e.rateLimit||{maxRequests:10,intervalMs:6e4}}),this.rateLimiter=new he(this.config.rateLimit),this.cache=new ue({maxSize:50,defaultTTL:this.config.cacheTTL,persistent:!0,cacheFile:"custom-cache.json"})}fetch(){return f(this,arguments,void 0,function*(e={}){var t;const i=(null===(t=e.queryParams)||void 0===t?void 0:t.url)||this.config.baseUrl,n=de("custom",{url:i}),a=Date.now();if(this.config.enableCache&&!e.forceRefresh){const t=this.cache.get(n);if(t){const i=R(t,e.parseOptions||{});return{data:i,source:"custom",timestamp:new Date,cached:!0,count:i.length,age:Date.now()-a}}}const r=yield this.rateLimiter.execute(()=>f(this,void 0,void 0,function*(){var e;const t=new AbortController,n=setTimeout(()=>t.abort(),this.config.timeout);try{const n=Object.assign({},this.config.headers);(null===(e=this.config.credentials)||void 0===e?void 0:e.apiKey)&&(n.Authorization=`Bearer ${this.config.credentials.apiKey}`);const a=yield fetch(i,{headers:n,signal:t.signal});if(!a.ok)throw new Error(`Custom source fetch failed: ${a.status} ${a.statusText}`);return yield a.text()}finally{clearTimeout(n)}}));this.config.enableCache&&this.cache.set(n,r,this.config.cacheTTL);const s=R(r,e.parseOptions||{});return{data:s,source:"custom",timestamp:new Date,cached:!1,count:s.length,age:Date.now()-a}})}clearCache(){this.cache.clear()}getCacheStats(){return this.cache.getStats()}},e.DEFAULT_VALIDATION_RULES=X,e.DESIGNATOR_CONSTRAINTS=w,e.DataSourceManager=class{constructor(){this.sources=new Map,this.primarySource=null,this.failoverOrder=[]}register(e,t,i={}){this.sources.set(e,t),i.primary&&(this.primarySource=e),!1!==i.failover&&this.failoverOrder.push(e)}fetch(e){return f(this,arguments,void 0,function*(e,t={}){const i=e||this.primarySource;if(!i)throw new Error("No data source specified and no primary source configured");const n=[i,...this.failoverOrder.filter(e=>e!==i)];let a=null;for(const e of n){const i=this.sources.get(e);if(i)try{return yield i.fetch(t)}catch(t){a=t,console.error(`Failed to fetch from ${e}:`,t)}}throw new Error(`All data sources failed. Last error: ${(null==a?void 0:a.message)||"Unknown error"}`)})}getSource(e){return this.sources.get(e)}listSources(){return Array.from(this.sources.keys())}clearAllCaches(){for(const e of this.sources.values())e.clearCache()}},e.EPOCH_CONSTRAINTS=x,e.IncrementalParser=C,e.MiddlewareParser=_,e.ORBITAL_PARAMETER_RANGES=D,e.QUALITY_SCORE_WEIGHTS=$,e.RateLimiter=he,e.RateLimiterManager=class{constructor(){this.limiters=new Map}register(e,t){this.limiters.set(e,new he(t))}get(e){return this.limiters.get(e)}acquire(e){return f(this,void 0,void 0,function*(){const t=this.limiters.get(e);if(!t)throw new Error(`No rate limiter registered for source: ${e}`);return t.acquire()})}execute(e,t){return f(this,void 0,void 0,function*(){const i=this.limiters.get(e);if(!i)throw new Error(`No rate limiter registered for source: ${e}`);return i.execute(t)})}getAllStatus(){const e=new Map;for(const[t,i]of this.limiters)e.set(t,i.getStatus());return e}resetAll(){for(const e of this.limiters.values())e.reset()}},e.SATELLITE_NUMBER_RANGES=b,e.SCHEDULE_INTERVALS={EVERY_15_MINUTES:9e5,EVERY_30_MINUTES:18e5,HOURLY:36e5,EVERY_2_HOURS:72e5,EVERY_6_HOURS:216e5,EVERY_12_HOURS:432e5,DAILY:864e5,WEEKLY:6048e5},e.SchedulerManager=class{constructor(){this.schedulers=new Map}create(e,t,i){const n=new Ne(t,i);return this.schedulers.set(e,n),n}get(e){return this.schedulers.get(e)}remove(e){const t=this.schedulers.get(e);return!!t&&(t.stop(),this.schedulers.delete(e))}startAll(){for(const e of this.schedulers.values())e.start()}stopAll(){for(const e of this.schedulers.values())e.stop()}getAllStatus(){const e=new Map;for(const[t,i]of this.schedulers)e.set(t,i.getStatus());return e}list(){return Array.from(this.schedulers.keys())}},e.SpaceTrackSource=class{constructor(e={}){var t,i;if(this.baseUrl="https://www.space-track.org",this.authUrl="https://www.space-track.org/ajaxauth/login",this.queryUrl="https://www.space-track.org/basicspacedata/query",this.sessionCookie=null,this.lastAuth=0,this.authTTL=72e5,!(null===(t=e.credentials)||void 0===t?void 0:t.username)||!(null===(i=e.credentials)||void 0===i?void 0:i.password))throw new Error("Space-Track.org requires username and password credentials");this.config=Object.assign({type:"spacetrack",baseUrl:e.baseUrl||this.baseUrl,credentials:e.credentials,enableCache:!1!==e.enableCache,cacheTTL:e.cacheTTL||18e5,timeout:e.timeout||6e4,rateLimit:e.rateLimit||{maxRequests:20,intervalMs:6e4}},e),this.rateLimiter=new he(this.config.rateLimit),this.cache=new ue({maxSize:100,defaultTTL:this.config.cacheTTL,persistent:!0,cacheFile:"spacetrack-cache.json"})}authenticate(){return f(this,void 0,void 0,function*(){if(this.sessionCookie&&Date.now()-this.lastAuth<this.authTTL)return;const e=new URLSearchParams;e.append("identity",this.config.credentials.username),e.append("password",this.config.credentials.password);const t=yield fetch(this.authUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e.toString()});if(!t.ok)throw new Error(`Space-Track authentication failed: ${t.status} ${t.statusText}`);const i=t.headers.get("set-cookie");if(i){const e=i.match(/chocolatechip=([^;]+)/);e&&e[1]&&(this.sessionCookie=e[1],this.lastAuth=Date.now())}if(!this.sessionCookie)throw new Error("Failed to obtain Space-Track session cookie")})}fetch(){return f(this,arguments,void 0,function*(e={}){const t=this.generateCacheKey(e),i=Date.now();if(this.config.enableCache&&!e.forceRefresh){const n=this.cache.get(t);if(n){const t=R(n,e.parseOptions||{});return{data:t,source:"spacetrack",timestamp:new Date,cached:!0,count:t.length,age:Date.now()-i}}}yield this.authenticate();const n=this.buildUrl(e),a=yield this.rateLimiter.execute(()=>f(this,void 0,void 0,function*(){const e=new AbortController,t=setTimeout(()=>e.abort(),this.config.timeout);try{const t=yield fetch(n,{headers:Object.assign({Cookie:`chocolatechip=${this.sessionCookie}`},this.config.headers),signal:e.signal});if(!t.ok){if(401===t.status){this.sessionCookie=null,yield this.authenticate();const t=yield fetch(n,{headers:Object.assign({Cookie:`chocolatechip=${this.sessionCookie}`},this.config.headers),signal:e.signal});if(!t.ok)throw new Error(`Space-Track fetch failed: ${t.status} ${t.statusText}`);return yield t.text()}throw new Error(`Space-Track fetch failed: ${t.status} ${t.statusText}`)}const i=yield t.text();try{const e=JSON.parse(i);return this.jsonToTLE(e)}catch(e){return i}}finally{clearTimeout(t)}}));this.config.enableCache&&this.cache.set(t,a,this.config.cacheTTL);const r=R(a,e.parseOptions||{});return{data:r,source:"spacetrack",timestamp:new Date,cached:!1,count:r.length,age:Date.now()-i}})}buildUrl(e){let t="/class/gp/";return e.catalogNumber&&(t+=`NORAD_CAT_ID/${(Array.isArray(e.catalogNumber)?e.catalogNumber:[e.catalogNumber]).join(",")}/`),e.intlDesignator&&(t+=`INTLDES/${e.intlDesignator}/`),t+="orderby/EPOCH%20desc/limit/1000/format/tle",`${this.queryUrl}${t}`}jsonToTLE(e){return Array.isArray(e)?e.map(e=>{const t=[];return e.OBJECT_NAME&&t.push(e.OBJECT_NAME),e.TLE_LINE1&&t.push(e.TLE_LINE1),e.TLE_LINE2&&t.push(e.TLE_LINE2),t.join("\n")}).join("\n"):""}generateCacheKey(e){return de("spacetrack",{catalog:e.catalogNumber,intl:e.intlDesignator})}clearCache(){this.cache.clear()}getCacheStats(){return this.cache.getStats()}logout(){this.sessionCookie=null,this.lastAuth=0}},e.TLECache=y,e.TLEFormatError=Rt,e.TLEParserStream=O,e.TLEScheduler=Ne,e.TLEStateMachineParser=E,e.TLEValidationError=Nt,e.TTLCache=ue,e.ValidationRuleManager=class{constructor(e=X){this.rules=new Map;for(const t of e)this.rules.set(t.name,t)}addRule(e){this.rules.set(e.name,e)}removeRule(e){return this.rules.delete(e)}enableRule(e){const t=this.rules.get(e);return!!t&&(t.enabled=!0,!0)}disableRule(e){const t=this.rules.get(e);return!!t&&(t.enabled=!1,!0)}getEnabledRules(){return Array.from(this.rules.values()).filter(e=>e.enabled)}getRule(e){return this.rules.get(e)}getAllRules(){return Array.from(this.rules.values())}},e.analyzeConstellation=function(e,t){const i={LEO:0,MEO:0,GEO:0,HEO:0,CISLUNAR:0,UNKNOWN:0};let n=0,a=0;const r=[];for(const t of e){i[st(t)]++;const e=parseFloat(t.inclination),s=parseFloat(t.meanMotion),o=parseFloat(t.rightAscension);n+=e,a+=ct(s),r.push(o)}const s=n/e.length,o=a/e.length,c=function(e){if(e.length<2)return 1;const t=[...e].sort((e,t)=>e-t),i=[];let n=[t[0]];for(let e=1;e<t.length;e++)t[e]-t[e-1]<5?n.push(t[e]):(i.push(n),n=[t[e]]);return i.push(n),i.length}(r),l=360/(e.length/c),h=r.length>1?Math.abs(r[1]-r[0]):0;let u;return u=s>80?"Global (polar)":s>50?"High latitude":"Equatorial to mid-latitude",{constellationName:t,totalSatellites:e.length,orbitTypes:i,averageInclination:s,averageAltitude:o,orbitalPlanes:c,spacing:{alongTrack:l,crossTrack:h},coverage:u}},e.analyzeOrbitalDecay=rt,e.analyzeTrend=function(e,t){var i;if(e.length<3)return{satelliteNumber:(null===(i=e[0])||void 0===i?void 0:i.satelliteNumber1)||"unknown",parameter:t,trend:"stable",trendStrength:0,changeRate:0,predictions:{next7Days:0,next30Days:0}};const n=[...e].sort((e,t)=>{const i=ot(e.epochYear,e.epoch),n=ot(t.epochYear,t.epoch);return i.getTime()-n.getTime()}),a=[],r=[];for(const e of n){const i=e[t];if(i){const t=parseFloat(i);if(!isNaN(t)){a.push(t);const i=ot(e.epochYear,e.epoch);r.push(i.getTime())}}}const s=a.length,o=r.reduce((e,t)=>e+t,0),c=a.reduce((e,t)=>e+t,0),l=(s*r.reduce((e,t,i)=>e+t*a[i],0)-o*c)/(s*r.reduce((e,t)=>e+t*t,0)-o*o),h=(c-l*o)/s;let u;const m=.01*Math.abs(a[a.length-1]-a[0]);u=Math.abs(l)<m/(r[r.length-1]-r[0])?"stable":l>0?"increasing":"decreasing";const d=c/s,p=a.reduce((e,t)=>e+Math.pow(t-d,2),0),E=1-a.reduce((e,t,i)=>{const n=l*r[i]+h;return e+Math.pow(t-n,2)},0)/p,g=864e5*l,f=r[r.length-1],N=l*(f+6048e5)+h,R=l*(f+2592e6)+h;return{satelliteNumber:n[0].satelliteNumber1,parameter:t,trend:u,trendStrength:Math.max(0,Math.min(1,E)),changeRate:g,predictions:{next7Days:N,next30Days:R}}},e.applyFilter=I,e.assessTLEStaleness=at,e.calculateChecksum=It,e.calculateConjunctionProbability=function(e,t,i=24){const n=ct(parseFloat(e.meanMotion)),a=ct(parseFloat(t.meanMotion)),r=parseFloat(e.inclination),s=parseFloat(t.inclination),o=Math.abs(n-a),c=Math.abs(r-s);if(o>100||c>10)return{satellite1:e.satelliteNumber1,satellite2:t.satelliteNumber1,probabilityOfCollision:0,minimumDistance:o,timeOfClosestApproach:new Date,riskLevel:"low",recommendations:["Orbits are sufficiently separated"]};let l=0,h="low";const u=[];return o<10&&c<2&&(l=.001,h="moderate",u.push("Monitor conjunction","Consider detailed analysis")),o<5&&c<1&&(l=.01,h="high",u.push("Perform detailed conjunction analysis","Prepare collision avoidance maneuver")),o<2&&c<.5&&(l=.1,h="critical",u.push("URGENT: Immediate collision avoidance required","Contact satellite operators")),{satellite1:e.satelliteNumber1,satellite2:t.satelliteNumber1,probabilityOfCollision:l,minimumDistance:o,timeOfClosestApproach:new Date(Date.now()+Math.random()*i*60*60*1e3),riskLevel:h,recommendations:u}},e.calculateDopplerShift=function(e,t,i,n){const a=Ze(e,i);if(!a)return null;const r=Fe(i),s={latitude:je(t.latitude),longitude:je(t.longitude),height:t.altitude},o=Ke(a.position,r),c=Ke(a.velocity,r),l=qe(s),h=Ye(l,o,c),u={x:o.x-l.x,y:o.y-l.y,z:o.z-l.z},m=Math.sqrt(Math.pow(u.x,2)+Math.pow(u.y,2)+Math.pow(u.z,2)),d=(u.x*c.x+u.y*c.y+u.z*c.z)/m,p=new Date(i.getTime()+1e3),E=Ze(e,p);let g=0;return E&&(g=(n*(Ye(l,Ke(E.position,Fe(p)),Ke(E.velocity,Fe(p)))-1)-n*(h-1))/1),{factor:h,shiftHz:n*(h-1),rateHzPerSecond:g,rangeRate:d}},e.calculateEclipses=function(e,t,i){const n=[];let a=!1,r=null,s=0;const o=t.getTime(),c=i.getTime();for(let t=o;t<=c;t+=1e4){const i=new Date(t),o=Ze(e,i);if(!o)continue;const c=(xe(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds())-2451545)/36525,l=(357.528+35999.05*c)%360,h=(280.46+36000.771*c)%360+1.915*Math.sin(l*Math.PI/180),u=149597870.7,m={x:u*Math.cos(h*Math.PI/180),y:u*Math.sin(h*Math.PI/180),z:0},d={x:m.x-o.position.x,y:m.y-o.position.y,z:m.z-o.position.z},p=Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2)+Math.pow(d.z,2)),E=Math.sqrt(Math.pow(o.position.x,2)+Math.pow(o.position.y,2)+Math.pow(o.position.z,2)),g=-(o.position.x*d.x+o.position.y*d.y+o.position.z*d.z);let f=0;if(g>0&&E<7378.137){const e=Math.sqrt(Math.pow(E,2)-Math.pow(g/p,2)),t=6378.137*(1+g/u);f=Math.max(0,Math.min(1,1-e/t))}if(f>.1)a?s=Math.max(s,f):(a=!0,r=i,s=f);else if(a){const e=new Date(t-1e4);r&&n.push({start:r,end:e,duration:(e.getTime()-r.getTime())/1e3,type:s>.9?"umbra":"penumbra",depth:s}),a=!1,r=null,s=0}}return n},e.calculateEpochAge=U,e.calculateGroundTrack=function(e,t,i,n=60){const a=[],r=t.getTime(),s=i.getTime();for(let t=r;t<=s;t+=1e3*n){const i=new Date(t),n=Ze(e,i);if(n){const e=Math.sqrt(Math.pow(n.velocity.x,2)+Math.pow(n.velocity.y,2)+Math.pow(n.velocity.z,2));a.push({timestamp:i,location:n.geographicLocation,velocity:e})}}return a},e.calculateLookAngles=Qe,e.calculateOrbitalParameters=tt,e.calculateOrbitalPeriod=et,e.calculateQualityMetrics=function(e,t=new Date){const i=[];let n=100;const a=["satelliteNumber1","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion","epoch"];for(const t of a)e[t]&&""!==e[t]||(n-=100/a.length,i.push(`Missing or empty field: ${t}`));let r=100;const s=parseFloat(e.inclination),o=parseFloat(e.eccentricity),c=parseFloat(e.meanMotion);(s<0||s>180)&&(r-=20,i.push(`Invalid inclination: ${s}`)),(o<0||o>=1)&&(r-=20,i.push(`Invalid eccentricity: ${o}`)),(c<=0||c>20)&&(r-=20,i.push(`Unusual mean motion: ${c}`));let l=100;switch(at(e,t).staleness){case"fresh":l=100;break;case"recent":l=85;break;case"old":l=60;break;case"very_old":l=30;break;case"ancient":l=0}let h=100;e.warnings&&e.warnings.length>0&&(h-=Math.min(10*e.warnings.length,40),i.push(`${e.warnings.length} warning(s) detected`));const u=.3*n+.3*r+.25*l+.15*h;let m;return m=u>=90?"A":u>=80?"B":u>=70?"C":u>=60?"D":"F",{overallScore:Math.round(u),completeness:Math.round(n),accuracy:Math.round(r),freshness:Math.round(l),consistency:Math.round(h),issues:i,grade:m}},e.calculateQualityScore=K,e.calculateUpdateFrequency=function(e){var t;if(e.length<2)return{satelliteNumber:(null===(t=e[0])||void 0===t?void 0:t.satelliteNumber1)||"unknown",totalUpdates:e.length,timeSpanDays:0,averageUpdateInterval:0,minUpdateInterval:0,maxUpdateInterval:0,stdDeviation:0,updatePattern:"sparse"};const i=[...e].sort((e,t)=>{const i=ot(e.epochYear,e.epoch),n=ot(t.epochYear,t.epoch);return i.getTime()-n.getTime()}),n=[];for(let e=1;e<i.length;e++){const t=ot(i[e-1].epochYear,i[e-1].epoch),a=(ot(i[e].epochYear,i[e].epoch).getTime()-t.getTime())/864e5;n.push(a)}const a=n.reduce((e,t)=>e+t,0)/n.length,r=Math.min(...n),s=Math.max(...n),o=n.reduce((e,t)=>e+Math.pow(t-a,2),0)/n.length,c=Math.sqrt(o);let l;l=a<1?"frequent":c/a<.3?"regular":a>7?"sparse":"irregular";const h=ot(i[0].epochYear,i[0].epoch),u=(ot(i[i.length-1].epochYear,i[i.length-1].epoch).getTime()-h.getTime())/864e5;return{satelliteNumber:i[0].satelliteNumber1,totalUpdates:e.length,timeSpanDays:u,averageUpdateInterval:a,minUpdateInterval:r,maxUpdateInterval:s,stdDeviation:c,updatePattern:l}},e.calculateVisibilityWindows=function(e,t,i,n,a=0){const r=[];let s=!1,o=null,c=-90,l=null,h=null,u=null;const m=i.getTime(),d=n.getTime();for(let i=m;i<=d;i+=1e4){const n=new Date(i),m=Qe(e,t,n);if(m)if(m.elevation>=a)s?m.elevation>c&&(c=m.elevation,l=n,u=m):(s=!0,o=n,c=m.elevation,l=n,h=m,u=m);else if(s){const n=new Date(i-1e4),a=Qe(e,t,n);o&&l&&h&&u&&a&&r.push({aos:o,tca:l,los:n,maxElevation:c,duration:(n.getTime()-o.getTime())/1e3,angles:{aos:h,tca:u,los:a}}),s=!1,o=null,c=-90,l=null}}return r},e.checkClassificationWarnings=vt,e.checkDragAndEphemerisWarnings=Dt,e.checkEpochWarnings=Ct,e.checkOrbitalParameterWarnings=Lt,e.classifyOrbitType=st,e.compareTLEs=nt,e.convertEpochToDate=F,e.createCachedParser=function(e={}){const t=new y(e);return{parse:(e,i={})=>{const n=t.get(e,i);if(n)return n;const a=xt(e,i);return t.set(e,a,i),a},parseAsync:(e,...i)=>f(this,[e,...i],void 0,function*(e,i={}){const n=t.get(e,i);if(n)return n;const a=yield A(e,i);return t.set(e,a,i),a}),cache:t}},e.createConstellationFilter=function(e){const t=ge(e);if(!t)return;const i={};if(t.catalogNumbers&&t.catalogNumbers.length>0&&(i.satelliteNumber=e=>{const i=parseInt(e,10);return!isNaN(i)&&t.catalogNumbers.some(e=>Array.isArray(e)?i>=e[0]&&i<=e[1]:i===e)}),t.namePatterns&&t.namePatterns.length>0){const e=i.satelliteName;i.satelliteName=i=>{const n=t.namePatterns.some(e=>e.test(i));return e&&"function"==typeof e?n&&e(i):n}}if(t.customFilter){const e=i.custom;i.custom=i=>{const n=t.customFilter(i);return e?n&&e(i):n}}return i},e.createCustomFormat=function(e,t,i={}){return{name:e,version:"1.0",fields:t,separator:i.separator,lineEnding:i.lineEnding,header:i.header,footer:i.footer}},e.createIncrementalParser=function(e,t={}){return new C(e,t)},e.createMiddlewareParser=function(){return new _},e.createTLEParserStream=M,e.createValidationRule=function(e,t,i,n={}){return{name:e,description:t,severity:n.severity||"warning",enabled:!1!==n.enabled,validate:i,errorMessage:n.errorMessage}},e.default=wt,e.detectAnomalies=q,e.detectStationKeepingManeuver=function(e,t){try{const i=tt(e),n=tt(t);if(!i||!n)return{detected:!1};const a=Math.abs(n.semiMajorAxis-i.semiMajorAxis),r=Math.abs(n.eccentricity-i.eccentricity),s=Math.abs(n.inclinationDegrees-i.inclinationDegrees);if(!(a>.1||r>1e-4||s>.01))return{detected:!1};const o=398600.4418,c=Math.sqrt(o/i.semiMajorAxis),l=Math.sqrt(o/n.semiMajorAxis),h=1e3*Math.abs(l-c),u=it(e),m=it(t);return{detected:!0,deltaV:h,maneuverTime:new Date((u.getTime()+m.getTime())/2),elementChanges:{semiMajorAxis:a,eccentricity:r,inclination:s}}}catch(e){return{detected:!1}}},e.detectTLEAnomalies=function(e,t){var i,n;if(!t)return{hasAnomaly:!1,anomalyType:"none",confidence:0,description:"No previous TLE available for comparison",affectedFields:[],recommendations:[]};const a=nt(t,e),r=[];let s=!1,o="none",c=0,l="";const h=[],u=a.differences.find(e=>"meanMotion"===e.field),m=a.differences.find(e=>"inclination"===e.field);u&&Math.abs(u.absoluteChange||0)>.01&&(s=!0,o="maneuver",r.push("meanMotion"),c=Math.min(10*Math.abs(u.absoluteChange||0),1),l=`Possible orbital maneuver detected. Mean motion changed by ${null===(i=u.absoluteChange)||void 0===i?void 0:i.toFixed(6)} rev/day.`,h.push("Verify with satellite operator","Update orbital predictions")),m&&Math.abs(m.absoluteChange||0)>.5&&(s=!0,o="maneuver",r.push("inclination"),c=Math.max(c,.9),l+=` Significant inclination change: ${null===(n=m.absoluteChange)||void 0===n?void 0:n.toFixed(3)}Â°.`,h.push("Inclination change suggests plane change maneuver"));const d=rt([t,e]);"critical"!==d.severity&&"high"!==d.severity||(s=!0,o="decay_anomaly",r.push("meanMotion","bStar"),c=Math.max(c,.8),l=`Rapid orbital decay detected: ${d.details}`,h.push("Monitor for reentry","Validate TLE against radar observations"));const p=a.differences.find(e=>"eccentricity"===e.field);return p&&Math.abs(p.absoluteChange||0)>.1&&(s=!0,o="data_error",r.push("eccentricity"),c=.95,l="Unrealistic eccentricity change detected. Possible data error.",h.push("Verify TLE source","Check for data corruption")),s||(l="No significant anomalies detected."),{hasAnomaly:s,anomalyType:o,confidence:c,description:l,affectedFields:r,recommendations:h}},e.extractKeplerianElements=lt,e.filterByConstellation=function(e,t){return e.filter(e=>fe(e,t))},e.filterByFreshness=function(e,t=2592e5){return e.filter(e=>pe(e,t).isFresh)},e.formatAsCSV=ae,e.formatAsHuman=ce,e.formatAsJSON=ne,e.formatAsXML=se,e.formatAsYAML=oe,e.formatTLE=function(e,t={}){const{format:i="json"}=t;switch(i){case"json":return ne(e,t);case"csv":return ae(e,t);case"xml":return se(e,t);case"yaml":return oe(e,t);case"human":return Array.isArray(e)?e.map(e=>ce(e,t)).join("\n\n"):ce(e,t);case"tle":return Array.isArray(e)?e.map(e=>le(e,{includeName:!0})).join("\n\n"):le(e,{includeName:!0});default:throw new Error(`Unsupported output format: ${i}`)}},e.generateCacheKey=de,e.generateOrbitVisualization=function(e,t=100){const i=et(e);if(!i)return null;const n=new Date,a=new Date(n.getTime()+60*i*1e3),r=Xe(e,n,a,60*i/t);return r?{orbitPath:r.map(e=>e.position),groundTrack:r.map(e=>({timestamp:e.timestamp,location:e.geographicLocation,velocity:Math.sqrt(Math.pow(e.velocity.x,2)+Math.pow(e.velocity.y,2)+Math.pow(e.velocity.z,2))}))}:null},e.generateTLEDiff=function(e,t){const i=nt(e,t);let n=`--- Old TLE (Epoch: ${e.epoch})\n`;n+=`+++ New TLE (Epoch: ${t.epoch})\n`,n+=`@@ Satellite ${i.satelliteNumber} - ${i.satelliteName||"Unknown"} @@\n\n`;for(const e of i.differences)n+=`- ${e.field}: ${e.oldValue}\n`,n+=`+ ${e.field}: ${e.newValue}`,void 0!==e.percentChange&&(n+=` (${e.percentChange>0?"+":""}${e.percentChange.toFixed(2)}%)`),n+="\n";return i.significantChanges.length>0&&(n+=`\nâš ï¸  ${i.significantChanges.length} significant change(s) detected\n`),n},e.generateValidationReport=function(e,t,i={}){var n,a;const r=[],s=[],o=[],c=[],l=[];let h=0,u=0,m=0;if(!1!==i.validateChecksums){h+=2,l.push("checksum");const e=z(t.line1,1);e.valid?u++:(r.push({code:"CHECKSUM_MISMATCH",message:e.message||"Checksum validation failed",line:1,severity:"error",field:"checksum1"}),m++);const i=z(t.line2,2);i.valid?u++:(r.push({code:"CHECKSUM_MISMATCH",message:i.message||"Checksum validation failed",line:2,severity:"error",field:"checksum2"}),m++)}if(!1!==i.validateEpoch){h++,l.push("epochDate");const t=parseInt(e.epochYear,10),n=parseFloat(e.epoch),a=P(t,n);a.valid?u++:(r.push({code:"INVALID_EPOCH",message:a.message||"Invalid epoch date",severity:"error",field:"epoch"}),m++);const o=V(t,n,{referenceDate:i.referenceDate,allowFuture:i.allowFutureEpochs,maxAge:i.maxEpochAge});o.valid?o.message&&s.push({code:"STALE_EPOCH",message:o.message,severity:"warning",field:"epoch"}):r.push({code:"EPOCH_OUT_OF_RANGE",message:o.message||"Epoch age out of acceptable range",severity:"error",field:"epoch"})}const d={valid:[],invalid:[]};if(!1!==i.validateRanges){l.push("orbitalParameterRanges");const t=k(e,i.strict);h+=t.length;for(const e of t)e.valid?e.message?(s.push({code:"PARAMETER_OUTSIDE_TYPICAL",message:e.message,severity:"warning",field:null===(a=e.context)||void 0===a?void 0:a.field}),u++,d.valid.push(e)):(u++,d.valid.push(e)):(r.push({code:"PARAMETER_OUT_OF_RANGE",message:e.message||"Parameter out of valid range",severity:"error",field:null===(n=e.context)||void 0===n?void 0:n.field}),m++,d.invalid.push(e))}if(i.detectAnomalies&&(l.push("anomalyDetection"),o.push(...q(e))),i.sanitizeFields){l.push("fieldSanitization");const t=Z(e);for(const[e]of t)c.push(e)}h++,l.push("satelliteNumber");const p=H(e.satelliteNumber1);p.valid?u++:(r.push({code:"INVALID_SATELLITE_NUMBER",message:p.message||"Invalid satellite number",severity:"error",field:"satelliteNumber"}),m++),e.satelliteNumber1!==e.satelliteNumber2&&s.push({code:"SATELLITE_NUMBER_MISMATCH",message:`Satellite numbers do not match: ${e.satelliteNumber1} vs ${e.satelliteNumber2}`,severity:"warning",field:"satelliteNumber"}),h++,l.push("internationalDesignator");const E=j(e.internationalDesignatorYear+e.internationalDesignatorLaunchNumber+e.internationalDesignatorPiece);let g;if(E.valid?u++:(s.push({code:"INVALID_DESIGNATOR",message:E.message||"Invalid international designator",severity:"warning",field:"internationalDesignator"}),m++),!1!==i.calculateQuality){const t=U(parseInt(e.epochYear,10),parseFloat(e.epoch),i.referenceDate);g=K(e,{checksumValid:0===r.filter(e=>"CHECKSUM_MISMATCH"===e.code).length,formatValid:0===r.filter(e=>{var t;return null===(t=e.code)||void 0===t?void 0:t.includes("FORMAT")}).length,rangeErrors:d.invalid,rangeResults:[...d.valid,...d.invalid],epochAge:t,anomalies:o})}else g={overall:0,components:{checksumScore:0,formatScore:0,rangeScore:0,epochScore:0,anomalyScore:0,consistencyScore:0},grade:"F",assessment:"Not calculated"};return{isValid:0===r.length,qualityScore:g,errors:r,warnings:s,anomalies:o,sanitizedFields:c,timestamp:new Date,rulesApplied:l,summary:{totalChecks:h,passedChecks:u,failedChecks:m,warningCount:s.length,errorCount:r.length}}},e.getConstellation=ge,e.getErrorDescription=function(t){return{[e.ERROR_CODES.INVALID_INPUT_TYPE]:"Input data must be a string",[e.ERROR_CODES.EMPTY_INPUT]:"Input string is empty or contains only whitespace",[e.ERROR_CODES.INVALID_LINE_COUNT]:"TLE must contain exactly 2 or 3 lines",[e.ERROR_CODES.INVALID_LINE_LENGTH]:"TLE line must be exactly 69 characters",[e.ERROR_CODES.INVALID_LINE_NUMBER]:"Line number must be 1 or 2",[e.ERROR_CODES.CHECKSUM_MISMATCH]:"Calculated checksum does not match",[e.ERROR_CODES.INVALID_CHECKSUM_CHARACTER]:"Checksum must be a digit 0-9",[e.ERROR_CODES.SATELLITE_NUMBER_MISMATCH]:"Satellite numbers on line 1 and line 2 must match",[e.ERROR_CODES.INVALID_SATELLITE_NUMBER]:"Satellite catalog number is invalid",[e.ERROR_CODES.INVALID_CLASSIFICATION]:"Classification must be U, C, or S",[e.ERROR_CODES.VALUE_OUT_OF_RANGE]:"Field value is outside valid range",[e.ERROR_CODES.INVALID_NUMBER_FORMAT]:"Field contains invalid numeric format",[e.ERROR_CODES.SATELLITE_NAME_TOO_LONG]:"Satellite name exceeds maximum length",[e.ERROR_CODES.SATELLITE_NAME_FORMAT_WARNING]:"Satellite name contains unusual characters",[e.ERROR_CODES.CLASSIFIED_DATA_WARNING]:"TLE contains classified satellite data",[e.ERROR_CODES.STALE_TLE_WARNING]:"TLE epoch is significantly old",[e.ERROR_CODES.HIGH_ECCENTRICITY_WARNING]:"Eccentricity is unusually high",[e.ERROR_CODES.LOW_MEAN_MOTION_WARNING]:"Mean motion is unusually low",[e.ERROR_CODES.DEPRECATED_EPOCH_YEAR_WARNING]:"Epoch year is in the far past",[e.ERROR_CODES.REVOLUTION_NUMBER_ROLLOVER_WARNING]:"Revolution number may have rolled over",[e.ERROR_CODES.NEAR_ZERO_DRAG_WARNING]:"Drag coefficient is near zero",[e.ERROR_CODES.NON_STANDARD_EPHEMERIS_WARNING]:"Ephemeris type is non-standard",[e.ERROR_CODES.NEGATIVE_DECAY_WARNING]:"Mean motion decay is negative"}[t]||"Unknown error code"},e.getPositionAtEpoch=function(e){if(!Je(e))return null;const t=parseInt(e.epochYear),i=t<57?2e3+t:1900+t,n=parseFloat(e.epoch),a=Math.floor(n),r=n-a,s=new Date(Date.UTC(i,0,a));return s.setUTCMilliseconds(864e5*r),Ze(e,s)},e.getPositionAtTime=Ze,e.getProfileOptions=v,e.getProviderOptions=L,e.groupByConstellation=function(e){const t=new Map;for(const i of e){let e=!1;for(const[n]of Object.entries(Ee))if(fe(i,n)){t.has(n)||t.set(n,[]),t.get(n).push(i),e=!0;break}e||(t.has("unknown")||t.set("unknown",[]),t.get("unknown").push(i))}return t},e.groupIntoOrbitalFamilies=function(e,t={inclinationTolerance:1,altitudeTolerance:50,eccentricityTolerance:.01}){const i=[],n=new Set;for(let a=0;a<e.length;a++){const r=e[a];if(n.has(r.satelliteNumber1))continue;const s=[r.satelliteNumber1];n.add(r.satelliteNumber1);const o=parseFloat(r.inclination),c=ct(parseFloat(r.meanMotion)),l=parseFloat(r.eccentricity);for(let i=a+1;i<e.length;i++){const a=e[i];if(n.has(a.satelliteNumber1))continue;const r=parseFloat(a.inclination),h=ct(parseFloat(a.meanMotion)),u=parseFloat(a.eccentricity);Math.abs(o-r)<=t.inclinationTolerance&&Math.abs(c-h)<=t.altitudeTolerance&&Math.abs(l-u)<=t.eccentricityTolerance&&(s.push(a.satelliteNumber1),n.add(a.satelliteNumber1))}let h="Unknown";o>95&&o<100?h="Sun-synchronous Earth observation":o<10&&c>35e3?h="Geostationary communications":o>50&&o<60&&c>19e3&&c<24e3?h="Navigation (GPS/GLONASS)":c<600&&(h="Low Earth orbit constellation"),i.push({familyId:`FAMILY_${i.length+1}`,satellites:s,commonCharacteristics:{inclination:o,semiMajorAxis:c+6371,eccentricity:l},tolerances:t,purpose:h})}return i},e.initializeSatelliteRecord=Je,e.isCriticalError=function(e){return!l(e)},e.isParseFailure=function(e){return!1===e.success},e.isParseSuccess=function(e){return!0===e.success},e.isParsedTLE=function(e){return"object"==typeof e&&null!==e&&["lineNumber1","satelliteNumber1","classification","lineNumber2","satelliteNumber2","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion"].every(t=>t in e)},e.isTLEError=p,e.isTLEWarning=function(e){return p(e)&&"warning"===e.severity},e.isValidClassification=function(e){return"U"===e||"C"===e||"S"===e},e.isValidErrorCode=function(t){return Object.values(e.ERROR_CODES).includes(t)},e.isValidationFailure=function(e){return!1===e.success},e.isValidationSuccess=function(e){return!0===e.success},e.isWarningCode=l,e.keplerianToCartesian=ht,e.kvnToText=function(e){let t="KVN/1.0\n\n";t+=`CREATION_DATE = ${e.CREATION_DATE}\n`,t+=`ORIGINATOR = ${e.ORIGINATOR}\n\n`,t+=`OBJECT_NAME = ${e.OBJECT_NAME}\n`,t+=`OBJECT_ID = ${e.OBJECT_ID}\n\n`,t+="ELEMENTS\n";for(const[i,n]of Object.entries(e.elements))t+=`  ${i} = ${n}\n`;return t},e.listConstellations=function(){return Object.keys(Ee)},e.matchesConstellation=fe,e.normalizeAssumedDecimalNotation=Y,e.normalizeLineEndings=Tt,e.normalizeScientificNotation=function(e,t="standard"){return"assumedDecimal"===t?Y(e):"integer"===t?parseInt(e.trim(),10):parseFloat(e.trim())},e.oemToText=function(e){let t=`CCSDS_OEM_VERS = ${e.CCSDS_OEM_VERS}\n`;t+=`CREATION_DATE = ${e.CREATION_DATE}\n`,t+=`ORIGINATOR = ${e.ORIGINATOR}\n\n`,t+="META_START\n",t+=`OBJECT_NAME = ${e.OBJECT_NAME}\n`,t+=`OBJECT_ID = ${e.OBJECT_ID}\n`,t+=`CENTER_NAME = ${e.CENTER_NAME}\n`,t+=`REF_FRAME = ${e.REF_FRAME}\n`,t+=`TIME_SYSTEM = ${e.TIME_SYSTEM}\n`,t+=`START_TIME = ${e.START_TIME}\n`,t+=`STOP_TIME = ${e.STOP_TIME}\n`,t+=`INTERPOLATION = ${e.INTERPOLATION}\n`,t+=`INTERPOLATION_DEGREE = ${e.INTERPOLATION_DEGREE}\n`,t+="META_STOP\n\n",t+="DATA_START\n";for(const i of e.ephemerisData)t+=`${"string"==typeof i.time?i.time:i.time.toISOString()} ${i.position.x} ${i.position.y} ${i.position.z} `,t+=`${i.velocity.vx} ${i.velocity.vy} ${i.velocity.vz}\n`;return t+="DATA_STOP\n",t},e.ommToTLE=function(e){const t=new Date(e.EPOCH),i=t.getUTCFullYear()%100,n=function(e){const t=new Date(Date.UTC(e.getUTCFullYear(),0,1));return 1+(e.getTime()-t.getTime())/864e5}(t);let a=`${e.OBJECT_NAME}\n`;var r;const s=["1",e.NORAD_CAT_ID.padStart(5," "),e.CLASSIFICATION_TYPE," ",(r=e.OBJECT_ID,r.padEnd(8," "))," ",i.toString().padStart(2,"0"),n.toFixed(8).padStart(12," ")," ",Et(e.MEAN_MOTION_DOT,8)," ",Et(e.MEAN_MOTION_DDOT,8)," ",Et(e.BSTAR,8)," ",e.EPHEMERIS_TYPE.toString()," ",e.ELEMENT_SET_NO.toString().padStart(4," ")].join("");var o;a+=s+gt(s)+"\n";const c=["2",e.NORAD_CAT_ID.padStart(5," ")," ",e.INCLINATION.toFixed(4).padStart(8," ")," ",e.RA_OF_ASC_NODE.toFixed(4).padStart(8," ")," ",(o=e.ECCENTRICITY,o.toFixed(7).substring(2))," ",e.ARG_OF_PERICENTER.toFixed(4).padStart(8," ")," ",e.MEAN_ANOMALY.toFixed(4).padStart(8," ")," ",e.MEAN_MOTION.toFixed(8).padStart(11," "),e.REV_AT_EPOCH.toString().padStart(5," ")].join("");return a+=c+gt(c),a},e.ommToXML=function(e){let t='<?xml version="1.0" encoding="UTF-8"?>\n';return t+='<omm xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n',t+='     id="CCSDS_OMM_VERS" version="2.0">\n',t+="  <header>\n",t+=`    <CREATION_DATE>${e.CREATION_DATE}</CREATION_DATE>\n`,t+=`    <ORIGINATOR>${e.ORIGINATOR}</ORIGINATOR>\n`,t+="  </header>\n",t+="  <body>\n",t+="    <segment>\n",t+="      <metadata>\n",t+=`        <OBJECT_NAME>${e.OBJECT_NAME}</OBJECT_NAME>\n`,t+=`        <OBJECT_ID>${e.OBJECT_ID}</OBJECT_ID>\n`,t+=`        <CENTER_NAME>${e.CENTER_NAME}</CENTER_NAME>\n`,t+=`        <REF_FRAME>${e.REF_FRAME}</REF_FRAME>\n`,t+=`        <TIME_SYSTEM>${e.TIME_SYSTEM}</TIME_SYSTEM>\n`,t+=`        <MEAN_ELEMENT_THEORY>${e.MEAN_ELEMENT_THEORY}</MEAN_ELEMENT_THEORY>\n`,t+="      </metadata>\n",t+="      <data>\n",t+=`        <EPOCH>${e.EPOCH}</EPOCH>\n`,t+=`        <MEAN_MOTION>${e.MEAN_MOTION}</MEAN_MOTION>\n`,t+=`        <ECCENTRICITY>${e.ECCENTRICITY}</ECCENTRICITY>\n`,t+=`        <INCLINATION>${e.INCLINATION}</INCLINATION>\n`,t+=`        <RA_OF_ASC_NODE>${e.RA_OF_ASC_NODE}</RA_OF_ASC_NODE>\n`,t+=`        <ARG_OF_PERICENTER>${e.ARG_OF_PERICENTER}</ARG_OF_PERICENTER>\n`,t+=`        <MEAN_ANOMALY>${e.MEAN_ANOMALY}</MEAN_ANOMALY>\n`,t+=`        <BSTAR>${e.BSTAR}</BSTAR>\n`,t+=`        <MEAN_MOTION_DOT>${e.MEAN_MOTION_DOT}</MEAN_MOTION_DOT>\n`,t+=`        <MEAN_MOTION_DDOT>${e.MEAN_MOTION_DDOT}</MEAN_MOTION_DDOT>\n`,t+="      </data>\n",t+="    </segment>\n",t+="  </body>\n",t+="</omm>\n",t},e.parseBatch=R,e.parseBatchAsync=function(e){return f(this,arguments,void 0,function*(e,t={}){return Promise.resolve(R(e,t))})},e.parseFromCompressed=function(e){return f(this,arguments,void 0,function*(e,t={}){const n=i.createReadStream(e),a=o.createGunzip();return S(n.pipe(a),t)})},e.parseFromFile=function(e){return f(this,arguments,void 0,function*(e,t={}){const{encoding:i="utf8"}=t,n=g(t,["encoding"]);return R(yield N(e,{encoding:i}),n)})},e.parseFromStream=S,e.parseFromURL=function(e){return f(this,arguments,void 0,function*(e,t={}){const{headers:i,timeout:n=3e4}=t,a=g(t,["headers","timeout"]),r=new AbortController,s=setTimeout(()=>r.abort(),n);try{const t=yield fetch(e,{headers:i,signal:r.signal});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return R(yield t.text(),a)}finally{clearTimeout(s)}})},e.parseInterval=function(e){const t=e.match(/^(\d+)\s*(ms|s|m|h|d|w)$/i);if(!t||!t[1]||!t[2])throw new Error(`Invalid interval format: ${e}`);const i=parseInt(t[1],10),n=t[2].toLowerCase();switch(n){case"ms":return i;case"s":return 1e3*i;case"m":return 60*i*1e3;case"h":return 60*i*60*1e3;case"d":return 24*i*60*60*1e3;case"w":return 7*i*24*60*60*1e3;default:throw new Error(`Unknown interval unit: ${n}`)}},e.parseParallel=function(e){return f(this,arguments,void 0,function*(e,t={},i){return R(e,t)})},e.parseTLE=xt,e.parseTLEAsync=A,e.parseTLELines=At,e.parseWithProfile=function(e,t){return xt(e,v(t))},e.parseWithProvider=function(e,t){return xt(e,L(t))},e.parseWithStateMachine=function(e,t={}){return new E(t).parse(e)},e.predictConjunctions=function(e,t,i,n,a=10){const r=[];let s=1/0,o=!1;const c=i.getTime(),l=n.getTime();for(let i=c;i<=l;i+=6e4){const n=new Date(i),c=Ze(e,n),l=Ze(t,n);if(!c||!l)continue;const h=Math.sqrt(Math.pow(c.position.x-l.position.x,2)+Math.pow(c.position.y-l.position.y,2)+Math.pow(c.position.z-l.position.z,2));if(h<s)o=!0;else if(o&&h>s){if(s<=a){const n=Math.sqrt(Math.pow(c.velocity.x-l.velocity.x,2)+Math.pow(c.velocity.y-l.velocity.y,2)+Math.pow(c.velocity.z-l.velocity.z,2));let a="low";s<1?a="critical":s<2?a="high":s<5&&(a="medium");const o=new Date(i-6e4),h=Ze(e,o),u=Ze(t,o);h&&u&&r.push({time:o,distance:s,relativeVelocity:n,satellite1Position:h.position,satellite2Position:u.position,riskLevel:a})}o=!1}s=h}return r},e.predictFuturePositions=Xe,e.reconstructTLE=le,e.reconstructTLEFromParsedObject=dt,e.sanitizeAllFields=Z,e.sanitizeField=J,e.splitTLEs=T,e.stkToFile=function(e){let t="stk.v.11.0\n\n";t+=`# Satellite: ${e.header.satelliteName}\n`,t+=`# Coordinate System: ${e.header.coordinateSystem}\n`,t+=`# Central Body: ${e.header.centralBody}\n\n`,t+="BEGIN Ephemeris\n\n",t+=`NumberOfEphemerisPoints ${e.stateVectors.length}\n\n`,t+="EphemerisTimePosVel\n\n";for(const i of e.stateVectors)t+=`${"string"==typeof i.time?i.time:i.time.toISOString()} ${i.position.x} ${i.position.y} ${i.position.z} `,t+=`${i.velocity.vx} ${i.velocity.vy} ${i.velocity.vz}\n`;return t+="\nEND Ephemeris\n",t},e.tleCache=me,e.tleToCelestia=mt,e.tleToCustomFormat=function(e,t){let i=t.header||"";const n=t.separator||",",a=t.lineEnding||"\n",r=[];for(const i of t.fields){let t=e[i.source];i.transform&&(t=i.transform(t)),i.format&&"number"==typeof t&&(t=t.toFixed(parseInt(i.format)||0)),r.push(String(t))}return i+=r.join(n)+a,i+=t.footer||"",i},e.tleToGPSAlmanac=function(e){const t=pt(e.epochYear,e.epoch),i=lt(e),n=new Date("1980-01-06T00:00:00Z"),a=Math.floor((t.getTime()-n.getTime())/6048e5);return{satelliteId:e.satelliteNumber1,health:0,eccentricity:parseFloat(e.eccentricity),timeOfApplicability:t.getTime()/1e3,orbitalInclination:parseFloat(e.inclination)*Math.PI/180,rateOfRightAscension:0,sqrtSemiMajorAxis:Math.sqrt(i.semiMajorAxis),rightAscensionAtWeek:parseFloat(e.rightAscension)*Math.PI/180,argumentOfPerigee:parseFloat(e.argumentOfPerigee)*Math.PI/180,meanAnomaly:parseFloat(e.meanAnomaly)*Math.PI/180,af0:0,af1:0,week:a}},e.tleToKVN=function(e,t="TLE-PARSER"){const i=pt(e.epochYear,e.epoch);return{KVN_VERS:"1.0",CREATION_DATE:(new Date).toISOString(),ORIGINATOR:t,OBJECT_NAME:e.satelliteName||`SATELLITE ${e.satelliteNumber1}`,OBJECT_ID:e.satelliteNumber1,elements:{EPOCH:i.toISOString(),MEAN_MOTION:parseFloat(e.meanMotion),ECCENTRICITY:parseFloat(e.eccentricity),INCLINATION:parseFloat(e.inclination),RA_OF_ASC_NODE:parseFloat(e.rightAscension),ARG_OF_PERICENTER:parseFloat(e.argumentOfPerigee),MEAN_ANOMALY:parseFloat(e.meanAnomaly),BSTAR:parseFloat(e.bStar),MEAN_MOTION_DOT:parseFloat(e.firstDerivative),MEAN_MOTION_DDOT:parseFloat(e.secondDerivative)}}},e.tleToLegacyFormat=function(e){return dt(e)},e.tleToOEM=function(e,t=86400,i="TLE-PARSER"){const n=pt(e.epochYear,e.epoch),a=new Date(n.getTime()),r=new Date(n.getTime()+1e3*t);return{CCSDS_OEM_VERS:"2.0",CREATION_DATE:(new Date).toISOString(),ORIGINATOR:i,OBJECT_NAME:e.satelliteName||`SATELLITE ${e.satelliteNumber1}`,OBJECT_ID:e.satelliteNumber1,CENTER_NAME:"EARTH",REF_FRAME:"TEME",TIME_SYSTEM:"UTC",START_TIME:a.toISOString(),STOP_TIME:r.toISOString(),USEABLE_START_TIME:a.toISOString(),USEABLE_STOP_TIME:r.toISOString(),INTERPOLATION:"HERMITE",INTERPOLATION_DEGREE:7,ephemerisData:[{time:n.toISOString(),position:{x:0,y:0,z:0},velocity:{vx:0,vy:0,vz:0}}]}},e.tleToOMM=function(e,t="TLE-PARSER"){const i=pt(e.epochYear,e.epoch);return{CCSDS_OMM_VERS:"2.0",CREATION_DATE:(new Date).toISOString(),ORIGINATOR:t,OBJECT_NAME:e.satelliteName||`SATELLITE ${e.satelliteNumber1}`,OBJECT_ID:e.satelliteNumber1,CENTER_NAME:"EARTH",REF_FRAME:"TEME",TIME_SYSTEM:"UTC",MEAN_ELEMENT_THEORY:"SGP4",EPOCH:i.toISOString(),MEAN_MOTION:parseFloat(e.meanMotion),ECCENTRICITY:parseFloat(e.eccentricity),INCLINATION:parseFloat(e.inclination),RA_OF_ASC_NODE:parseFloat(e.rightAscension),ARG_OF_PERICENTER:parseFloat(e.argumentOfPerigee),MEAN_ANOMALY:parseFloat(e.meanAnomaly),EPHEMERIS_TYPE:parseInt(e.ephemerisType),CLASSIFICATION_TYPE:e.classification,NORAD_CAT_ID:e.satelliteNumber1,ELEMENT_SET_NO:parseInt(e.elementSetNumber),REV_AT_EPOCH:parseInt(e.revolutionNumber),BSTAR:parseFloat(e.bStar),MEAN_MOTION_DOT:parseFloat(e.firstDerivative),MEAN_MOTION_DDOT:parseFloat(e.secondDerivative)}},e.tleToPlanetarium=function(t,i){switch(i){case e.PlanetariumFormat.STELLARIUM:return ut(t);case e.PlanetariumFormat.CELESTIA:return mt(t);case e.PlanetariumFormat.SPACENGINE:case e.PlanetariumFormat.UNIVERSESANDBOX:return JSON.stringify(lt(t),null,2);default:return JSON.stringify(t,null,2)}},e.tleToSTK=function(e,t=86400){const i=pt(e.epochYear,e.epoch);return{header:{version:"stk.v.11.0",satelliteName:e.satelliteName||`SATELLITE ${e.satelliteNumber1}`,coordinateSystem:"TEME",centralBody:"Earth"},stateVectors:[{time:i.toISOString(),position:{x:0,y:0,z:0},velocity:{vx:0,vy:0,vz:0}}]}},e.tleToStateVector=function(e){const t=lt(e),{position:i,velocity:n}=ht(t);return{time:t.epoch,position:i,velocity:n}},e.tleToStellarium=ut,e.transformCoordinateFrame=function(t,i,n,a){return i===n||i===e.CoordinateFrame.TEME&&n===e.CoordinateFrame.J2000||i===e.CoordinateFrame.J2000&&e.CoordinateFrame.TEME,t},e.validateAgainstRadar=function(e,t,i){return{isValid:!0,positionError:.5,velocityError:.001,confidence:.95,discrepancies:[]}},e.validateAllOrbitalParameters=k,e.validateChecksum=Ot,e.validateClassification=_t,e.validateEpochAge=V,e.validateEpochDate=P,e.validateFreshness=pe,e.validateInternationalDesignator=j,e.validateLineStructure=Mt,e.validateNumericRange=yt,e.validateOrbitalParameter=G,e.validateSatelliteNumber=St,e.validateTLE=bt,e.validateTLEAsync=function(e){return f(this,arguments,void 0,function*(e,t={}){return Promise.resolve(bt(e,t))})},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.min.js.map
