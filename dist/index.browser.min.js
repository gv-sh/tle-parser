/**
 * tle-parser v1.0.0
 * A parser for TLE (Two-Line Element) satellite data.
 * @license MIT
 */
var e;function t(t){return Object.values(e).includes(t)}function i(t){return{[e.INVALID_INPUT_TYPE]:"Input data must be a string",[e.EMPTY_INPUT]:"Input string is empty or contains only whitespace",[e.INVALID_LINE_COUNT]:"TLE must contain exactly 2 or 3 lines",[e.INVALID_LINE_LENGTH]:"TLE line must be exactly 69 characters",[e.INVALID_LINE_NUMBER]:"Line number must be 1 or 2",[e.CHECKSUM_MISMATCH]:"Calculated checksum does not match",[e.INVALID_CHECKSUM_CHARACTER]:"Checksum must be a digit 0-9",[e.SATELLITE_NUMBER_MISMATCH]:"Satellite numbers on line 1 and line 2 must match",[e.INVALID_SATELLITE_NUMBER]:"Satellite catalog number is invalid",[e.INVALID_CLASSIFICATION]:"Classification must be U, C, or S",[e.VALUE_OUT_OF_RANGE]:"Field value is outside valid range",[e.INVALID_NUMBER_FORMAT]:"Field contains invalid numeric format",[e.SATELLITE_NAME_TOO_LONG]:"Satellite name exceeds maximum length",[e.SATELLITE_NAME_FORMAT_WARNING]:"Satellite name contains unusual characters",[e.CLASSIFIED_DATA_WARNING]:"TLE contains classified satellite data",[e.STALE_TLE_WARNING]:"TLE epoch is significantly old",[e.HIGH_ECCENTRICITY_WARNING]:"Eccentricity is unusually high",[e.LOW_MEAN_MOTION_WARNING]:"Mean motion is unusually low",[e.DEPRECATED_EPOCH_YEAR_WARNING]:"Epoch year is in the far past",[e.REVOLUTION_NUMBER_ROLLOVER_WARNING]:"Revolution number may have rolled over",[e.NEAR_ZERO_DRAG_WARNING]:"Drag coefficient is near zero",[e.NON_STANDARD_EPHEMERIS_WARNING]:"Ephemeris type is non-standard",[e.NEGATIVE_DECAY_WARNING]:"Mean motion decay is negative"}[t]||"Unknown error code"}function n(t){return[e.SATELLITE_NAME_FORMAT_WARNING,e.CLASSIFIED_DATA_WARNING,e.STALE_TLE_WARNING,e.HIGH_ECCENTRICITY_WARNING,e.LOW_MEAN_MOTION_WARNING,e.DEPRECATED_EPOCH_YEAR_WARNING,e.REVOLUTION_NUMBER_ROLLOVER_WARNING,e.NEAR_ZERO_DRAG_WARNING,e.NON_STANDARD_EPHEMERIS_WARNING,e.NEGATIVE_DECAY_WARNING].includes(t)}function s(e){return!n(e)}!function(e){e.INVALID_INPUT_TYPE="INVALID_INPUT_TYPE",e.EMPTY_INPUT="EMPTY_INPUT",e.INVALID_LINE_COUNT="INVALID_LINE_COUNT",e.INVALID_LINE_LENGTH="INVALID_LINE_LENGTH",e.INVALID_LINE_NUMBER="INVALID_LINE_NUMBER",e.CHECKSUM_MISMATCH="CHECKSUM_MISMATCH",e.INVALID_CHECKSUM_CHARACTER="INVALID_CHECKSUM_CHARACTER",e.SATELLITE_NUMBER_MISMATCH="SATELLITE_NUMBER_MISMATCH",e.INVALID_SATELLITE_NUMBER="INVALID_SATELLITE_NUMBER",e.INVALID_CLASSIFICATION="INVALID_CLASSIFICATION",e.VALUE_OUT_OF_RANGE="VALUE_OUT_OF_RANGE",e.INVALID_NUMBER_FORMAT="INVALID_NUMBER_FORMAT",e.SATELLITE_NAME_TOO_LONG="SATELLITE_NAME_TOO_LONG",e.SATELLITE_NAME_FORMAT_WARNING="SATELLITE_NAME_FORMAT_WARNING",e.CLASSIFIED_DATA_WARNING="CLASSIFIED_DATA_WARNING",e.STALE_TLE_WARNING="STALE_TLE_WARNING",e.HIGH_ECCENTRICITY_WARNING="HIGH_ECCENTRICITY_WARNING",e.LOW_MEAN_MOTION_WARNING="LOW_MEAN_MOTION_WARNING",e.DEPRECATED_EPOCH_YEAR_WARNING="DEPRECATED_EPOCH_YEAR_WARNING",e.REVOLUTION_NUMBER_ROLLOVER_WARNING="REVOLUTION_NUMBER_ROLLOVER_WARNING",e.NEAR_ZERO_DRAG_WARNING="NEAR_ZERO_DRAG_WARNING",e.NON_STANDARD_EPHEMERIS_WARNING="NON_STANDARD_EPHEMERIS_WARNING",e.NEGATIVE_DECAY_WARNING="NEGATIVE_DECAY_WARNING"}(e||(e={})),e.INVALID_INPUT_TYPE,e.EMPTY_INPUT,e.INVALID_LINE_COUNT,e.INVALID_LINE_LENGTH,e.INVALID_LINE_NUMBER,e.CHECKSUM_MISMATCH,e.INVALID_CHECKSUM_CHARACTER,e.SATELLITE_NUMBER_MISMATCH,e.INVALID_SATELLITE_NUMBER,e.INVALID_CLASSIFICATION,e.VALUE_OUT_OF_RANGE,e.INVALID_NUMBER_FORMAT,e.SATELLITE_NAME_TOO_LONG,e.SATELLITE_NAME_FORMAT_WARNING,e.CLASSIFIED_DATA_WARNING,e.STALE_TLE_WARNING,e.HIGH_ECCENTRICITY_WARNING,e.LOW_MEAN_MOTION_WARNING,e.DEPRECATED_EPOCH_YEAR_WARNING,e.REVOLUTION_NUMBER_ROLLOVER_WARNING,e.NEAR_ZERO_DRAG_WARNING,e.NON_STANDARD_EPHEMERIS_WARNING,e.NEGATIVE_DECAY_WARNING;var r,a,o,c,l,u;function I(e){return!0===e.success}function N(e){return!1===e.success}function E(e){return!0===e.success}function h(e){return!1===e.success}function d(e){return"object"==typeof e&&null!==e&&"code"in e&&"message"in e&&"severity"in e}function m(e){return d(e)&&"warning"===e.severity}function A(e){return"U"===e||"C"===e||"S"===e}function _(e){return"object"==typeof e&&null!==e&&["lineNumber1","satelliteNumber1","classification","lineNumber2","satelliteNumber2","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion"].every(t=>t in e)}!function(e){e.INVALID_LINE_COUNT="INVALID_LINE_COUNT",e.INVALID_LINE_LENGTH="INVALID_LINE_LENGTH",e.INVALID_LINE_NUMBER="INVALID_LINE_NUMBER",e.SATELLITE_NUMBER_MISMATCH="SATELLITE_NUMBER_MISMATCH",e.CHECKSUM_MISMATCH="CHECKSUM_MISMATCH",e.INVALID_CHECKSUM_CHARACTER="INVALID_CHECKSUM_CHARACTER",e.INVALID_CLASSIFICATION="INVALID_CLASSIFICATION",e.INVALID_SATELLITE_NUMBER="INVALID_SATELLITE_NUMBER",e.INVALID_INTL_DESIGNATOR_YEAR="INVALID_INTL_DESIGNATOR_YEAR",e.INVALID_INTL_DESIGNATOR_LAUNCH="INVALID_INTL_DESIGNATOR_LAUNCH",e.INVALID_EPOCH_YEAR="INVALID_EPOCH_YEAR",e.INVALID_EPOCH_DAY="INVALID_EPOCH_DAY",e.INVALID_EPHEMERIS_TYPE="INVALID_EPHEMERIS_TYPE",e.INVALID_ELEMENT_SET_NUMBER="INVALID_ELEMENT_SET_NUMBER",e.INVALID_INCLINATION="INVALID_INCLINATION",e.INVALID_RIGHT_ASCENSION="INVALID_RIGHT_ASCENSION",e.INVALID_ECCENTRICITY="INVALID_ECCENTRICITY",e.INVALID_ARG_OF_PERIGEE="INVALID_ARG_OF_PERIGEE",e.INVALID_MEAN_ANOMALY="INVALID_MEAN_ANOMALY",e.INVALID_MEAN_MOTION="INVALID_MEAN_MOTION",e.INVALID_REVOLUTION_NUMBER="INVALID_REVOLUTION_NUMBER",e.UNUSUAL_CLASSIFICATION="UNUSUAL_CLASSIFICATION",e.OLD_EPOCH="OLD_EPOCH",e.EXTREME_ECCENTRICITY="EXTREME_ECCENTRICITY",e.EXTREME_INCLINATION="EXTREME_INCLINATION",e.HIGH_MEAN_MOTION="HIGH_MEAN_MOTION",e.LOW_MEAN_MOTION="LOW_MEAN_MOTION",e.PARSE_ERROR="PARSE_ERROR",e.VALIDATION_ERROR="VALIDATION_ERROR"}(r||(r={})),function(e){e.INITIAL="INITIAL",e.READING_NAME="READING_NAME",e.READING_LINE1="READING_LINE1",e.READING_LINE2="READING_LINE2",e.COMPLETE="COMPLETE",e.ERROR="ERROR",e.RECOVERING="RECOVERING"}(a||(a={})),function(e){e.CONTINUE="CONTINUE",e.SKIP_FIELD="SKIP_FIELD",e.USE_DEFAULT="USE_DEFAULT",e.ATTEMPT_FIX="ATTEMPT_FIX",e.ABORT="ABORT"}(o||(o={})),function(e){e.INITIAL="INITIAL",e.DETECTING_FORMAT="DETECTING_FORMAT",e.PARSING_NAME="PARSING_NAME",e.PARSING_LINE1="PARSING_LINE1",e.PARSING_LINE2="PARSING_LINE2",e.VALIDATING="VALIDATING",e.COMPLETED="COMPLETED",e.ERROR="ERROR"}(c||(c={})),function(e){e.WARNING="warning",e.ERROR="error",e.CRITICAL="critical"}(l||(l={})),function(e){e.CONTINUE="CONTINUE",e.SKIP_FIELD="SKIP_FIELD",e.USE_DEFAULT="USE_DEFAULT",e.ATTEMPT_FIX="ATTEMPT_FIX",e.ABORT="ABORT"}(u||(u={}));class R{constructor(e={}){this.options=Object.assign({attemptRecovery:!0,maxRecoveryAttempts:10,includePartialResults:!0,strictMode:!1},e),this.state=c.INITIAL,this.errors=[],this.warnings=[],this.recoveryActions=[],this.parsedData={},this.context={lineCount:0,hasName:!1,nameLineIndex:-1,line1Index:-1,line2Index:-1,lines:[],recoveryAttempts:0},this.reset()}reset(){this.state=c.INITIAL,this.errors=[],this.warnings=[],this.recoveryActions=[],this.parsedData={},this.context={lineCount:0,hasName:!1,nameLineIndex:-1,line1Index:-1,line2Index:-1,lines:[],recoveryAttempts:0}}addIssue(e,t,i,n={}){const s=Object.assign({severity:e,code:t,message:i,state:this.state},n);return e===l.WARNING?this.warnings.push(s):this.errors.push(s),s}recordRecovery(e,t,i={}){this.recoveryActions.push(Object.assign({action:e,description:t,state:this.state,timestamp:Date.now()},i)),this.context.recoveryAttempts++}transition(e,t=""){const i=this.state;return this.state=e,{from:i,to:e,reason:t}}parse(t){return this.reset(),"string"!=typeof t?(this.addIssue(l.CRITICAL,e.INVALID_INPUT_TYPE,"TLE data must be a string",{inputType:typeof t}),this.transition(c.ERROR),this.getResult()):0===t.length?(this.addIssue(l.CRITICAL,e.EMPTY_INPUT,"TLE string cannot be empty",{inputLength:0}),this.transition(c.ERROR),this.getResult()):(this.transition(c.DETECTING_FORMAT,"Starting parse"),this.detectFormat(t),this.state===c.DETECTING_FORMAT&&this.executeStateMachine(),this.getResult())}detectFormat(t){var i;const n=t.trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0);if(this.context.lines=n,this.context.lineCount=n.length,n.length<2)return this.addIssue(l.CRITICAL,e.INVALID_LINE_COUNT,`TLE must contain at least 2 lines (found ${n.length})`,{expected:"2 or 3",actual:n.length}),this.options.attemptRecovery&&this.recordRecovery(u.ABORT,"Insufficient lines to parse TLE",{lineCount:n.length}),void this.transition(c.ERROR);if(n.length>3){if(this.addIssue(l.ERROR,e.INVALID_LINE_COUNT,`TLE should contain 2 or 3 lines (found ${n.length})`,{expected:"2 or 3",actual:n.length}),this.options.attemptRecovery){this.recordRecovery(u.ATTEMPT_FIX,"Attempting to identify valid TLE lines from excess lines",{lineCount:n.length});const e=n.filter(e=>"1"===e[0]),t=n.filter(e=>"2"===e[0]);if(1===e.length&&1===t.length){const i=e[0],s=t[0];if(!i||!s)return;const r=n.indexOf(i),a=n.indexOf(s);if(r<a){r>0&&(this.context.hasName=!0,this.context.nameLineIndex=r-1),this.context.line1Index=r,this.context.line2Index=a;const e=n[this.context.nameLineIndex],t=n[r],i=n[a];this.context.lines=this.context.hasName&&e&&t&&i?[e,t,i]:t&&i?[t,i]:[],this.context.lineCount=this.context.lines.length,this.recordRecovery(u.CONTINUE,"Successfully identified TLE lines from excess input",{extractedLines:this.context.lineCount})}}}}else if(3===n.length){const t=null===(i=n[0])||void 0===i?void 0:i[0];"1"!==t&&"2"!==t||this.addIssue(l.WARNING,e.SATELLITE_NAME_FORMAT_WARNING,'First line starts with "1" or "2", might be missing satellite name',{firstLine:n[0]}),this.context.hasName=!0,this.context.nameLineIndex=0,this.context.line1Index=1,this.context.line2Index=2}else this.context.hasName=!1,this.context.line1Index=0,this.context.line2Index=1}executeStateMachine(){let e=0;for(;this.state!==c.COMPLETED&&this.state!==c.ERROR&&e<100;){switch(this.state){case c.DETECTING_FORMAT:this.context.hasName?this.transition(c.PARSING_NAME):this.transition(c.PARSING_LINE1);break;case c.PARSING_NAME:this.parseSatelliteName(),this.transition(c.PARSING_LINE1);break;case c.PARSING_LINE1:this.parseLine1(),this.transition(c.PARSING_LINE2);break;case c.PARSING_LINE2:this.parseLine2(),this.transition(c.VALIDATING);break;case c.VALIDATING:this.validateCrossFields(),this.errors.some(e=>e.severity===l.CRITICAL)&&!this.options.includePartialResults?this.transition(c.ERROR):this.transition(c.COMPLETED);break;default:this.transition(c.ERROR,"Unexpected state")}e++}e>=100&&(this.addIssue(l.CRITICAL,"STATE_MACHINE_LOOP","State machine exceeded maximum iterations",{iterations:e}),this.transition(c.ERROR))}parseSatelliteName(){const t=this.context.nameLineIndex;if(t<0||t>=this.context.lines.length)return void this.addIssue(l.ERROR,"INVALID_NAME_LINE_INDEX","Invalid satellite name line index",{index:t});const i=this.context.lines[t];i&&(this.parsedData.satelliteName=i,i.length>24&&this.addIssue(l.WARNING,e.SATELLITE_NAME_TOO_LONG,"Satellite name exceeds recommended 24 characters",{length:i.length,name:i}),"1"!==i[0]&&"2"!==i[0]||this.addIssue(l.WARNING,e.SATELLITE_NAME_FORMAT_WARNING,'Satellite name starts with "1" or "2", might be incorrectly formatted',{name:i}))}parseLine1(){const t=this.context.line1Index;if(t<0||t>=this.context.lines.length)return void this.addIssue(l.CRITICAL,"INVALID_LINE1_INDEX","Invalid Line 1 index",{index:t});const i=this.context.lines[t];if(!i)return;if(this.parsedData.line1Raw=i,69!==i.length)if(this.addIssue(l.ERROR,e.INVALID_LINE_LENGTH,`Line 1 must be exactly 69 characters (got ${i.length})`,{line:1,expected:69,actual:i.length}),this.options.attemptRecovery)this.recordRecovery(u.CONTINUE,"Attempting to parse Line 1 despite incorrect length",{length:i.length});else if(this.options.strictMode)return;this.parseFieldSafe("lineNumber1",i,0,1,"Line 1 number"),this.parseFieldSafe("satelliteNumber1",i,2,7,"Satellite number"),this.parseFieldSafe("classification",i,7,8,"Classification"),this.parseFieldSafe("internationalDesignatorYear",i,9,11,"Int. designator year"),this.parseFieldSafe("internationalDesignatorLaunchNumber",i,11,14,"Int. designator launch"),this.parseFieldSafe("internationalDesignatorPiece",i,14,17,"Int. designator piece"),this.parseFieldSafe("epochYear",i,18,20,"Epoch year"),this.parseFieldSafe("epoch",i,20,32,"Epoch"),this.parseFieldSafe("firstDerivative",i,33,43,"First derivative"),this.parseFieldSafe("secondDerivative",i,44,52,"Second derivative"),this.parseFieldSafe("bStar",i,53,61,"B* drag term"),this.parseFieldSafe("ephemerisType",i,62,63,"Ephemeris type"),this.parseFieldSafe("elementSetNumber",i,64,68,"Element set number"),this.parseFieldSafe("checksum1",i,68,69,"Checksum"),"1"!==this.parsedData.lineNumber1&&this.addIssue(l.ERROR,e.INVALID_LINE_NUMBER,`Line 1 must start with '1' (got '${this.parsedData.lineNumber1}')`,{line:1,expected:"1",actual:this.parsedData.lineNumber1});const n=["U","C","S"];if(this.parsedData.classification&&!n.includes(this.parsedData.classification)&&this.addIssue(l.ERROR,e.INVALID_CLASSIFICATION,`Classification must be U, C, or S (got '${this.parsedData.classification}')`,{expected:n,actual:this.parsedData.classification}),69===i.length){const t=this.calculateChecksum(i),n=parseInt(this.parsedData.checksum1||"",10);isNaN(n)||t===n||(this.addIssue(l.ERROR,e.CHECKSUM_MISMATCH,`Line 1 checksum mismatch (expected ${t}, got ${n})`,{line:1,expected:t,actual:n}),this.options.attemptRecovery&&this.recordRecovery(u.CONTINUE,"Continuing despite checksum mismatch",{line:1}))}}parseLine2(){const t=this.context.line2Index;if(t<0||t>=this.context.lines.length)return void this.addIssue(l.CRITICAL,"INVALID_LINE2_INDEX","Invalid Line 2 index",{index:t});const i=this.context.lines[t];if(i){if(this.parsedData.line2Raw=i,69!==i.length)if(this.addIssue(l.ERROR,e.INVALID_LINE_LENGTH,`Line 2 must be exactly 69 characters (got ${i.length})`,{line:2,expected:69,actual:i.length}),this.options.attemptRecovery)this.recordRecovery(u.CONTINUE,"Attempting to parse Line 2 despite incorrect length",{length:i.length});else if(this.options.strictMode)return;if(this.parseFieldSafe("lineNumber2",i,0,1,"Line 2 number"),this.parseFieldSafe("satelliteNumber2",i,2,7,"Satellite number"),this.parseFieldSafe("inclination",i,8,16,"Inclination"),this.parseFieldSafe("rightAscension",i,17,25,"Right ascension"),this.parseFieldSafe("eccentricity",i,26,33,"Eccentricity"),this.parseFieldSafe("argumentOfPerigee",i,34,42,"Argument of perigee"),this.parseFieldSafe("meanAnomaly",i,43,51,"Mean anomaly"),this.parseFieldSafe("meanMotion",i,52,63,"Mean motion"),this.parseFieldSafe("revolutionNumber",i,63,68,"Revolution number"),this.parseFieldSafe("checksum2",i,68,69,"Checksum"),"2"!==this.parsedData.lineNumber2&&this.addIssue(l.ERROR,e.INVALID_LINE_NUMBER,`Line 2 must start with '2' (got '${this.parsedData.lineNumber2}')`,{line:2,expected:"2",actual:this.parsedData.lineNumber2}),69===i.length){const t=this.calculateChecksum(i),n=parseInt(this.parsedData.checksum2||"",10);isNaN(n)||t===n||(this.addIssue(l.ERROR,e.CHECKSUM_MISMATCH,`Line 2 checksum mismatch (expected ${t}, got ${n})`,{line:2,expected:t,actual:n}),this.options.attemptRecovery&&this.recordRecovery(u.CONTINUE,"Continuing despite checksum mismatch",{line:2}))}}}validateCrossFields(){if(this.parsedData.satelliteNumber1&&this.parsedData.satelliteNumber2){const t=this.parsedData.satelliteNumber1.trim(),i=this.parsedData.satelliteNumber2.trim();t!==i&&this.addIssue(l.ERROR,e.SATELLITE_NUMBER_MISMATCH,`Satellite numbers must match (Line 1: ${t}, Line 2: ${i})`,{line1Value:t,line2Value:i})}if(this.validateNumericField("inclination",0,180,"Inclination"),this.validateNumericField("rightAscension",0,360,"Right Ascension"),this.validateNumericField("argumentOfPerigee",0,360,"Argument of Perigee"),this.validateNumericField("meanAnomaly",0,360,"Mean Anomaly"),this.parsedData.eccentricity){const t=parseFloat("0."+this.parsedData.eccentricity.trim());!isNaN(t)&&(t<0||t>1)&&this.addIssue(l.ERROR,e.VALUE_OUT_OF_RANGE,`Eccentricity must be between 0 and 1 (got ${t})`,{field:"eccentricity",value:t,min:0,max:1})}this.validateNumericField("meanMotion",0,20,"Mean Motion",!0),this.validateNumericField("epochYear",0,99,"Epoch Year")}validateNumericField(t,i,n,s,r=!1){const a=this.parsedData[t];if(!a||"string"!=typeof a)return;const o=parseFloat(a.trim());isNaN(o)?this.addIssue(r?l.WARNING:l.ERROR,e.INVALID_NUMBER_FORMAT,`${s} must be numeric (got '${a}')`,{field:t,value:a}):(o<i||o>n)&&this.addIssue(r?l.WARNING:l.ERROR,e.VALUE_OUT_OF_RANGE,`${s} must be between ${i} and ${n} (got ${o})`,{field:t,value:o,min:i,max:n})}parseFieldSafe(e,t,i,n,s){try{t.length>=n?this.parsedData[e]=t.substring(i,n).trim():t.length>i?(this.parsedData[e]=t.substring(i).trim(),this.addIssue(l.WARNING,"PARTIAL_FIELD",`${s} is incomplete due to short line`,{field:e,expected:[i,n],actual:t.length}),this.options.attemptRecovery&&this.recordRecovery(u.USE_DEFAULT,`Using partial value for ${s}`,{field:e})):(this.parsedData[e]=null,this.addIssue(l.WARNING,"MISSING_FIELD",`${s} is missing due to short line`,{field:e,expected:[i,n],actual:t.length}),this.options.attemptRecovery&&this.recordRecovery(u.USE_DEFAULT,`Using null for missing ${s}`,{field:e}))}catch(t){this.parsedData[e]=null;const i=t instanceof Error?t.message:String(t);this.addIssue(l.ERROR,"FIELD_PARSE_ERROR",`Error parsing ${s}: ${i}`,{field:e,error:i})}}calculateChecksum(e){let t=0;for(let i=0;i<e.length-1;i++){const n=e[i];n&&n>="0"&&n<="9"?t+=parseInt(n,10):"-"===n&&(t+=1)}return t%10}getResult(){const e=this.errors.map(e=>Object.assign({code:e.code,message:e.message,severity:e.severity===l.CRITICAL?"error":e.severity},Object.fromEntries(Object.entries(e).filter(([e])=>!["severity","code","message","state"].includes(e))))),t=this.warnings.map(e=>Object.assign({code:e.code,message:e.message,severity:"warning"},Object.fromEntries(Object.entries(e).filter(([e])=>!["severity","code","message","state"].includes(e)))));return{success:this.state===c.COMPLETED,state:this.state,data:this.parsedData,errors:e,warnings:t,recoveryActions:this.recoveryActions.map(e=>e.action),partialData:this.options.includePartialResults?this.parsedData:void 0,context:{lineCount:this.context.lineCount,hasName:this.context.hasName,recoveryAttempts:this.context.recoveryAttempts}}}}function L(e,t={}){return new R(t).parse(e)}function T(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}function g(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{c(n.next(e))}catch(e){r(e)}}function o(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}c((n=n.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class f{constructor(){throw new Error("Stream operations are not available in browser builds")}}const p=(C=function(){throw new Error("File system access is not available in browser builds")},function(...e){return new Promise((t,i)=>{C(...e,(e,n)=>{e?i(e):t(n)})})});var C;function O(e,t={}){const{filter:i,continueOnError:n=!1,limit:s,skip:r=0,onTLE:a,onError:o}=t,c=T(t,["filter","continueOnError","limit","skip","onTLE","onError"]),l=[],u=S(e);let I=0;for(let e=0;e<u.length;e++){if(e<r)continue;if(void 0!==s&&I>=s)break;const t=u[e];if(t)try{const n=Ie(t,c);if(i&&!y(n,i))continue;l.push(n),I++,a&&a(n,e)}catch(i){if(o&&o(i,e,t),!n)throw i}}return l}function S(e){const t=J(e).split("\n").map(e=>e.trim()).filter(e=>e.length>0),i=[];let n=[];for(const e of t)e.startsWith("#")?n.length>0&&n.push(e):"1"===e[0]?(n.length>=2&&i.push(n.join("\n")),n=[e]):"2"===e[0]?n.push(e):n.length>=2?(i.push(n.join("\n")),n=[e]):0===n.length?n=[e]:n.push(e);return n.length>=2&&i.push(n.join("\n")),i}function D(e){return g(this,arguments,void 0,function*(e,t={}){return Promise.resolve(Ie(e,t))})}function v(e){return g(this,arguments,void 0,function*(e,t={}){return Promise.resolve(O(e,t))})}function M(e){return g(this,arguments,void 0,function*(e,t={}){return Promise.resolve(ue(e,t))})}function y(e,t){if(void 0!==t.satelliteNumber){const i=e.satelliteNumber1||"";if("function"==typeof t.satelliteNumber){if(!t.satelliteNumber(i))return!1}else if(Array.isArray(t.satelliteNumber)){if(!t.satelliteNumber.includes(i))return!1}else if(i!==t.satelliteNumber)return!1}if(void 0!==t.satelliteName&&e.satelliteName){const i=e.satelliteName;if("function"==typeof t.satelliteName){if(!t.satelliteName(i))return!1}else if(Array.isArray(t.satelliteName)){if(!t.satelliteName.some(e=>i.includes(e)))return!1}else if(!i.includes(t.satelliteName))return!1}if(void 0!==t.intlDesignator){const i=`${e.internationalDesignatorYear||""}${e.internationalDesignatorLaunchNumber||""}${e.internationalDesignatorPiece||""}`.trim();if("function"==typeof t.intlDesignator){if(!t.intlDesignator(i))return!1}else if(Array.isArray(t.intlDesignator)){if(!t.intlDesignator.includes(i))return!1}else if(i!==t.intlDesignator)return!1}if(void 0!==t.classification){const i=e.classification;if(Array.isArray(t.classification)){if(!t.classification.includes(i))return!1}else if(i!==t.classification)return!1}if(t.epochRange){const i=parseInt(e.epochYear||"0",10),n=e.epoch||"0",s=parseFloat(n),r=new Date(i>=57?1900+i:2e3+i,0,1);if(r.setDate(r.getDate()+s-1),t.epochRange.start&&r<t.epochRange.start)return!1;if(t.epochRange.end&&r>t.epochRange.end)return!1}if(t.inclinationRange){const i=parseFloat(e.inclination||"0");if(void 0!==t.inclinationRange.min&&i<t.inclinationRange.min)return!1;if(void 0!==t.inclinationRange.max&&i>t.inclinationRange.max)return!1}return!(t.custom&&!t.custom(e))}class b extends f{constructor(e={}){super({objectMode:!0,highWaterMark:e.highWaterMark||16}),this.buffer="",this.index=0,this.options=e}_transform(e,t,i){this.buffer+=e.toString();const n=this.buffer.split("\n");this.buffer=n.pop()||"";let s=[];for(const e of n){const t=e.trim();0!==t.length&&(t.startsWith("#")?s.push(t):"1"===t[0]?(s.length>=2&&this.processTLE(s.join("\n")),s=[t]):"2"===t[0]?(s.push(t),s.length>=2&&(this.processTLE(s.join("\n")),s=[])):(s.length>=2&&this.processTLE(s.join("\n")),s=[t]))}i()}_flush(e){if(this.buffer.trim().length>0){const e=this.buffer.split("\n").filter(e=>e.trim().length>0);e.length>=2&&this.processTLE(e.join("\n"))}e()}processTLE(e){const t=this.options,{continueOnError:i=!0,filter:n,onTLE:s,onError:r}=t,a=T(t,["continueOnError","filter","onTLE","onError"]);try{const t=Ie(e,a);if(n&&!y(t,n))return;this.push(t),s&&s(t,this.index),this.index++}catch(t){r&&r(t,this.index,e),i||this.destroy(t),this.index++}}}function V(e={}){return new b(e)}function G(e){return g(this,arguments,void 0,function*(e,t={}){const{encoding:i="utf8"}=t,n=T(t,["encoding"]);return O(yield p(e,{encoding:i}),n)})}function U(e){return g(this,arguments,void 0,function*(e,t={}){const{headers:i,timeout:n=3e4}=t,s=T(t,["headers","timeout"]),r=new AbortController,a=setTimeout(()=>r.abort(),n);try{const t=yield fetch(e,{headers:i,signal:r.signal});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return O(yield t.text(),s)}finally{clearTimeout(a)}})}function x(e){return g(this,arguments,void 0,function*(e,t={}){return new Promise((i,n)=>{const s=[],r=V(Object.assign(Object.assign({},t),{onTLE:(e,i)=>{s.push(e),t.onTLE&&t.onTLE(e,i)}}));e.pipe(r).on("data",()=>{}).on("end",()=>i(s)).on("error",n)})})}function w(e){return g(this,arguments,void 0,function*(e,t={}){const i=function(){throw new Error("File system access is not available in browser builds")}(),n=function(){throw new Error("Compression operations are not available in browser builds")}();return x(i.pipe(n),t)})}class F{constructor(){this.middlewares=[],this.plugins=[]}use(e){return this.middlewares.push(e),this}plugin(e){return this.plugins.push(e),e.middleware&&this.use(e.middleware),this}parse(e){return g(this,arguments,void 0,function*(e,t={}){const i={rawTLE:e,options:t,metadata:{}},n=e=>g(this,void 0,void 0,function*(){if(e>=this.middlewares.length)return Ie(i.rawTLE,i.options);const t=this.middlewares[e];return t?t(i,()=>n(e+1)):Ie(i.rawTLE,i.options)});return n(0)})}parseBatch(e){return g(this,arguments,void 0,function*(e,t={}){for(const e of this.plugins)e.onBatchStart&&(yield e.onBatchStart(t));const i=[],n=S(e);for(let e=0;e<n.length;e++){const s=n[e];if(s)try{const n=yield this.parse(s,t);if(t.filter&&!y(n,t.filter))continue;i.push(n);for(const t of this.plugins)t.onTLEParsed&&(yield t.onTLEParsed(n,e));t.onTLE&&t.onTLE(n,e)}catch(i){for(const t of this.plugins)t.onError&&(yield t.onError(i,e));if(t.onError&&t.onError(i,e,s),!t.continueOnError)throw i}}for(const e of this.plugins)e.onBatchEnd&&(yield e.onBatchEnd(i));return i})}}function P(){return new F}class H{constructor(e={}){this.cache=new Map,this.maxSize=e.maxSize||1e3,this.ttl=e.ttl||36e5,this.keyGenerator=e.keyGenerator||this.defaultKeyGenerator}defaultKeyGenerator(e,t){return`${e}:${JSON.stringify(t)}`}get(e,t={}){const i=this.keyGenerator(e,t),n=this.cache.get(i);return n?Date.now()-n.timestamp>this.ttl?(this.cache.delete(i),null):(this.cache.delete(i),this.cache.set(i,n),n.tle):null}set(e,t,i={}){const n=this.keyGenerator(e,i);if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(n,{tle:t,timestamp:Date.now()})}clear(){this.cache.clear()}size(){return this.cache.size}}function W(e={}){const t=new H(e);return{parse:(e,i={})=>{const n=t.get(e,i);if(n)return n;const s=Ie(e,i);return t.set(e,s,i),s},parseAsync:(e,...i)=>g(this,[e,...i],void 0,function*(e,i={}){const n=t.get(e,i);if(n)return n;const s=yield D(e,i);return t.set(e,s,i),s}),cache:t}}function $(e){return{strict:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},permissive:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0},fast:{validate:!1,includeWarnings:!1,includeComments:!1},realtime:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!1,includeComments:!1},batch:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!1,includeComments:!1},recovery:{validate:!1,includeWarnings:!0,includeComments:!0},legacy:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0}}[e]}function k(e,t){return Ie(e,$(t))}class Y{constructor(e,t={}){this.buffer="",this.currentSet=[],this.onTLE=e,this.options=t}push(e){this.buffer+=e,this.processBuffer()}flush(){this.currentSet.length>=2&&(this.emitTLE(this.currentSet.join("\n")),this.currentSet=[])}processBuffer(){const e=this.buffer.split("\n");this.buffer=e.pop()||"";for(const t of e){const e=t.trim();0!==e.length&&(e.startsWith("#")?this.currentSet.push(e):"1"===e[0]?(this.currentSet.length>=2&&this.emitTLE(this.currentSet.join("\n")),this.currentSet=[e]):"2"===e[0]?(this.currentSet.push(e),this.currentSet.length>=2&&(this.emitTLE(this.currentSet.join("\n")),this.currentSet=[])):(this.currentSet.length>=2&&this.emitTLE(this.currentSet.join("\n")),this.currentSet=[e]))}}emitTLE(e){try{const t=Ie(e,this.options);this.onTLE(t)}catch(e){}}}function B(e,t={}){return new Y(e,t)}function j(e){return g(this,arguments,void 0,function*(e,t={},i){return O(e,t)})}function K(e){return{celestrak:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},spacetrack:{validate:!0,strictChecksums:!0,validateRanges:!0,mode:"strict",includeWarnings:!0,includeComments:!0},amsat:{validate:!0,strictChecksums:!1,validateRanges:!1,mode:"permissive",includeWarnings:!0,includeComments:!0},custom:{validate:!1,includeWarnings:!0,includeComments:!0}}[e]}function X(e,t){return Ie(e,K(t))}const z={lineNumber1:[0,1],satelliteNumber1:[2,7],classification:[7,8],internationalDesignatorYear:[9,11],internationalDesignatorLaunchNumber:[11,14],internationalDesignatorPiece:[14,17],epochYear:[18,20],epoch:[20,32],firstDerivative:[33,43],secondDerivative:[44,52],bStar:[53,61],ephemerisType:[62,63],elementSetNumber:[64,68],checksum1:[68,69],lineNumber2:[0,1],satelliteNumber2:[2,7],inclination:[8,16],rightAscension:[17,25],eccentricity:[26,33],argumentOfPerigee:[34,42],meanAnomaly:[43,51],meanMotion:[52,63],revolutionNumber:[63,68],checksum2:[68,69]};class Z extends Error{constructor(e,t,i=[]){super(e),this.name="TLEValidationError",this.errors=t,this.warnings=i,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class q extends Error{constructor(e,t,i={}){super(e),this.name="TLEFormatError",this.code=t,this.details=i,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}function J(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}function Q(e){return J(e).split("\n").map(e=>e.replace(/\t/g," ").trim()).filter(e=>e.length>0)}function ee(e){let t=0;for(let i=0;i<e.length-1;i++){const n=e[i];n&&n>="0"&&n<="9"?t+=parseInt(n,10):"-"===n&&(t+=1)}return t%10}function te(t){if(69!==t.length)return{isValid:!1,expected:null,actual:null,error:{code:e.INVALID_LINE_LENGTH,message:"Line length must be 69 characters",field:"line_length",expected:69,actual:t.length,severity:"error"}};const i=ee(t),n=parseInt(t[68]||"",10);if(isNaN(n))return{isValid:!1,expected:i,actual:null,error:{code:e.INVALID_CHECKSUM_CHARACTER,message:"Checksum position must contain a digit",field:"checksum",position:68,value:t[68],severity:"error"}};const s=i===n;return{isValid:s,expected:i,actual:n,error:s?null:{code:e.CHECKSUM_MISMATCH,message:`Checksum mismatch: expected ${i}, got ${n}`,field:"checksum",expected:i,actual:n,severity:"error"}}}function ie(t,i){const n=[];if(69!==t.length)return n.push({code:e.INVALID_LINE_LENGTH,message:`Line ${i} must be exactly 69 characters (got ${t.length})`,line:i,field:"line_length",expected:69,actual:t.length,severity:"error"}),{isValid:!1,errors:n};const s=t[0];s!==i.toString()&&n.push({code:e.INVALID_LINE_NUMBER,message:`Line ${i} must start with '${i}' (got '${s}')`,line:i,field:"line_number",expected:i.toString(),actual:s,severity:"error"});const r=te(t);return!r.isValid&&r.error&&n.push(Object.assign(Object.assign({},r.error),{line:i,message:`Line ${i}: ${r.error.message}`})),{isValid:0===n.length,errors:n}}function ne(t,i){const n=t.substring(2,7).trim(),s=i.substring(2,7).trim();return n!==s?{isValid:!1,error:{code:e.SATELLITE_NUMBER_MISMATCH,message:`Satellite numbers must match (Line 1: ${n}, Line 2: ${s})`,field:"satellite_number",line1Value:n,line2Value:s,severity:"error"}}:/^\d+$/.test(n)?{isValid:!0,error:null}:{isValid:!1,error:{code:e.INVALID_SATELLITE_NUMBER,message:`Satellite number must be numeric (got '${n}')`,field:"satellite_number",value:n,severity:"error"}}}function se(t){const i=t[7],n=["U","C","S"];return n.includes(i||"")?{isValid:!0,error:null}:{isValid:!1,error:{code:e.INVALID_CLASSIFICATION,message:`Classification must be U, C, or S (got '${i}')`,field:"classification",expected:n,actual:i,severity:"error"}}}function re(t,i,n,s){const r=parseFloat(t);return isNaN(r)?{isValid:!1,error:{code:e.INVALID_NUMBER_FORMAT,message:`${i} must be numeric (got '${t}')`,field:i,value:t,severity:"error"}}:r<n||r>s?{isValid:!1,error:{code:e.VALUE_OUT_OF_RANGE,message:`${i} must be between ${n} and ${s} (got ${r})`,field:i,value:r,min:n,max:s,severity:"error"}}:{isValid:!0,error:null}}function ae(t){const i=[],n=t[7];return"C"!==n&&"S"!==n||i.push({code:e.CLASSIFIED_DATA_WARNING,message:`Classification '${n}' is unusual in public TLE data (typically 'U' for unclassified)`,field:"classification",value:n,severity:"warning"}),i}function oe(t){const i=[],n=parseInt(t.substring(18,20),10),s=parseFloat(t.substring(20,32));if(isNaN(n)||isNaN(s))return i;const r=n>=57?1900+n:2e3+n;r<2e3&&i.push({code:e.DEPRECATED_EPOCH_YEAR_WARNING,message:`Epoch year ${r} is in the deprecated 1900s range (two-digit year: ${n})`,field:"epochYear",value:n,fullYear:r,severity:"warning"});const a=new Date(r,0,1);a.setDate(a.getDate()+s-1);const o=((new Date).getTime()-a.getTime())/864e5;return o>30&&i.push({code:e.STALE_TLE_WARNING,message:`TLE epoch is ${Math.floor(o)} days old (epoch: ${a.toISOString().split("T")[0]}). TLE data may be stale.`,field:"epoch",daysSinceEpoch:Math.floor(o),epochDate:a.toISOString().split("T")[0],severity:"warning"}),i}function ce(t){const i=[],n=parseFloat("0."+t.substring(26,33).trim());!isNaN(n)&&n>.25&&i.push({code:e.HIGH_ECCENTRICITY_WARNING,message:`Eccentricity ${n.toFixed(7)} is unusually high. This indicates a highly elliptical orbit.`,field:"eccentricity",value:n,severity:"warning"});const s=parseFloat(t.substring(52,63).trim());!isNaN(s)&&s<1&&i.push({code:e.LOW_MEAN_MOTION_WARNING,message:`Mean motion ${s.toFixed(8)} rev/day is unusually low. This indicates a very high orbit.`,field:"meanMotion",value:s,severity:"warning"});const r=parseInt(t.substring(63,68).trim(),10);return!isNaN(r)&&r>9e4&&i.push({code:e.REVOLUTION_NUMBER_ROLLOVER_WARNING,message:`Revolution number ${r} is approaching rollover limit (99999). Counter may reset soon.`,field:"revolutionNumber",value:r,severity:"warning"}),i}function le(t){const i=[],n=t.substring(53,61).trim();"00000-0"!==n&&"00000+0"!==n&&"00000 0"!==n||i.push({code:e.NEAR_ZERO_DRAG_WARNING,message:"B* drag term is zero or near-zero, which is unusual for most satellites in LEO",field:"bStar",value:n,severity:"warning"});const s=parseFloat(t.substring(33,43).trim());!isNaN(s)&&s<0&&i.push({code:e.NEGATIVE_DECAY_WARNING,message:`First derivative of mean motion is negative (${s}), indicating orbital decay`,field:"firstDerivative",value:s,severity:"warning"});const r=t.substring(62,63).trim();return"0"!==r&&""!==r&&i.push({code:e.NON_STANDARD_EPHEMERIS_WARNING,message:`Ephemeris type '${r}' is non-standard (expected '0' for SGP4/SDP4)`,field:"ephemerisType",value:r,severity:"warning"}),i}function ue(t,i={}){if("string"!=typeof t)throw new TypeError("TLE data must be a string");if("object"!=typeof i||null===i||Array.isArray(i))throw new TypeError("Options must be an object");if(0===t.length)throw new q("TLE string cannot be empty",e.EMPTY_INPUT,{inputLength:0});const{strictChecksums:n=!0,validateRanges:s=!0,mode:r="strict"}=i;if("strict"!==r&&"permissive"!==r)throw new TypeError('Mode must be either "strict" or "permissive"');const a=[],o=[],c=J(t).trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0&&!e.startsWith("#"));if(c.length<2)return a.push({code:e.INVALID_LINE_COUNT,message:"TLE must contain at least 2 lines",field:"line_count",expected:"2 or 3",actual:c.length,severity:"error"}),{isValid:!1,errors:a,warnings:o};if(c.length>3)return a.push({code:e.INVALID_LINE_COUNT,message:`TLE must contain 2 or 3 lines (got ${c.length})`,field:"line_count",expected:"2 or 3",actual:c.length,severity:"error"}),{isValid:!1,errors:a,warnings:o};let l=0,u=1;if(3===c.length){l=1,u=2;const t=c[0];!t||"1"!==t[0]&&"2"!==t[0]||o.push({code:e.SATELLITE_NAME_FORMAT_WARNING,message:'Line 0 starts with "1" or "2", might be incorrectly formatted',field:"satellite_name",value:t,severity:"warning"}),t&&t.length>24&&o.push({code:e.SATELLITE_NAME_TOO_LONG,message:"Satellite name (Line 0) should be 24 characters or less",field:"satellite_name",expected:24,actual:t.length,severity:"warning"})}const I=c[l],N=c[u];if(!I||!N)return a.push({code:e.INVALID_LINE_COUNT,message:"Missing required TLE lines",severity:"error"}),{isValid:!1,errors:a,warnings:o};const E=ie(I,1);if(!E.isValid)if("permissive"===r){const t=E.errors.filter(t=>t.code!==e.CHECKSUM_MISMATCH&&t.code!==e.INVALID_CHECKSUM_CHARACTER),i=E.errors.filter(t=>t.code===e.CHECKSUM_MISMATCH||t.code===e.INVALID_CHECKSUM_CHARACTER);if(a.push(...t),o.push(...i.map(e=>Object.assign(Object.assign({},e),{severity:"warning"}))),t.length>0)return{isValid:!1,errors:a,warnings:o}}else if(a.push(...E.errors),n)return{isValid:!1,errors:a,warnings:o};const h=ie(N,2);if(!h.isValid)if("permissive"===r){const t=h.errors.filter(t=>t.code!==e.CHECKSUM_MISMATCH&&t.code!==e.INVALID_CHECKSUM_CHARACTER),i=h.errors.filter(t=>t.code===e.CHECKSUM_MISMATCH||t.code===e.INVALID_CHECKSUM_CHARACTER);if(a.push(...t),o.push(...i.map(e=>Object.assign(Object.assign({},e),{severity:"warning"}))),t.length>0)return{isValid:!1,errors:a,warnings:o}}else if(a.push(...h.errors),n)return{isValid:!1,errors:a,warnings:o};const d=ne(I,N);!d.isValid&&d.error&&("permissive"===r?o.push(Object.assign(Object.assign({},d.error),{severity:"warning"})):a.push(d.error));const m=se(I);if(!m.isValid&&m.error&&("permissive"===r?o.push(Object.assign(Object.assign({},m.error),{severity:"warning"})):a.push(m.error)),s&&69===I.length&&69===N.length){const e=[{value:I.substring(2,7).trim(),name:"Satellite Number",min:1,max:99999},{value:I.substring(9,11).trim(),name:"International Designator Year",min:0,max:99,optional:!0},{value:I.substring(11,14).trim(),name:"International Designator Launch Number",min:1,max:999,optional:!0},{value:I.substring(62,63).trim(),name:"Ephemeris Type",min:0,max:9,optional:!0},{value:I.substring(64,68).trim(),name:"Element Set Number",min:0,max:9999,optional:!0},{value:I.substring(18,20).trim(),name:"Epoch Year",min:0,max:99},{value:I.substring(20,32).trim(),name:"Epoch Day",min:1,max:366.99999999},{value:N.substring(8,16).trim(),name:"Inclination",min:0,max:180},{value:N.substring(17,25).trim(),name:"Right Ascension",min:0,max:360},{value:"0."+N.substring(26,33).trim(),name:"Eccentricity",min:0,max:1},{value:N.substring(34,42).trim(),name:"Argument of Perigee",min:0,max:360},{value:N.substring(43,51).trim(),name:"Mean Anomaly",min:0,max:360},{value:N.substring(52,63).trim(),name:"Mean Motion",min:0,max:20,warningOnly:!0},{value:N.substring(63,68).trim(),name:"Revolution Number",min:0,max:99999,optional:!0}];for(const{value:t,name:i,min:n,max:s,optional:c,warningOnly:l}of e){if(c&&0===t.length)continue;const e=re(t,i,n,s);!e.isValid&&e.error&&(l||"permissive"===r?o.push(Object.assign(Object.assign({},e.error),{severity:"warning"})):a.push(e.error))}}return 69===I.length&&(o.push(...ae(I)),o.push(...oe(I)),o.push(...le(I))),69===N.length&&o.push(...ce(N)),{isValid:0===a.length,errors:a,warnings:o}}function Ie(t,i={}){if("string"!=typeof t)throw new TypeError("TLE data must be a string");if("object"!=typeof i||null===i||Array.isArray(i))throw new TypeError("Options must be an object");const{validate:n=!0,strictChecksums:s=!0,validateRanges:r=!0,includeWarnings:a=!0,includeComments:o=!0,mode:c="strict"}=i;let l=[];if(n){const e=ue(t,{strictChecksums:s,validateRanges:r,mode:c});if(!e.isValid){const t="TLE validation failed:\n"+e.errors.map(e=>"string"==typeof e?e:e.message).join("\n");throw new Z(t,e.errors,e.warnings)}l=e.warnings}const u=J(t).trim().split("\n").map(e=>e.trim()).filter(e=>e.length>0),I=u.filter(e=>e.startsWith("#")),N=u.filter(e=>!e.startsWith("#"));let E=0,h=1,d=null;3===N.length&&(d=N[0]||null,E=1,h=2);const m=N[E],A=N[h];if(!m||!A)throw new q("Missing required TLE lines",e.INVALID_LINE_COUNT);const _={satelliteName:d},R=["lineNumber2","satelliteNumber2","inclination","rightAscension","eccentricity","argumentOfPerigee","meanAnomaly","meanMotion","revolutionNumber","checksum2"];for(const[e,t]of Object.entries(z)){const[i,n]=t,s=R.includes(e)?A:m;_[e]=s.substring(i,n).trim()}return a&&l.length>0&&(_.warnings=l),o&&I.length>0&&(_.comments=I),_}var Ne={parseTLE:Ie,validateTLE:ue,calculateChecksum:ee,validateChecksum:te,validateLineStructure:ie,validateSatelliteNumber:ne,validateClassification:se,validateNumericRange:re,checkClassificationWarnings:ae,checkEpochWarnings:oe,checkOrbitalParameterWarnings:ce,checkDragAndEphemerisWarnings:le,normalizeLineEndings:J,parseTLELines:Q,TLEValidationError:Z,TLEFormatError:q,ERROR_CODES:e};export{e as ERROR_CODES,l as ErrorSeverity,Y as IncrementalParser,F as MiddlewareParser,c as ParserState,u as RecoveryAction,H as TLECache,r as TLEErrorCode,q as TLEFormatError,b as TLEParserStream,R as TLEStateMachineParser,Z as TLEValidationError,y as applyFilter,ee as calculateChecksum,ae as checkClassificationWarnings,le as checkDragAndEphemerisWarnings,oe as checkEpochWarnings,ce as checkOrbitalParameterWarnings,W as createCachedParser,B as createIncrementalParser,P as createMiddlewareParser,V as createTLEParserStream,Ne as default,i as getErrorDescription,$ as getProfileOptions,K as getProviderOptions,s as isCriticalError,h as isParseFailure,E as isParseSuccess,_ as isParsedTLE,d as isTLEError,m as isTLEWarning,A as isValidClassification,t as isValidErrorCode,N as isValidationFailure,I as isValidationSuccess,n as isWarningCode,J as normalizeLineEndings,O as parseBatch,v as parseBatchAsync,w as parseFromCompressed,G as parseFromFile,x as parseFromStream,U as parseFromURL,j as parseParallel,Ie as parseTLE,D as parseTLEAsync,Q as parseTLELines,k as parseWithProfile,X as parseWithProvider,L as parseWithStateMachine,S as splitTLEs,te as validateChecksum,se as validateClassification,ie as validateLineStructure,re as validateNumericRange,ne as validateSatelliteNumber,ue as validateTLE,M as validateTLEAsync};
//# sourceMappingURL=index.browser.min.js.map
